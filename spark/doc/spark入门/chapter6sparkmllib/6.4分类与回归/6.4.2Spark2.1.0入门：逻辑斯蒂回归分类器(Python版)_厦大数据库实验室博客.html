<!DOCTYPE html>
<html lang="zh-CN"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Spark2.1.0入门：逻辑斯蒂回归分类器(Python版)_厦大数据库实验室博客</title>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="renderer" content="webkit">
<link rel="dns-prefetch" href="http://cdn.staticfile.org/">
<link rel="dns-prefetch" href="http://s.w.org/">
<link rel="stylesheet" id="yarppWidgetCss-css" href="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/widget.css" type="text/css" media="all">
<link rel="stylesheet" id="wp-quicklatex-format-css" href="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex-format.css" type="text/css" media="all">
<link rel="stylesheet" id="bootstrap-css" href="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/bootstrap.css" type="text/css" media="all">
<link rel="stylesheet" id="font-awesome-css" href="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/font-awesome.css" type="text/css" media="all">
<link rel="stylesheet" id="power-css" href="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/style.css" type="text/css" media="all">
<link rel="stylesheet" id="google-code-prettify-css" href="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/prettify.css" type="text/css" media="all">
<script type="text/javascript" async="" charset="utf-8" src="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/core.js"></script><script src="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/hm.js"></script><script src="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/z_stat.js"></script><script type="text/javascript" src="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/jquery_002.js"></script>
<script type="text/javascript" src="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/jquery.js"></script>
<script type="text/javascript" src="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/jquery-migrate.js"></script>
<script type="text/javascript" src="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/wp-quicklatex-frontend.js"></script>
<link rel="https://api.w.org/" href="http://dblab.xmu.edu.cn/blog/wp-json/">
<link rel="prev" title="Spark 2.1.0 入门：分类与回归" href="http://dblab.xmu.edu.cn/blog/1772-2/">
<link rel="next" title="Spark 2.1.0入门：决策树分类器(Python版)" href="http://dblab.xmu.edu.cn/blog/1776-2/">
<link rel="canonical" href="http://dblab.xmu.edu.cn/blog/1773-2/">
<link rel="alternate" type="application/json+oembed" href="http://dblab.xmu.edu.cn/blog/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fdblab.xmu.edu.cn%2Fblog%2F1773-2%2F">
<!--[if lt IE 9]>
<script src="http://dblab.xmu.edu.cn/blog/wp-content/themes/power/js/html5shiv.js"></script>
<![endif]-->
</head>

<body class="post-template-default single single-post postid-1773 single-format-standard group-blog">
<div class="container site-page">

<div class="row">
	<div class="col-sm-3 site-infos">
		<h4 class="site-title">
			<a href="http://dblab.xmu.edu.cn/blog/" title="厦大数据库实验室博客" rel="home">厦大数据库实验室博客</a>
		</h4>
		<div class="site-description">总结、分享、收获<p><a href="http://dblab.xmu.edu.cn/" title="厦大数据库实验室">实验室主页</a></p></div>

		<nav class="main-navigation" role="navigation">
			<div class="menu-primary-container"><ul id="menu-primary" class="menu menu-level-1"><li id="menu-item-80" class="menu-item item-level-1"><a href="http://dblab.xmu.edu.cn/blog/">首页</a></li>
<li id="menu-item-85" class="menu-item item-level-1 current-path"><a href="http://dblab.xmu.edu.cn/blog/category/big-data/">大数据</a></li>
<li id="menu-item-676" class="menu-item item-level-1"><a href="http://dblab.xmu.edu.cn/blog/category/databases/">数据库</a></li>
<li id="menu-item-87" class="menu-item item-level-1"><a href="http://dblab.xmu.edu.cn/blog/category/data-mining/">数据挖掘</a></li>
<li id="menu-item-86" class="menu-item item-level-1"><a href="http://dblab.xmu.edu.cn/blog/category/others/">其他</a></li>
</ul></div>		</nav><!-- #site-navigation -->

		<div class="search"><form role="search" method="get" class="search-form" action="http://dblab.xmu.edu.cn/blog/">
				<label>
					<span class="screen-reader-text">搜索：</span>
					<input class="search-field" placeholder="搜索…" name="s" type="search">
				</label>
				<input class="search-submit" value="搜索" type="submit">
			</form></div>
	</div>
	<div class="col-sm-9 site-main">

					<article id="post-1773" class="post-1773 post type-post status-publish format-standard hentry category-big-data">
	<header class="entry-header">
		<h1 class="entry-title">Spark2.1.0入门：逻辑斯蒂回归分类器(Python版)</h1>

		<div class="entry-meta">
			<span class="author"><i class="fa fa-user"></i> 阮榕城</span><span class="date"><i class="fa fa-calendar"></i> <time datetime="2017-12-18T14:54:00+00:00">2017年12月18日</time> <span class="updated">(updated: <time class="updated" datetime="2018-01-08T10:40:18+00:00">2018年1月8日</time>)</span></span><span class="views" id="views"><i class="fa fa-eye"></i> 2235</span>		</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

	<div class="entry-content">
		<div class="bigdata-book">
			<a href="http://dblab.xmu.edu.cn/post/5899/" title="2019年1月20日寒假大数据师资培训班" target="_blank"><img src="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/peixunban2019-01-20.jpg" alt="2019年1月20日寒假大数据师资培训班"></a>
		</div>
		<p>【版权声明】博客内容由厦门大学数据库实验室拥有版权，未经允许，请勿转载！</p>
<p>[<a href="http://dblab.xmu.edu.cn/blog/1709-2/" target="_blank">返回Spark教程首页</a>]</p>
<h1>逻辑斯蒂回归</h1>
<h3>方法简介</h3>
<p>​   逻辑斯蒂回归（logistic regression）是统计学习中的经典分类方法，属于对数线性模型。logistic回归的因变量可以是二分类的，也可以是多分类的。</p>
<p><span id="more-1773"></span></p>
<h3>基本原理</h3>
<h5>logistic分布</h5>
<p>​   设X是连续随机变量，X服从logistic分布是指X具有下列分布函数和密度函数：</p>
<p>​       </p>
<p class="ql-center-displayed-equation" style="line-height: 39px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_015.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[F(x)=P(x \le x)=\frac 1 {1+e^{-(x-\mu)/\gamma}}\]" title="Rendered by QuickLaTeX.com" width="262" height="39"></p>
<p>​       </p>
<p class="ql-center-displayed-equation" style="line-height: 46px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_007.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[f(x)=F^{'}(x)=\frac {e^{-(x-\mu)/\gamma}} {\gamma(1+e^{-(x-\mu)/\gamma})^2}\]" title="Rendered by QuickLaTeX.com" width="262" height="46"></p>
<p>​   其中，<img src="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex.svg" class="ql-img-inline-formula quicklatex-auto-format" alt="\mu" title="Rendered by QuickLaTeX.com" style="vertical-align: -4px;" width="11" height="12">为位置参数，<img src="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_008.svg" class="ql-img-inline-formula quicklatex-auto-format" alt="\gamma" title="Rendered by QuickLaTeX.com" style="vertical-align: -4px;" width="10" height="12">为形状参数。</p>
<p>​   <img src="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_014.svg" class="ql-img-inline-formula quicklatex-auto-format" alt="f(x)" title="Rendered by QuickLaTeX.com" style="vertical-align: -4px;" width="34" height="18">与</p>
<p class="ql-center-displayed-equation" style="line-height: 18px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_010.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[F(x)\]" title="Rendered by QuickLaTeX.com" width="37" height="18"></p>
<p>图像如下，其中分布函数是以</p>
<p class="ql-center-displayed-equation" style="line-height: 36px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_005.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[(\mu, \frac 1 2)\]" title="Rendered by QuickLaTeX.com" width="43" height="36"></p>
<p>为中心对阵，</p>
<p class="ql-center-displayed-equation" style="line-height: 12px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_002.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[\gamma\]" title="Rendered by QuickLaTeX.com" width="10" height="12"></p>
<p>$越小曲线变化越快。</p>
<h5><img src="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/6d96cc41gw1etfkt9bbhwj20c603xmx4.jpg" alt="" title=""></h5>
<h5>二项logistic回归模型：</h5>
<p>​   二项logistic回归模型如下：</p>
<p>​       </p>
<p class="ql-center-displayed-equation" style="line-height: 42px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_018.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[P(Y=1|x)=\frac {exp(w \cdot x + b)} {1 + exp(w \cdot x + b)}\]" title="Rendered by QuickLaTeX.com" width="253" height="42"></p>
<p>​       </p>
<p class="ql-center-displayed-equation" style="line-height: 40px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_009.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[P(Y=0|x)=\frac {1} {1 + exp(w \cdot x + b)}\]" title="Rendered by QuickLaTeX.com" width="253" height="40"></p>
<p>​   其中，</p>
<p class="ql-center-displayed-equation" style="line-height: 15px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_017.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[x \in R^n\]" title="Rendered by QuickLaTeX.com" width="53" height="15"></p>
<p>是输入，</p>
<p class="ql-center-displayed-equation" style="line-height: 16px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_004.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[Y \in {0,1}\]" title="Rendered by QuickLaTeX.com" width="61" height="16"></p>
<p>是输出，w称为权值向量，b称为偏置，</p>
<p class="ql-center-displayed-equation" style="line-height: 8px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_013.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[w \cdot x\]" title="Rendered by QuickLaTeX.com" width="36" height="8"></p>
<p>为w和x的内积。</p>
<h5>参数估计</h5>
<p>​   假设：</p>
<p>​       </p>
<p class="ql-center-displayed-equation" style="line-height: 18px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_006.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[P(Y=1|x)=\pi (x), \quad P(Y=0|x)=1-\pi (x)\]" title="Rendered by QuickLaTeX.com" width="351" height="18"></p>
<p>​   则似然函数为:</p>
<p>​       </p>
<p class="ql-center-displayed-equation" style="line-height: 53px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_012.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[\prod_{i=1}^N [\pi (x_i)]^{y_i} [1 - \pi(x_i)]^{1-y_i}\]" title="Rendered by QuickLaTeX.com" width="195" height="53"></p>
<p>​   求对数似然函数：</p>
<p>​       </p>
<p class="ql-center-displayed-equation" style="line-height: 53px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_011.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[L(w) = \sum_{i=1}^N [y_i \log{\pi(x_i)} + (1-y_i) \log{(1 - \pi(x_i)})]\]" title="Rendered by QuickLaTeX.com" width="373" height="53"></p>
<p>​       </p>
<p class="ql-center-displayed-equation" style="line-height: 53px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_003.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[\sum_{i=1}^N [y_i \log{\frac {\pi (x_i)} {1 - \pi(x_i)}} + \log{(1 - \pi(x_i)})]=\sum_{i=1}^N [y_i \log{\frac {\pi (x_i)} {1 - \pi(x_i)}} + \log{(1 - \pi(x_i)})]\]" title="Rendered by QuickLaTeX.com" width="581" height="53"></p>
<p>​   从而对</p>
<p class="ql-center-displayed-equation" style="line-height: 18px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_016.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[L(w)\]" title="Rendered by QuickLaTeX.com" width="38" height="18"></p>
<p>求极大值，得到w的估计值。求极值的方法可以是梯度下降法，梯度上升法等。</p>
<h3>示例代码</h3>
<p>​   我们以iris数据集（<a href="http://dblab.xmu.edu.cn/blog/wp-content/uploads/2017/03/iris.txt" target="_blank">iris</a>）
为例进行分析。iris以鸢尾花的特征作为数据来源，数据集包含150个数据集，分为3类，每类50个数据，每个数据包含4个属性，是在数据挖掘、数据分
类中非常常用的测试集、训练集。为了便于理解，我们这里主要用后两个属性（花瓣的长度和宽度）来进行分类。目前&nbsp;<code>spark.ml</code>&nbsp;中支持二分类和多分类，我们将分别从“用二项逻辑斯蒂回归来解决二分类问题”、“用多项逻辑斯蒂回归来解决二分类问题”、“用多项逻辑斯蒂回归来解决多分类问题”三个方面进行分析。</p>
<h4>用二项逻辑斯蒂回归解决 二分类 问题</h4>
<p>首先我们先取其中的后两类数据，用二项逻辑斯蒂回归进行二分类分析。</p>
<h5>1. 导入需要的包：</h5>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-python prettyprinted" style=""><ol class="linenums"><li class="L0"><span class="kwd">from</span><span class="pln"> pyspark</span><span class="pun">.</span><span class="pln">sql </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">Row</span><span class="pun">,</span><span class="pln">functions</span></li><li class="L1"><span class="kwd">from</span><span class="pln"> pyspark</span><span class="pun">.</span><span class="pln">ml</span><span class="pun">.</span><span class="pln">linalg </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">Vector</span><span class="pun">,</span><span class="typ">Vectors</span></li><li class="L2"><span class="kwd">from</span><span class="pln"> pyspark</span><span class="pun">.</span><span class="pln">ml</span><span class="pun">.</span><span class="pln">evaluation </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">MulticlassClassificationEvaluator</span></li><li class="L3"><span class="kwd">from</span><span class="pln"> pyspark</span><span class="pun">.</span><span class="pln">ml </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">Pipeline</span></li><li class="L4"><span class="kwd">from</span><span class="pln"> pyspark</span><span class="pun">.</span><span class="pln">ml</span><span class="pun">.</span><span class="pln">feature </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">IndexToString</span><span class="pun">,</span><span class="pln"> </span><span class="typ">StringIndexer</span><span class="pun">,</span><span class="pln"> </span><span class="typ">VectorIndexer</span><span class="pun">,</span><span class="typ">HashingTF</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Tokenizer</span></li><li class="L5"><span class="kwd">from</span><span class="pln"> pyspark</span><span class="pun">.</span><span class="pln">ml</span><span class="pun">.</span><span class="pln">classification </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">LogisticRegression</span><span class="pun">,</span><span class="typ">LogisticRegressionModel</span><span class="pun">,</span><span class="typ">BinaryLogisticRegressionSummary</span><span class="pun">,</span><span class="pln"> </span><span class="typ">LogisticRegression</span></li></ol></pre><div class="code-pretty-toolbar"><span class="title">Python</span><a href="javascript:void(0);" title="复制代码" class="tool clipboard"><i class="fa fa-files-o"></i></a><a href="javascript:void(0);" title="查看纯文本代码" class="tool view-source"><i class="fa fa-code"></i></a><a href="javascript:void(0);" title="返回代码高亮" class="tool back-to-pretty"><i class="fa fa-undo"></i></a><span class="msg"></span></div></div>
<h5>2. 读取数据，简要分析：</h5>
<p>​    
我们定制一个函数，来返回一个指定的数据，然后读取文本文件，第一个map把每行的数据用“,”隔开，比如在我们的数据集中，每行被分成了5部分，前4部
分是鸢尾花的4个特征，最后一部分是鸢尾花的分类；我们这里把特征存储在Vector中，创建一个Iris模式的RDD，然后转化成dataframe；
最后调用show()方法来查看一下部分数据。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-python prettyprinted" style=""><ol class="linenums"><li class="L0"><span class="kwd">def</span><span class="pln"> f</span><span class="pun">(</span><span class="pln">x</span><span class="pun">):</span></li><li class="L1"><span class="pln">    rel </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{}</span></li><li class="L2"><span class="pln">    rel</span><span class="pun">[</span><span class="str">'features'</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Vectors</span><span class="pun">.</span><span class="pln">dense</span><span class="pun">(</span><span class="pln">float</span><span class="pun">(</span><span class="pln">x</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]),</span><span class="pln">float</span><span class="pun">(</span><span class="pln">x</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]),</span><span class="pln">float</span><span class="pun">(</span><span class="pln">x</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]),</span><span class="pln">float</span><span class="pun">(</span><span class="pln">x</span><span class="pun">[</span><span class="lit">3</span><span class="pun">]))</span></li><li class="L3"><span class="pln">    rel</span><span class="pun">[</span><span class="str">'label'</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> str</span><span class="pun">(</span><span class="pln">x</span><span class="pun">[</span><span class="lit">4</span><span class="pun">])</span></li><li class="L4"><span class="pln">    </span><span class="kwd">return</span><span class="pln"> rel</span></li><li class="L5"><span class="pln">&nbsp;</span></li><li class="L6"><span class="pln">data </span><span class="pun">=</span><span class="pln"> spark</span><span class="pun">.</span><span class="pln">sparkContext</span><span class="pun">.</span><span class="pln">textFile</span><span class="pun">(</span><span class="str">"file:///usr/local/spark/iris.txt"</span><span class="pun">).</span><span class="pln">map</span><span class="pun">(</span><span class="kwd">lambda</span><span class="pln"> line</span><span class="pun">:</span><span class="pln"> line</span><span class="pun">.</span><span class="pln">split</span><span class="pun">(</span><span class="str">','</span><span class="pun">)).</span><span class="pln">map</span><span class="pun">(</span><span class="kwd">lambda</span><span class="pln"> p</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Row</span><span class="pun">(**</span><span class="pln">f</span><span class="pun">(</span><span class="pln">p</span><span class="pun">))).</span><span class="pln">toDF</span><span class="pun">()</span></li><li class="L7"><span class="pln">&nbsp;</span></li><li class="L8"><span class="pun">+-----------------+-----------+</span></li><li class="L9"><span class="pun">|</span><span class="pln">         features</span><span class="pun">|</span><span class="pln">      label</span><span class="pun">|</span></li><li class="L0"><span class="pun">+-----------------+-----------+</span></li><li class="L1"><span class="pun">|[</span><span class="lit">5.1</span><span class="pun">,</span><span class="lit">3.5</span><span class="pun">,</span><span class="lit">1.4</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">]|</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span></li><li class="L2"><span class="pun">|[</span><span class="lit">4.9</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">1.4</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">]|</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span></li><li class="L3"><span class="pun">|[</span><span class="lit">4.7</span><span class="pun">,</span><span class="lit">3.2</span><span class="pun">,</span><span class="lit">1.3</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">]|</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span></li><li class="L4"><span class="pun">|[</span><span class="lit">4.6</span><span class="pun">,</span><span class="lit">3.1</span><span class="pun">,</span><span class="lit">1.5</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">]|</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span></li><li class="L5"><span class="pun">|[</span><span class="lit">5.0</span><span class="pun">,</span><span class="lit">3.6</span><span class="pun">,</span><span class="lit">1.4</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">]|</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span></li><li class="L6"><span class="pun">|[</span><span class="lit">5.4</span><span class="pun">,</span><span class="lit">3.9</span><span class="pun">,</span><span class="lit">1.7</span><span class="pun">,</span><span class="lit">0.4</span><span class="pun">]|</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span></li><li class="L7"><span class="pun">|[</span><span class="lit">4.6</span><span class="pun">,</span><span class="lit">3.4</span><span class="pun">,</span><span class="lit">1.4</span><span class="pun">,</span><span class="lit">0.3</span><span class="pun">]|</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span></li><li class="L8"><span class="pun">|[</span><span class="lit">5.0</span><span class="pun">,</span><span class="lit">3.4</span><span class="pun">,</span><span class="lit">1.5</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">]|</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span></li><li class="L9"><span class="pun">|[</span><span class="lit">4.4</span><span class="pun">,</span><span class="lit">2.9</span><span class="pun">,</span><span class="lit">1.4</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">]|</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span></li><li class="L0"><span class="pun">|[</span><span class="lit">4.9</span><span class="pun">,</span><span class="lit">3.1</span><span class="pun">,</span><span class="lit">1.5</span><span class="pun">,</span><span class="lit">0.1</span><span class="pun">]|</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span></li><li class="L1"><span class="pun">|[</span><span class="lit">5.4</span><span class="pun">,</span><span class="lit">3.7</span><span class="pun">,</span><span class="lit">1.5</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">]|</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span></li><li class="L2"><span class="pun">|[</span><span class="lit">4.8</span><span class="pun">,</span><span class="lit">3.4</span><span class="pun">,</span><span class="lit">1.6</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">]|</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span></li><li class="L3"><span class="pun">|[</span><span class="lit">4.8</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">1.4</span><span class="pun">,</span><span class="lit">0.1</span><span class="pun">]|</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span></li><li class="L4"><span class="pun">|[</span><span class="lit">4.3</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">1.1</span><span class="pun">,</span><span class="lit">0.1</span><span class="pun">]|</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span></li><li class="L5"><span class="pun">|[</span><span class="lit">5.8</span><span class="pun">,</span><span class="lit">4.0</span><span class="pun">,</span><span class="lit">1.2</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">]|</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span></li><li class="L6"><span class="pun">|[</span><span class="lit">5.7</span><span class="pun">,</span><span class="lit">4.4</span><span class="pun">,</span><span class="lit">1.5</span><span class="pun">,</span><span class="lit">0.4</span><span class="pun">]|</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span></li><li class="L7"><span class="pun">|[</span><span class="lit">5.4</span><span class="pun">,</span><span class="lit">3.9</span><span class="pun">,</span><span class="lit">1.3</span><span class="pun">,</span><span class="lit">0.4</span><span class="pun">]|</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span></li><li class="L8"><span class="pun">|[</span><span class="lit">5.1</span><span class="pun">,</span><span class="lit">3.5</span><span class="pun">,</span><span class="lit">1.4</span><span class="pun">,</span><span class="lit">0.3</span><span class="pun">]|</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span></li><li class="L9"><span class="pun">|[</span><span class="lit">5.7</span><span class="pun">,</span><span class="lit">3.8</span><span class="pun">,</span><span class="lit">1.7</span><span class="pun">,</span><span class="lit">0.3</span><span class="pun">]|</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span></li><li class="L0"><span class="pun">|[</span><span class="lit">5.1</span><span class="pun">,</span><span class="lit">3.8</span><span class="pun">,</span><span class="lit">1.5</span><span class="pun">,</span><span class="lit">0.3</span><span class="pun">]|</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span></li><li class="L1"><span class="pun">+-----------------+-----------+</span></li><li class="L2"><span class="pln">only showing top </span><span class="lit">20</span><span class="pln"> rows</span></li></ol></pre><div class="code-pretty-toolbar"><span class="title">Python</span><a href="javascript:void(0);" title="复制代码" class="tool clipboard"><i class="fa fa-files-o"></i></a><a href="javascript:void(0);" title="查看纯文本代码" class="tool view-source"><i class="fa fa-code"></i></a><a href="javascript:void(0);" title="返回代码高亮" class="tool back-to-pretty"><i class="fa fa-undo"></i></a><span class="msg"></span></div></div>
<p>​   
因为我们现在处理的是2分类问题，所以我们不需要全部的3类数据，我们要从中选出两类的数据。这里首先把刚刚得到的数据注册成一个表iris，注册成这个
表之后，我们就可以通过sql语句进行数据查询，比如我们这里选出了所有不属于“Iris-setosa”类别的数据；选出我们需要的数据后，我们可以把
结果打印出来看一下，这时就已经没有“Iris-setosa”类别的数据。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-python prettyprinted" style=""><ol class="linenums"><li class="L0"><span class="pln">data</span><span class="pun">.</span><span class="pln">createOrReplaceTempView</span><span class="pun">(</span><span class="str">"iris"</span><span class="pun">)</span></li><li class="L1"><span class="pln">df </span><span class="pun">=</span><span class="pln"> spark</span><span class="pun">.</span><span class="pln">sql</span><span class="pun">(</span><span class="str">"select * from iris where label != 'Iris-setosa'"</span><span class="pun">)</span></li><li class="L2"><span class="pln">rel </span><span class="pun">=</span><span class="pln"> df</span><span class="pun">.</span><span class="pln">map</span><span class="pun">(</span><span class="kwd">lambda</span><span class="pln"> t </span><span class="pun">:</span><span class="pln"> str</span><span class="pun">(</span><span class="pln">t</span><span class="pun">[</span><span class="lit">1</span><span class="pun">])+</span><span class="str">":"</span><span class="pun">+</span><span class="pln">str</span><span class="pun">(</span><span class="pln">t</span><span class="pun">[</span><span class="lit">0</span><span class="pun">])).</span><span class="pln">collect</span><span class="pun">()</span></li><li class="L3"><span class="kwd">for</span><span class="pln"> item </span><span class="kwd">in</span><span class="pln"> rel</span><span class="pun">:</span></li><li class="L4"><span class="pln">            </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">item</span><span class="pun">)</span></li><li class="L5"><span class="pln">&nbsp;</span></li><li class="L6"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">7.0</span><span class="pun">,</span><span class="lit">3.2</span><span class="pun">,</span><span class="lit">4.7</span><span class="pun">,</span><span class="lit">1.4</span><span class="pun">]</span></li><li class="L7"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">6.4</span><span class="pun">,</span><span class="lit">3.2</span><span class="pun">,</span><span class="lit">4.5</span><span class="pun">,</span><span class="lit">1.5</span><span class="pun">]</span></li><li class="L8"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">6.9</span><span class="pun">,</span><span class="lit">3.1</span><span class="pun">,</span><span class="lit">4.9</span><span class="pun">,</span><span class="lit">1.5</span><span class="pun">]</span></li><li class="L9"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">5.5</span><span class="pun">,</span><span class="lit">2.3</span><span class="pun">,</span><span class="lit">4.0</span><span class="pun">,</span><span class="lit">1.3</span><span class="pun">]</span></li><li class="L0"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">6.5</span><span class="pun">,</span><span class="lit">2.8</span><span class="pun">,</span><span class="lit">4.6</span><span class="pun">,</span><span class="lit">1.5</span><span class="pun">]</span></li><li class="L1"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">5.7</span><span class="pun">,</span><span class="lit">2.8</span><span class="pun">,</span><span class="lit">4.5</span><span class="pun">,</span><span class="lit">1.3</span><span class="pun">]</span></li><li class="L2"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">6.3</span><span class="pun">,</span><span class="lit">3.3</span><span class="pun">,</span><span class="lit">4.7</span><span class="pun">,</span><span class="lit">1.6</span><span class="pun">]</span></li><li class="L3"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">4.9</span><span class="pun">,</span><span class="lit">2.4</span><span class="pun">,</span><span class="lit">3.3</span><span class="pun">,</span><span class="lit">1.0</span><span class="pun">]</span></li><li class="L4"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">6.6</span><span class="pun">,</span><span class="lit">2.9</span><span class="pun">,</span><span class="lit">4.6</span><span class="pun">,</span><span class="lit">1.3</span><span class="pun">]</span></li><li class="L5"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">5.2</span><span class="pun">,</span><span class="lit">2.7</span><span class="pun">,</span><span class="lit">3.9</span><span class="pun">,</span><span class="lit">1.4</span><span class="pun">]</span></li><li class="L6"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">5.0</span><span class="pun">,</span><span class="lit">2.0</span><span class="pun">,</span><span class="lit">3.5</span><span class="pun">,</span><span class="lit">1.0</span><span class="pun">]</span></li><li class="L7"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">5.9</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">4.2</span><span class="pun">,</span><span class="lit">1.5</span><span class="pun">]</span></li><li class="L8"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">6.0</span><span class="pun">,</span><span class="lit">2.2</span><span class="pun">,</span><span class="lit">4.0</span><span class="pun">,</span><span class="lit">1.0</span><span class="pun">]</span></li><li class="L9"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">6.1</span><span class="pun">,</span><span class="lit">2.9</span><span class="pun">,</span><span class="lit">4.7</span><span class="pun">,</span><span class="lit">1.4</span><span class="pun">]</span></li><li class="L0"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">5.6</span><span class="pun">,</span><span class="lit">2.9</span><span class="pun">,</span><span class="lit">3.6</span><span class="pun">,</span><span class="lit">1.3</span><span class="pun">]</span></li><li class="L1"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">6.7</span><span class="pun">,</span><span class="lit">3.1</span><span class="pun">,</span><span class="lit">4.4</span><span class="pun">,</span><span class="lit">1.4</span><span class="pun">]</span></li><li class="L2"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">5.6</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">4.5</span><span class="pun">,</span><span class="lit">1.5</span><span class="pun">]</span></li><li class="L3"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">5.8</span><span class="pun">,</span><span class="lit">2.7</span><span class="pun">,</span><span class="lit">4.1</span><span class="pun">,</span><span class="lit">1.0</span><span class="pun">]</span></li><li class="L4"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">6.2</span><span class="pun">,</span><span class="lit">2.2</span><span class="pun">,</span><span class="lit">4.5</span><span class="pun">,</span><span class="lit">1.5</span><span class="pun">]</span></li><li class="L5"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">5.6</span><span class="pun">,</span><span class="lit">2.5</span><span class="pun">,</span><span class="lit">3.9</span><span class="pun">,</span><span class="lit">1.1</span><span class="pun">]</span></li><li class="L6"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">5.9</span><span class="pun">,</span><span class="lit">3.2</span><span class="pun">,</span><span class="lit">4.8</span><span class="pun">,</span><span class="lit">1.8</span><span class="pun">]</span></li><li class="L7"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">6.1</span><span class="pun">,</span><span class="lit">2.8</span><span class="pun">,</span><span class="lit">4.0</span><span class="pun">,</span><span class="lit">1.3</span><span class="pun">]</span></li><li class="L8"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">6.3</span><span class="pun">,</span><span class="lit">2.5</span><span class="pun">,</span><span class="lit">4.9</span><span class="pun">,</span><span class="lit">1.5</span><span class="pun">]</span></li><li class="L9"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">6.1</span><span class="pun">,</span><span class="lit">2.8</span><span class="pun">,</span><span class="lit">4.7</span><span class="pun">,</span><span class="lit">1.2</span><span class="pun">]</span></li><li class="L0"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">6.4</span><span class="pun">,</span><span class="lit">2.9</span><span class="pun">,</span><span class="lit">4.3</span><span class="pun">,</span><span class="lit">1.3</span><span class="pun">]</span></li><li class="L1"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">6.6</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">4.4</span><span class="pun">,</span><span class="lit">1.4</span><span class="pun">]</span></li><li class="L2"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">6.8</span><span class="pun">,</span><span class="lit">2.8</span><span class="pun">,</span><span class="lit">4.8</span><span class="pun">,</span><span class="lit">1.4</span><span class="pun">]</span></li><li class="L3"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">6.7</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">5.0</span><span class="pun">,</span><span class="lit">1.7</span><span class="pun">]</span></li><li class="L4"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">6.0</span><span class="pun">,</span><span class="lit">2.9</span><span class="pun">,</span><span class="lit">4.5</span><span class="pun">,</span><span class="lit">1.5</span><span class="pun">]</span></li><li class="L5"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">5.7</span><span class="pun">,</span><span class="lit">2.6</span><span class="pun">,</span><span class="lit">3.5</span><span class="pun">,</span><span class="lit">1.0</span><span class="pun">]</span></li><li class="L6"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">5.5</span><span class="pun">,</span><span class="lit">2.4</span><span class="pun">,</span><span class="lit">3.8</span><span class="pun">,</span><span class="lit">1.1</span><span class="pun">]</span></li><li class="L7"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">5.5</span><span class="pun">,</span><span class="lit">2.4</span><span class="pun">,</span><span class="lit">3.7</span><span class="pun">,</span><span class="lit">1.0</span><span class="pun">]</span></li><li class="L8"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">5.8</span><span class="pun">,</span><span class="lit">2.7</span><span class="pun">,</span><span class="lit">3.9</span><span class="pun">,</span><span class="lit">1.2</span><span class="pun">]</span></li><li class="L9"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">6.0</span><span class="pun">,</span><span class="lit">2.7</span><span class="pun">,</span><span class="lit">5.1</span><span class="pun">,</span><span class="lit">1.6</span><span class="pun">]</span></li><li class="L0"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">5.4</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">4.5</span><span class="pun">,</span><span class="lit">1.5</span><span class="pun">]</span></li><li class="L1"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">6.0</span><span class="pun">,</span><span class="lit">3.4</span><span class="pun">,</span><span class="lit">4.5</span><span class="pun">,</span><span class="lit">1.6</span><span class="pun">]</span></li><li class="L2"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">6.7</span><span class="pun">,</span><span class="lit">3.1</span><span class="pun">,</span><span class="lit">4.7</span><span class="pun">,</span><span class="lit">1.5</span><span class="pun">]</span></li><li class="L3"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">6.3</span><span class="pun">,</span><span class="lit">2.3</span><span class="pun">,</span><span class="lit">4.4</span><span class="pun">,</span><span class="lit">1.3</span><span class="pun">]</span></li><li class="L4"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">5.6</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">4.1</span><span class="pun">,</span><span class="lit">1.3</span><span class="pun">]</span></li><li class="L5"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">5.5</span><span class="pun">,</span><span class="lit">2.5</span><span class="pun">,</span><span class="lit">4.0</span><span class="pun">,</span><span class="lit">1.3</span><span class="pun">]</span></li><li class="L6"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">5.5</span><span class="pun">,</span><span class="lit">2.6</span><span class="pun">,</span><span class="lit">4.4</span><span class="pun">,</span><span class="lit">1.2</span><span class="pun">]</span></li><li class="L7"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">6.1</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">4.6</span><span class="pun">,</span><span class="lit">1.4</span><span class="pun">]</span></li><li class="L8"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">5.8</span><span class="pun">,</span><span class="lit">2.6</span><span class="pun">,</span><span class="lit">4.0</span><span class="pun">,</span><span class="lit">1.2</span><span class="pun">]</span></li><li class="L9"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">5.0</span><span class="pun">,</span><span class="lit">2.3</span><span class="pun">,</span><span class="lit">3.3</span><span class="pun">,</span><span class="lit">1.0</span><span class="pun">]</span></li><li class="L0"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">5.6</span><span class="pun">,</span><span class="lit">2.7</span><span class="pun">,</span><span class="lit">4.2</span><span class="pun">,</span><span class="lit">1.3</span><span class="pun">]</span></li><li class="L1"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">5.7</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">4.2</span><span class="pun">,</span><span class="lit">1.2</span><span class="pun">]</span></li><li class="L2"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">5.7</span><span class="pun">,</span><span class="lit">2.9</span><span class="pun">,</span><span class="lit">4.2</span><span class="pun">,</span><span class="lit">1.3</span><span class="pun">]</span></li><li class="L3"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">6.2</span><span class="pun">,</span><span class="lit">2.9</span><span class="pun">,</span><span class="lit">4.3</span><span class="pun">,</span><span class="lit">1.3</span><span class="pun">]</span></li><li class="L4"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">5.1</span><span class="pun">,</span><span class="lit">2.5</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">1.1</span><span class="pun">]</span></li><li class="L5"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">5.7</span><span class="pun">,</span><span class="lit">2.8</span><span class="pun">,</span><span class="lit">4.1</span><span class="pun">,</span><span class="lit">1.3</span><span class="pun">]</span></li><li class="L6"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.3</span><span class="pun">,</span><span class="lit">3.3</span><span class="pun">,</span><span class="lit">6.0</span><span class="pun">,</span><span class="lit">2.5</span><span class="pun">]</span></li><li class="L7"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">5.8</span><span class="pun">,</span><span class="lit">2.7</span><span class="pun">,</span><span class="lit">5.1</span><span class="pun">,</span><span class="lit">1.9</span><span class="pun">]</span></li><li class="L8"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">7.1</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">5.9</span><span class="pun">,</span><span class="lit">2.1</span><span class="pun">]</span></li><li class="L9"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.3</span><span class="pun">,</span><span class="lit">2.9</span><span class="pun">,</span><span class="lit">5.6</span><span class="pun">,</span><span class="lit">1.8</span><span class="pun">]</span></li><li class="L0"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.5</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">5.8</span><span class="pun">,</span><span class="lit">2.2</span><span class="pun">]</span></li><li class="L1"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">7.6</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">6.6</span><span class="pun">,</span><span class="lit">2.1</span><span class="pun">]</span></li><li class="L2"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">4.9</span><span class="pun">,</span><span class="lit">2.5</span><span class="pun">,</span><span class="lit">4.5</span><span class="pun">,</span><span class="lit">1.7</span><span class="pun">]</span></li><li class="L3"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">7.3</span><span class="pun">,</span><span class="lit">2.9</span><span class="pun">,</span><span class="lit">6.3</span><span class="pun">,</span><span class="lit">1.8</span><span class="pun">]</span></li><li class="L4"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.7</span><span class="pun">,</span><span class="lit">2.5</span><span class="pun">,</span><span class="lit">5.8</span><span class="pun">,</span><span class="lit">1.8</span><span class="pun">]</span></li><li class="L5"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">7.2</span><span class="pun">,</span><span class="lit">3.6</span><span class="pun">,</span><span class="lit">6.1</span><span class="pun">,</span><span class="lit">2.5</span><span class="pun">]</span></li><li class="L6"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.5</span><span class="pun">,</span><span class="lit">3.2</span><span class="pun">,</span><span class="lit">5.1</span><span class="pun">,</span><span class="lit">2.0</span><span class="pun">]</span></li><li class="L7"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.4</span><span class="pun">,</span><span class="lit">2.7</span><span class="pun">,</span><span class="lit">5.3</span><span class="pun">,</span><span class="lit">1.9</span><span class="pun">]</span></li><li class="L8"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.8</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">5.5</span><span class="pun">,</span><span class="lit">2.1</span><span class="pun">]</span></li><li class="L9"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">5.7</span><span class="pun">,</span><span class="lit">2.5</span><span class="pun">,</span><span class="lit">5.0</span><span class="pun">,</span><span class="lit">2.0</span><span class="pun">]</span></li><li class="L0"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">5.8</span><span class="pun">,</span><span class="lit">2.8</span><span class="pun">,</span><span class="lit">5.1</span><span class="pun">,</span><span class="lit">2.4</span><span class="pun">]</span></li><li class="L1"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.4</span><span class="pun">,</span><span class="lit">3.2</span><span class="pun">,</span><span class="lit">5.3</span><span class="pun">,</span><span class="lit">2.3</span><span class="pun">]</span></li><li class="L2"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.5</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">5.5</span><span class="pun">,</span><span class="lit">1.8</span><span class="pun">]</span></li><li class="L3"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">7.7</span><span class="pun">,</span><span class="lit">3.8</span><span class="pun">,</span><span class="lit">6.7</span><span class="pun">,</span><span class="lit">2.2</span><span class="pun">]</span></li><li class="L4"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">7.7</span><span class="pun">,</span><span class="lit">2.6</span><span class="pun">,</span><span class="lit">6.9</span><span class="pun">,</span><span class="lit">2.3</span><span class="pun">]</span></li><li class="L5"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.0</span><span class="pun">,</span><span class="lit">2.2</span><span class="pun">,</span><span class="lit">5.0</span><span class="pun">,</span><span class="lit">1.5</span><span class="pun">]</span></li><li class="L6"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.9</span><span class="pun">,</span><span class="lit">3.2</span><span class="pun">,</span><span class="lit">5.7</span><span class="pun">,</span><span class="lit">2.3</span><span class="pun">]</span></li><li class="L7"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">5.6</span><span class="pun">,</span><span class="lit">2.8</span><span class="pun">,</span><span class="lit">4.9</span><span class="pun">,</span><span class="lit">2.0</span><span class="pun">]</span></li><li class="L8"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">7.7</span><span class="pun">,</span><span class="lit">2.8</span><span class="pun">,</span><span class="lit">6.7</span><span class="pun">,</span><span class="lit">2.0</span><span class="pun">]</span></li><li class="L9"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.3</span><span class="pun">,</span><span class="lit">2.7</span><span class="pun">,</span><span class="lit">4.9</span><span class="pun">,</span><span class="lit">1.8</span><span class="pun">]</span></li><li class="L0"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.7</span><span class="pun">,</span><span class="lit">3.3</span><span class="pun">,</span><span class="lit">5.7</span><span class="pun">,</span><span class="lit">2.1</span><span class="pun">]</span></li><li class="L1"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">7.2</span><span class="pun">,</span><span class="lit">3.2</span><span class="pun">,</span><span class="lit">6.0</span><span class="pun">,</span><span class="lit">1.8</span><span class="pun">]</span></li><li class="L2"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.2</span><span class="pun">,</span><span class="lit">2.8</span><span class="pun">,</span><span class="lit">4.8</span><span class="pun">,</span><span class="lit">1.8</span><span class="pun">]</span></li><li class="L3"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.1</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">4.9</span><span class="pun">,</span><span class="lit">1.8</span><span class="pun">]</span></li><li class="L4"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.4</span><span class="pun">,</span><span class="lit">2.8</span><span class="pun">,</span><span class="lit">5.6</span><span class="pun">,</span><span class="lit">2.1</span><span class="pun">]</span></li><li class="L5"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">7.2</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">5.8</span><span class="pun">,</span><span class="lit">1.6</span><span class="pun">]</span></li><li class="L6"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">7.4</span><span class="pun">,</span><span class="lit">2.8</span><span class="pun">,</span><span class="lit">6.1</span><span class="pun">,</span><span class="lit">1.9</span><span class="pun">]</span></li><li class="L7"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">7.9</span><span class="pun">,</span><span class="lit">3.8</span><span class="pun">,</span><span class="lit">6.4</span><span class="pun">,</span><span class="lit">2.0</span><span class="pun">]</span></li><li class="L8"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.4</span><span class="pun">,</span><span class="lit">2.8</span><span class="pun">,</span><span class="lit">5.6</span><span class="pun">,</span><span class="lit">2.2</span><span class="pun">]</span></li><li class="L9"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.3</span><span class="pun">,</span><span class="lit">2.8</span><span class="pun">,</span><span class="lit">5.1</span><span class="pun">,</span><span class="lit">1.5</span><span class="pun">]</span></li><li class="L0"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.1</span><span class="pun">,</span><span class="lit">2.6</span><span class="pun">,</span><span class="lit">5.6</span><span class="pun">,</span><span class="lit">1.4</span><span class="pun">]</span></li><li class="L1"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">7.7</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">6.1</span><span class="pun">,</span><span class="lit">2.3</span><span class="pun">]</span></li><li class="L2"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.3</span><span class="pun">,</span><span class="lit">3.4</span><span class="pun">,</span><span class="lit">5.6</span><span class="pun">,</span><span class="lit">2.4</span><span class="pun">]</span></li><li class="L3"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.4</span><span class="pun">,</span><span class="lit">3.1</span><span class="pun">,</span><span class="lit">5.5</span><span class="pun">,</span><span class="lit">1.8</span><span class="pun">]</span></li><li class="L4"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.0</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">4.8</span><span class="pun">,</span><span class="lit">1.8</span><span class="pun">]</span></li><li class="L5"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.9</span><span class="pun">,</span><span class="lit">3.1</span><span class="pun">,</span><span class="lit">5.4</span><span class="pun">,</span><span class="lit">2.1</span><span class="pun">]</span></li><li class="L6"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.7</span><span class="pun">,</span><span class="lit">3.1</span><span class="pun">,</span><span class="lit">5.6</span><span class="pun">,</span><span class="lit">2.4</span><span class="pun">]</span></li><li class="L7"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.9</span><span class="pun">,</span><span class="lit">3.1</span><span class="pun">,</span><span class="lit">5.1</span><span class="pun">,</span><span class="lit">2.3</span><span class="pun">]</span></li><li class="L8"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">5.8</span><span class="pun">,</span><span class="lit">2.7</span><span class="pun">,</span><span class="lit">5.1</span><span class="pun">,</span><span class="lit">1.9</span><span class="pun">]</span></li><li class="L9"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.8</span><span class="pun">,</span><span class="lit">3.2</span><span class="pun">,</span><span class="lit">5.9</span><span class="pun">,</span><span class="lit">2.3</span><span class="pun">]</span></li><li class="L0"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.7</span><span class="pun">,</span><span class="lit">3.3</span><span class="pun">,</span><span class="lit">5.7</span><span class="pun">,</span><span class="lit">2.5</span><span class="pun">]</span></li><li class="L1"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.7</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">5.2</span><span class="pun">,</span><span class="lit">2.3</span><span class="pun">]</span></li><li class="L2"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.3</span><span class="pun">,</span><span class="lit">2.5</span><span class="pun">,</span><span class="lit">5.0</span><span class="pun">,</span><span class="lit">1.9</span><span class="pun">]</span></li><li class="L3"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.5</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">5.2</span><span class="pun">,</span><span class="lit">2.0</span><span class="pun">]</span></li><li class="L4"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.2</span><span class="pun">,</span><span class="lit">3.4</span><span class="pun">,</span><span class="lit">5.4</span><span class="pun">,</span><span class="lit">2.3</span><span class="pun">]</span></li><li class="L5"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">5.9</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">5.1</span><span class="pun">,</span><span class="lit">1.8</span><span class="pun">]</span></li></ol></pre><div class="code-pretty-toolbar"><span class="title">Python</span><a href="javascript:void(0);" title="复制代码" class="tool clipboard"><i class="fa fa-files-o"></i></a><a href="javascript:void(0);" title="查看纯文本代码" class="tool view-source"><i class="fa fa-code"></i></a><a href="javascript:void(0);" title="返回代码高亮" class="tool back-to-pretty"><i class="fa fa-undo"></i></a><span class="msg"></span></div></div>
<h5>3. 构建ML的pipeline</h5>
<p>​   分别获取标签列和特征列，进行索引，并进行了重命名。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-python prettyprinted" style=""><ol class="linenums"><li class="L0"><span class="pln">labelIndexer </span><span class="pun">=</span><span class="pln"> </span><span class="typ">StringIndexer</span><span class="pun">().</span><span class="pln">setInputCol</span><span class="pun">(</span><span class="str">"label"</span><span class="pun">).</span><span class="pln">setOutputCol</span><span class="pun">(</span><span class="str">"indexedLabel"</span><span class="pun">).</span><span class="pln">fit</span><span class="pun">(</span><span class="pln">df</span><span class="pun">)</span></li><li class="L1"><span class="pln">featureIndexer </span><span class="pun">=</span><span class="pln"> </span><span class="typ">VectorIndexer</span><span class="pun">().</span><span class="pln">setInputCol</span><span class="pun">(</span><span class="str">"features"</span><span class="pun">).</span><span class="pln">setOutputCol</span><span class="pun">(</span><span class="str">"indexedFeatures"</span><span class="pun">).</span><span class="pln">fit</span><span class="pun">(</span><span class="pln">df</span><span class="pun">)</span></li><li class="L2"><span class="pln">featureIndexer</span><span class="pun">:</span><span class="pln"> org</span><span class="pun">.</span><span class="pln">apache</span><span class="pun">.</span><span class="pln">spark</span><span class="pun">.</span><span class="pln">ml</span><span class="pun">.</span><span class="pln">feature</span><span class="pun">.</span><span class="typ">VectorIndexerModel</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> vecIdx_53b988077b38</span></li></ol></pre><div class="code-pretty-toolbar"><span class="title">Python</span><a href="javascript:void(0);" title="复制代码" class="tool clipboard"><i class="fa fa-files-o"></i></a><a href="javascript:void(0);" title="查看纯文本代码" class="tool view-source"><i class="fa fa-code"></i></a><a href="javascript:void(0);" title="返回代码高亮" class="tool back-to-pretty"><i class="fa fa-undo"></i></a><span class="msg"></span></div></div>
<p>​   接下来，我们把数据集随机分成训练集和测试集，其中训练集占70%。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-python prettyprinted" style=""><ol class="linenums"><li class="L0"><span class="pln">trainingData</span><span class="pun">,</span><span class="pln"> testData </span><span class="pun">=</span><span class="pln"> df</span><span class="pun">.</span><span class="pln">randomSplit</span><span class="pun">([</span><span class="lit">0.7</span><span class="pun">,</span><span class="lit">0.3</span><span class="pun">])</span></li></ol></pre><div class="code-pretty-toolbar"><span class="title">Python</span><a href="javascript:void(0);" title="复制代码" class="tool clipboard"><i class="fa fa-files-o"></i></a><a href="javascript:void(0);" title="查看纯文本代码" class="tool view-source"><i class="fa fa-code"></i></a><a href="javascript:void(0);" title="返回代码高亮" class="tool back-to-pretty"><i class="fa fa-undo"></i></a><span class="msg"></span></div></div>
<p>​   
然后，我们设置logistic的参数，这里我们统一用setter的方法来设置，也可以用ParamMap来设置（具体的可以查看spark 
mllib的官网）。这里我们设置了循环次数为10次，正则化项为0.3等，具体的可以设置的参数可以通过explainParams()来获取，还能看
到我们已经设置的参数的结果。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-python prettyprinted" style=""><ol class="linenums"><li class="L0"><span class="pln">lr </span><span class="pun">=</span><span class="pln"> </span><span class="typ">LogisticRegression</span><span class="pun">().</span><span class="pln">setLabelCol</span><span class="pun">(</span><span class="str">"indexedLabel"</span><span class="pun">).</span><span class="pln">setFeaturesCol</span><span class="pun">(</span><span class="str">"indexedFeatures"</span><span class="pun">).</span><span class="pln">setMaxIter</span><span class="pun">(</span><span class="lit">10</span><span class="pun">).</span><span class="pln">setRegParam</span><span class="pun">(</span><span class="lit">0.3</span><span class="pun">).</span><span class="pln">setElasticNetParam</span><span class="pun">(</span><span class="lit">0.8</span><span class="pun">)</span></li><li class="L1"><span class="kwd">print</span><span class="pun">(</span><span class="str">"LogisticRegression parameters:\n"</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> lr</span><span class="pun">.</span><span class="pln">explainParams</span><span class="pun">())</span></li><li class="L2"><span class="pln">&nbsp;</span></li><li class="L3"><span class="typ">LogisticRegression</span><span class="pln"> parameters</span><span class="pun">:</span></li><li class="L4"><span class="pln">aggregationDepth</span><span class="pun">:</span><span class="pln"> suggested depth </span><span class="kwd">for</span><span class="pln"> treeAggregate </span><span class="pun">(&gt;=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">).</span><span class="pln"> </span><span class="pun">(</span><span class="pln">default</span><span class="pun">:</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span></li><li class="L5"><span class="pln">elasticNetParam</span><span class="pun">:</span><span class="pln"> the </span><span class="typ">ElasticNet</span><span class="pln"> mixing parameter</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">in</span><span class="pln"> range </span><span class="pun">[</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">].</span><span class="pln"> </span><span class="typ">For</span><span class="pln"> alpha </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> the penalty </span><span class="kwd">is</span><span class="pln"> an L2 penalty</span><span class="pun">.</span><span class="pln"> </span><span class="typ">For</span><span class="pln"> alpha </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> it </span><span class="kwd">is</span><span class="pln"> an L1 penalty</span><span class="pun">.</span><span class="pln"> </span><span class="pun">(</span><span class="pln">default</span><span class="pun">:</span><span class="pln"> </span><span class="lit">0.0</span><span class="pun">,</span><span class="pln"> current</span><span class="pun">:</span><span class="pln"> </span><span class="lit">0.8</span><span class="pun">)</span></li><li class="L6"><span class="pln">family</span><span class="pun">:</span><span class="pln"> </span><span class="typ">The</span><span class="pln"> name of family which </span><span class="kwd">is</span><span class="pln"> a description of the label distribution to be used </span><span class="kwd">in</span><span class="pln"> the model</span><span class="pun">.</span><span class="pln"> </span><span class="typ">Supported</span><span class="pln"> options</span><span class="pun">:</span><span class="pln"> auto</span><span class="pun">,</span><span class="pln"> binomial</span><span class="pun">,</span><span class="pln"> multinomial </span><span class="pun">(</span><span class="pln">default</span><span class="pun">:</span><span class="pln"> auto</span><span class="pun">)</span></li><li class="L7"><span class="pln">featuresCol</span><span class="pun">:</span><span class="pln"> features column name</span><span class="pun">.</span><span class="pln"> </span><span class="pun">(</span><span class="pln">default</span><span class="pun">:</span><span class="pln"> features</span><span class="pun">,</span><span class="pln"> current</span><span class="pun">:</span><span class="pln"> indexedFeatures</span><span class="pun">)</span></li><li class="L8"><span class="pln">fitIntercept</span><span class="pun">:</span><span class="pln"> whether to fit an intercept term</span><span class="pun">.</span><span class="pln"> </span><span class="pun">(</span><span class="pln">default</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">True</span><span class="pun">)</span></li><li class="L9"><span class="pln">labelCol</span><span class="pun">:</span><span class="pln"> label column name</span><span class="pun">.</span><span class="pln"> </span><span class="pun">(</span><span class="pln">default</span><span class="pun">:</span><span class="pln"> label</span><span class="pun">,</span><span class="pln"> current</span><span class="pun">:</span><span class="pln"> indexedLabel</span><span class="pun">)</span></li><li class="L0"><span class="pln">maxIter</span><span class="pun">:</span><span class="pln"> max number of iterations </span><span class="pun">(&gt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">).</span><span class="pln"> </span><span class="pun">(</span><span class="pln">default</span><span class="pun">:</span><span class="pln"> </span><span class="lit">100</span><span class="pun">,</span><span class="pln"> current</span><span class="pun">:</span><span class="pln"> </span><span class="lit">10</span><span class="pun">)</span></li><li class="L1"><span class="pln">predictionCol</span><span class="pun">:</span><span class="pln"> prediction column name</span><span class="pun">.</span><span class="pln"> </span><span class="pun">(</span><span class="pln">default</span><span class="pun">:</span><span class="pln"> prediction</span><span class="pun">)</span></li><li class="L2"><span class="pln">probabilityCol</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Column</span><span class="pln"> name </span><span class="kwd">for</span><span class="pln"> predicted </span><span class="kwd">class</span><span class="pln"> conditional probabilities</span><span class="pun">.</span><span class="pln"> </span><span class="typ">Note</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Not</span><span class="pln"> all models output well</span><span class="pun">-</span><span class="pln">calibrated probability estimates</span><span class="pun">!</span><span class="pln"> </span><span class="typ">These</span><span class="pln"> probabilities should be treated </span><span class="kwd">as</span><span class="pln"> confidences</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> precise probabilities</span><span class="pun">.</span><span class="pln"> </span><span class="pun">(</span><span class="pln">default</span><span class="pun">:</span><span class="pln"> probability</span><span class="pun">)</span></li><li class="L3"><span class="pln">rawPredictionCol</span><span class="pun">:</span><span class="pln"> raw prediction </span><span class="pun">(</span><span class="pln">a</span><span class="pun">.</span><span class="pln">k</span><span class="pun">.</span><span class="pln">a</span><span class="pun">.</span><span class="pln"> confidence</span><span class="pun">)</span><span class="pln"> column name</span><span class="pun">.</span><span class="pln"> </span><span class="pun">(</span><span class="pln">default</span><span class="pun">:</span><span class="pln"> rawPrediction</span><span class="pun">)</span></li><li class="L4"><span class="pln">regParam</span><span class="pun">:</span><span class="pln"> regularization parameter </span><span class="pun">(&gt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">).</span><span class="pln"> </span><span class="pun">(</span><span class="pln">default</span><span class="pun">:</span><span class="pln"> </span><span class="lit">0.0</span><span class="pun">,</span><span class="pln"> current</span><span class="pun">:</span><span class="pln"> </span><span class="lit">0.3</span><span class="pun">)</span></li><li class="L5"><span class="pln">standardization</span><span class="pun">:</span><span class="pln"> whether to standardize the training features before fitting the model</span><span class="pun">.</span><span class="pln"> </span><span class="pun">(</span><span class="pln">default</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">True</span><span class="pun">)</span></li><li class="L6"><span class="pln">threshold</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Threshold</span><span class="pln"> </span><span class="kwd">in</span><span class="pln"> binary classification prediction</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">in</span><span class="pln"> range </span><span class="pun">[</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">].</span><span class="pln"> </span><span class="typ">If</span><span class="pln"> threshold </span><span class="kwd">and</span><span class="pln"> thresholds are both set</span><span class="pun">,</span><span class="pln"> they must match</span><span class="pun">.</span><span class="pln">e</span><span class="pun">.</span><span class="pln">g</span><span class="pun">.</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> threshold </span><span class="kwd">is</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> then thresholds must be equal to </span><span class="pun">[</span><span class="lit">1</span><span class="pun">-</span><span class="pln">p</span><span class="pun">,</span><span class="pln"> p</span><span class="pun">].</span><span class="pln"> </span><span class="pun">(</span><span class="pln">default</span><span class="pun">:</span><span class="pln"> </span><span class="lit">0.5</span><span class="pun">)</span></li><li class="L7"><span class="pln">thresholds</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Thresholds</span><span class="pln"> </span><span class="kwd">in</span><span class="pln"> multi</span><span class="pun">-</span><span class="kwd">class</span><span class="pln"> classification to adjust the probability of predicting each </span><span class="kwd">class</span><span class="pun">.</span><span class="pln"> </span><span class="typ">Array</span><span class="pln"> must have length equal to the number of classes</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">with</span><span class="pln"> values </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> excepting that at most one value may be </span><span class="lit">0.</span><span class="pln"> </span><span class="typ">The</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="kwd">with</span><span class="pln"> largest value p</span><span class="pun">/</span><span class="pln">t </span><span class="kwd">is</span><span class="pln"> predicted</span><span class="pun">,</span><span class="pln"> where p </span><span class="kwd">is</span><span class="pln"> the original probability of that </span><span class="kwd">class</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> t </span><span class="kwd">is</span><span class="pln"> the </span><span class="kwd">class</span><span class="str">'s threshold. (undefined)</span></li><li class="L8"><span class="str">tol: the convergence tolerance for iterative algorithms (&gt;= 0). (default: 1e-06)</span></li><li class="L9"><span class="str">weightCol: weight column name. If this is not set or empty, we treat all instance weights as 1.0. (undefined)</span></li><li class="L0"><span class="str">&nbsp;</span></li></ol></pre><div class="code-pretty-toolbar"><span class="title">Python</span><a href="javascript:void(0);" title="复制代码" class="tool clipboard"><i class="fa fa-files-o"></i></a><a href="javascript:void(0);" title="查看纯文本代码" class="tool view-source"><i class="fa fa-code"></i></a><a href="javascript:void(0);" title="返回代码高亮" class="tool back-to-pretty"><i class="fa fa-undo"></i></a><span class="msg"></span></div></div>
<p>​   这里我们设置一个labelConverter，目的是把预测的类别重新转化成字符型的。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-python prettyprinted" style=""><ol class="linenums"><li class="L0"><span class="pln">labelConverter </span><span class="pun">=</span><span class="pln"> </span><span class="typ">IndexToString</span><span class="pun">().</span><span class="pln">setInputCol</span><span class="pun">(</span><span class="str">"prediction"</span><span class="pun">).</span><span class="pln">setOutputCol</span><span class="pun">(</span><span class="str">"predictedLabel"</span><span class="pun">).</span><span class="pln">setLabels</span><span class="pun">(</span><span class="pln">labelIndexer</span><span class="pun">.</span><span class="pln">labels</span><span class="pun">)</span></li></ol></pre><div class="code-pretty-toolbar"><span class="title">Python</span><a href="javascript:void(0);" title="复制代码" class="tool clipboard"><i class="fa fa-files-o"></i></a><a href="javascript:void(0);" title="查看纯文本代码" class="tool view-source"><i class="fa fa-code"></i></a><a href="javascript:void(0);" title="返回代码高亮" class="tool back-to-pretty"><i class="fa fa-undo"></i></a><span class="msg"></span></div></div>
<p>​   构建pipeline，设置stage，然后调用fit()来训练模型。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-python prettyprinted" style=""><ol class="linenums"><li class="L0"><span class="pln">lrPipeline </span><span class="pun">=</span><span class="pln">  </span><span class="typ">Pipeline</span><span class="pun">().</span><span class="pln">setStages</span><span class="pun">([</span><span class="pln">labelIndexer</span><span class="pun">,</span><span class="pln"> featureIndexer</span><span class="pun">,</span><span class="pln"> lr</span><span class="pun">,</span><span class="pln"> labelConverter</span><span class="pun">])</span></li><li class="L1"><span class="pln">lrPipelineModel </span><span class="pun">=</span><span class="pln"> lrPipeline</span><span class="pun">.</span><span class="pln">fit</span><span class="pun">(</span><span class="pln">trainingData</span><span class="pun">)</span></li></ol></pre><div class="code-pretty-toolbar"><span class="title">Python</span><a href="javascript:void(0);" title="复制代码" class="tool clipboard"><i class="fa fa-files-o"></i></a><a href="javascript:void(0);" title="查看纯文本代码" class="tool view-source"><i class="fa fa-code"></i></a><a href="javascript:void(0);" title="返回代码高亮" class="tool back-to-pretty"><i class="fa fa-undo"></i></a><span class="msg"></span></div></div>
<p>​   
pipeline本质上是一个Estimator，当pipeline调用fit()的时候就产生了一个PipelineModel，本质上是一个
Transformer。然后这个PipelineModel就可以调用transform()来进行预测，生成一个新的DataFrame，即利用训练
得到的模型对测试集进行验证。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-python prettyprinted" style=""><ol class="linenums"><li class="L0"><span class="pln">lrPredictions </span><span class="pun">=</span><span class="pln"> lrPipelineModel</span><span class="pun">.</span><span class="pln">transform</span><span class="pun">(</span><span class="pln">testData</span><span class="pun">)</span></li></ol></pre><div class="code-pretty-toolbar"><span class="title">Python</span><a href="javascript:void(0);" title="复制代码" class="tool clipboard"><i class="fa fa-files-o"></i></a><a href="javascript:void(0);" title="查看纯文本代码" class="tool view-source"><i class="fa fa-code"></i></a><a href="javascript:void(0);" title="返回代码高亮" class="tool back-to-pretty"><i class="fa fa-undo"></i></a><span class="msg"></span></div></div>
<p>​   最后我们可以输出预测的结果，其中select选择要输出的列，collect获取所有行的数据，用foreach把每行打印出来。其中打印出来的值依次分别代表该行数据的真实分类和特征值、预测属于不同分类的概率、预测的分类。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-python prettyprinted" style=""><ol class="linenums"><li class="L0"><span class="pln">preRel </span><span class="pun">=</span><span class="pln"> lrPredictions</span><span class="pun">.</span><span class="pln">select</span><span class="pun">(</span><span class="str">"predictedLabel"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"label"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"features"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"probability"</span><span class="pun">).</span><span class="pln">collect</span><span class="pun">()</span></li><li class="L1"><span class="kwd">for</span><span class="pln"> item </span><span class="kwd">in</span><span class="pln"> preRel</span><span class="pun">:</span></li><li class="L2"><span class="pln">    </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">str</span><span class="pun">(</span><span class="pln">item</span><span class="pun">[</span><span class="str">'label'</span><span class="pun">])+</span><span class="str">','</span><span class="pun">+</span><span class="pln">str</span><span class="pun">(</span><span class="pln">item</span><span class="pun">[</span><span class="str">'features'</span><span class="pun">])+</span><span class="str">'--&gt;prob='</span><span class="pun">+</span><span class="pln">str</span><span class="pun">(</span><span class="pln">item</span><span class="pun">[</span><span class="str">'probability'</span><span class="pun">])+</span><span class="str">',predictedLabel'</span><span class="pun">+</span><span class="pln">str</span><span class="pun">(</span><span class="pln">item</span><span class="pun">[</span><span class="str">'predictedLabel'</span><span class="pun">]))</span></li><li class="L3"><span class="pln">&nbsp;</span></li><li class="L4"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">,[</span><span class="lit">5.2</span><span class="pun">,</span><span class="lit">2.7</span><span class="pun">,</span><span class="lit">3.9</span><span class="pun">,</span><span class="lit">1.4</span><span class="pun">]--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.474125433289</span><span class="pun">,</span><span class="lit">0.525874566711</span><span class="pun">],</span><span class="pln">predictedLabelIris</span><span class="pun">-</span><span class="pln">virginica</span></li><li class="L5"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">,[</span><span class="lit">5.5</span><span class="pun">,</span><span class="lit">2.3</span><span class="pun">,</span><span class="lit">4.0</span><span class="pun">,</span><span class="lit">1.3</span><span class="pun">]--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.498724224708</span><span class="pun">,</span><span class="lit">0.501275775292</span><span class="pun">],</span><span class="pln">predictedLabelIris</span><span class="pun">-</span><span class="pln">virginica</span></li><li class="L6"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">,[</span><span class="lit">5.6</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">4.5</span><span class="pun">,</span><span class="lit">1.5</span><span class="pun">]--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.456659495584</span><span class="pun">,</span><span class="lit">0.543340504416</span><span class="pun">],</span><span class="pln">predictedLabelIris</span><span class="pun">-</span><span class="pln">virginica</span></li><li class="L7"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">,[</span><span class="lit">5.9</span><span class="pun">,</span><span class="lit">3.2</span><span class="pun">,</span><span class="lit">4.8</span><span class="pun">,</span><span class="lit">1.8</span><span class="pun">]--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.396329949568</span><span class="pun">,</span><span class="lit">0.603670050432</span><span class="pun">],</span><span class="pln">predictedLabelIris</span><span class="pun">-</span><span class="pln">virginica</span></li><li class="L8"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">,[</span><span class="lit">6.3</span><span class="pun">,</span><span class="lit">3.3</span><span class="pun">,</span><span class="lit">4.7</span><span class="pun">,</span><span class="lit">1.6</span><span class="pun">]--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.442287021876</span><span class="pun">,</span><span class="lit">0.557712978124</span><span class="pun">],</span><span class="pln">predictedLabelIris</span><span class="pun">-</span><span class="pln">virginica</span></li><li class="L9"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">,[</span><span class="lit">6.4</span><span class="pun">,</span><span class="lit">2.9</span><span class="pun">,</span><span class="lit">4.3</span><span class="pun">,</span><span class="lit">1.3</span><span class="pun">]--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.507813688472</span><span class="pun">,</span><span class="lit">0.492186311528</span><span class="pun">],</span><span class="pln">predictedLabelIris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L0"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">,[</span><span class="lit">6.7</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">5.0</span><span class="pun">,</span><span class="lit">1.7</span><span class="pun">]--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.42504596458</span><span class="pun">,</span><span class="lit">0.57495403542</span><span class="pun">],</span><span class="pln">predictedLabelIris</span><span class="pun">-</span><span class="pln">virginica</span></li><li class="L1"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">,[</span><span class="lit">4.9</span><span class="pun">,</span><span class="lit">2.5</span><span class="pun">,</span><span class="lit">4.5</span><span class="pun">,</span><span class="lit">1.7</span><span class="pun">]--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.407378398796</span><span class="pun">,</span><span class="lit">0.592621601204</span><span class="pun">],</span><span class="pln">predictedLabelIris</span><span class="pun">-</span><span class="pln">virginica</span></li><li class="L2"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">,[</span><span class="lit">5.5</span><span class="pun">,</span><span class="lit">2.4</span><span class="pun">,</span><span class="lit">3.8</span><span class="pun">,</span><span class="lit">1.1</span><span class="pun">]--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.541810138118</span><span class="pun">,</span><span class="lit">0.458189861882</span><span class="pun">],</span><span class="pln">predictedLabelIris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L3"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">,[</span><span class="lit">5.5</span><span class="pun">,</span><span class="lit">2.5</span><span class="pun">,</span><span class="lit">4.0</span><span class="pun">,</span><span class="lit">1.3</span><span class="pun">]--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.498724224708</span><span class="pun">,</span><span class="lit">0.501275775292</span><span class="pun">],</span><span class="pln">predictedLabelIris</span><span class="pun">-</span><span class="pln">virginica</span></li><li class="L4"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">,[</span><span class="lit">5.5</span><span class="pun">,</span><span class="lit">2.6</span><span class="pun">,</span><span class="lit">4.4</span><span class="pun">,</span><span class="lit">1.2</span><span class="pun">]--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.520304937567</span><span class="pun">,</span><span class="lit">0.479695062433</span><span class="pun">],</span><span class="pln">predictedLabelIris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L5"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">,[</span><span class="lit">5.7</span><span class="pun">,</span><span class="lit">2.6</span><span class="pun">,</span><span class="lit">3.5</span><span class="pun">,</span><span class="lit">1.0</span><span class="pun">]--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.565147445416</span><span class="pun">,</span><span class="lit">0.434852554584</span><span class="pun">],</span><span class="pln">predictedLabelIris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L6"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">,[</span><span class="lit">5.8</span><span class="pun">,</span><span class="lit">2.7</span><span class="pun">,</span><span class="lit">3.9</span><span class="pun">,</span><span class="lit">1.2</span><span class="pun">]--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.523329193496</span><span class="pun">,</span><span class="lit">0.476670806504</span><span class="pun">],</span><span class="pln">predictedLabelIris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L7"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">,[</span><span class="lit">5.8</span><span class="pun">,</span><span class="lit">2.7</span><span class="pun">,</span><span class="lit">5.1</span><span class="pun">,</span><span class="lit">1.9</span><span class="pun">]--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.374915000487</span><span class="pun">,</span><span class="lit">0.625084999513</span><span class="pun">],</span><span class="pln">predictedLabelIris</span><span class="pun">-</span><span class="pln">virginica</span></li><li class="L8"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">,[</span><span class="lit">5.8</span><span class="pun">,</span><span class="lit">2.8</span><span class="pun">,</span><span class="lit">5.1</span><span class="pun">,</span><span class="lit">2.4</span><span class="pun">]--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.280289494118</span><span class="pun">,</span><span class="lit">0.719710505882</span><span class="pun">],</span><span class="pln">predictedLabelIris</span><span class="pun">-</span><span class="pln">virginica</span></li><li class="L9"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">,[</span><span class="lit">6.0</span><span class="pun">,</span><span class="lit">2.7</span><span class="pun">,</span><span class="lit">5.1</span><span class="pun">,</span><span class="lit">1.6</span><span class="pun">]--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.43929948357</span><span class="pun">,</span><span class="lit">0.56070051643</span><span class="pun">],</span><span class="pln">predictedLabelIris</span><span class="pun">-</span><span class="pln">virginica</span></li><li class="L0"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">,[</span><span class="lit">6.1</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">4.9</span><span class="pun">,</span><span class="lit">1.8</span><span class="pun">]--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.398264741954</span><span class="pun">,</span><span class="lit">0.601735258046</span><span class="pun">],</span><span class="pln">predictedLabelIris</span><span class="pun">-</span><span class="pln">virginica</span></li><li class="L1"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">,[</span><span class="lit">6.3</span><span class="pun">,</span><span class="lit">2.8</span><span class="pun">,</span><span class="lit">5.1</span><span class="pun">,</span><span class="lit">1.5</span><span class="pun">]--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.463684596073</span><span class="pun">,</span><span class="lit">0.536315403927</span><span class="pun">],</span><span class="pln">predictedLabelIris</span><span class="pun">-</span><span class="pln">virginica</span></li><li class="L2"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">,[</span><span class="lit">6.3</span><span class="pun">,</span><span class="lit">3.3</span><span class="pun">,</span><span class="lit">6.0</span><span class="pun">,</span><span class="lit">2.5</span><span class="pun">]--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.267137732158</span><span class="pun">,</span><span class="lit">0.732862267842</span><span class="pun">],</span><span class="pln">predictedLabelIris</span><span class="pun">-</span><span class="pln">virginica</span></li><li class="L3"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">,[</span><span class="lit">6.5</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">5.2</span><span class="pun">,</span><span class="lit">2.0</span><span class="pun">]--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.361404006967</span><span class="pun">,</span><span class="lit">0.638595993033</span><span class="pun">],</span><span class="pln">predictedLabelIris</span><span class="pun">-</span><span class="pln">virginica</span></li><li class="L4"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">,[</span><span class="lit">6.5</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">5.5</span><span class="pun">,</span><span class="lit">1.8</span><span class="pun">]--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.402143821718</span><span class="pun">,</span><span class="lit">0.597856178282</span><span class="pun">],</span><span class="pln">predictedLabelIris</span><span class="pun">-</span><span class="pln">virginica</span></li><li class="L5"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">,[</span><span class="lit">6.7</span><span class="pun">,</span><span class="lit">2.5</span><span class="pun">,</span><span class="lit">5.8</span><span class="pun">,</span><span class="lit">1.8</span><span class="pun">]--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.404087997603</span><span class="pun">,</span><span class="lit">0.595912002397</span><span class="pun">],</span><span class="pln">predictedLabelIris</span><span class="pun">-</span><span class="pln">virginica</span></li><li class="L6"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">,[</span><span class="lit">6.9</span><span class="pun">,</span><span class="lit">3.1</span><span class="pun">,</span><span class="lit">5.4</span><span class="pun">,</span><span class="lit">2.1</span><span class="pun">]--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.345363437071</span><span class="pun">,</span><span class="lit">0.654636562929</span><span class="pun">],</span><span class="pln">predictedLabelIris</span><span class="pun">-</span><span class="pln">virginica</span></li><li class="L7"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">,[</span><span class="lit">7.3</span><span class="pun">,</span><span class="lit">2.9</span><span class="pun">,</span><span class="lit">6.3</span><span class="pun">,</span><span class="lit">1.8</span><span class="pun">]--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.409938392379</span><span class="pun">,</span><span class="lit">0.590061607621</span><span class="pun">],</span><span class="pln">predictedLabelIris</span><span class="pun">-</span><span class="pln">virginica</span></li><li class="L8"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">,[</span><span class="lit">7.4</span><span class="pun">,</span><span class="lit">2.8</span><span class="pun">,</span><span class="lit">6.1</span><span class="pun">,</span><span class="lit">1.9</span><span class="pun">]--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.390181923993</span><span class="pun">,</span><span class="lit">0.609818076007</span><span class="pun">],</span><span class="pln">predictedLabelIris</span><span class="pun">-</span><span class="pln">virginica</span></li></ol></pre><div class="code-pretty-toolbar"><span class="title">Python</span><a href="javascript:void(0);" title="复制代码" class="tool clipboard"><i class="fa fa-files-o"></i></a><a href="javascript:void(0);" title="查看纯文本代码" class="tool view-source"><i class="fa fa-code"></i></a><a href="javascript:void(0);" title="返回代码高亮" class="tool back-to-pretty"><i class="fa fa-undo"></i></a><span class="msg"></span></div></div>
<h5>4. 模型评估</h5>
<p>​   创建一个MulticlassClassificationEvaluator实例，用setter方法把预测分类的列名和真实分类的列名进行设置；然后计算预测准确率和错误率。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-python prettyprinted" style=""><ol class="linenums"><li class="L0"><span class="pln">evaluator </span><span class="pun">=</span><span class="pln"> </span><span class="typ">MulticlassClassificationEvaluator</span><span class="pun">().</span><span class="pln">setLabelCol</span><span class="pun">(</span><span class="str">"indexedLabel"</span><span class="pun">).</span><span class="pln">setPredictionCol</span><span class="pun">(</span><span class="str">"prediction"</span><span class="pun">)</span></li><li class="L1"><span class="pln">lrAccuracy </span><span class="pun">=</span><span class="pln"> evaluator</span><span class="pun">.</span><span class="pln">evaluate</span><span class="pun">(</span><span class="pln">lrPredictions</span><span class="pun">)</span></li><li class="L2"><span class="kwd">print</span><span class="pun">(</span><span class="str">"Test Error = "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> str</span><span class="pun">(</span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> lrAccuracy</span><span class="pun">))</span></li><li class="L3"><span class="typ">Test</span><span class="pln"> </span><span class="typ">Error</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0.35111111111111115</span></li></ol></pre><div class="code-pretty-toolbar"><span class="title">Python</span><a href="javascript:void(0);" title="复制代码" class="tool clipboard"><i class="fa fa-files-o"></i></a><a href="javascript:void(0);" title="查看纯文本代码" class="tool view-source"><i class="fa fa-code"></i></a><a href="javascript:void(0);" title="返回代码高亮" class="tool back-to-pretty"><i class="fa fa-undo"></i></a><span class="msg"></span></div></div>
<p>​   从上面可以看到预测的准确性达到65%，接下来我们可以通过model来获取我们训练得到的逻辑斯蒂模型。前面已经说过model是一个PipelineModel，因此我们可以通过调用它的stages来获取模型，具体如下：</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-python prettyprinted" style=""><ol class="linenums"><li class="L0"><span class="pln">lrModel </span><span class="pun">=</span><span class="pln"> lrPipelineModel</span><span class="pun">.</span><span class="pln">stages</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span></li><li class="L1"><span class="kwd">print</span><span class="pun">(</span><span class="str">"Coefficients: "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> str</span><span class="pun">(</span><span class="pln">lrModel</span><span class="pun">.</span><span class="pln">coefficients</span><span class="pun">)+</span><span class="str">"Intercept: "</span><span class="pun">+</span><span class="pln">str</span><span class="pun">(</span><span class="pln">lrModel</span><span class="pun">.</span><span class="pln">intercept</span><span class="pun">)+</span><span class="str">"numClasses: "</span><span class="pun">+</span><span class="pln">str</span><span class="pun">(</span><span class="pln">lrModel</span><span class="pun">.</span><span class="pln">numClasses</span><span class="pun">)+</span><span class="str">"numFeatures: "</span><span class="pun">+</span><span class="pln">str</span><span class="pun">(</span><span class="pln">lrModel</span><span class="pun">.</span><span class="pln">numFeatures</span><span class="pun">))</span></li><li class="L2"><span class="typ">Coefficients</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[-</span><span class="lit">0.0396171957643483</span><span class="pun">,</span><span class="lit">0.0</span><span class="pun">,</span><span class="lit">0.0</span><span class="pun">,</span><span class="lit">0.07240315639651046</span><span class="pun">]</span><span class="typ">Intercept</span><span class="pun">:</span><span class="pln"> </span><span class="pun">-</span><span class="lit">0.23127346342015379numClasses</span><span class="pun">:</span><span class="pln"> </span><span class="lit">2numFeatures</span><span class="pun">:</span><span class="pln"> </span><span class="lit">4</span></li></ol></pre><div class="code-pretty-toolbar"><span class="title">Python</span><a href="javascript:void(0);" title="复制代码" class="tool clipboard"><i class="fa fa-files-o"></i></a><a href="javascript:void(0);" title="查看纯文本代码" class="tool view-source"><i class="fa fa-code"></i></a><a href="javascript:void(0);" title="返回代码高亮" class="tool back-to-pretty"><i class="fa fa-undo"></i></a><span class="msg"></span></div></div>
<h5>5. 模型评估</h5>
<p>​   spark的ml库还提供了一个对模型的摘要总结（summary），不过目前只支持二项逻辑斯蒂回归，而且要显示转化成<code>BinaryLogisticRegressionSummary</code> 。在下面的代码中，首先获得二项逻辑斯模型的摘要；然后获得10次循环中损失函数的变化，并将结果打印出来，可以看到损失函数随着循环是逐渐变小的，损失函数越小，模型就越好；接下来，我们把摘要强制转化为<code>BinaryLogisticRegressionSummary</code>
 ，来获取用来评估模型性能的矩阵；通过获取ROC，我们可以判断模型的好坏，areaUnderROC达到了 
0.969551282051282，说明我们的分类器还是不错的；最后，我们通过最大化fMeasure来选取最合适的阈值，其中fMeasure是一
个综合了召回率和准确率的指标，通过最大化fMeasure，我们可以选取到用来分类的最合适的阈值。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-python prettyprinted" style=""><ol class="linenums"><li class="L0"><span class="pln">trainingSummary </span><span class="pun">=</span><span class="pln"> lrModel</span><span class="pun">.</span><span class="pln">summary</span></li><li class="L1"><span class="pln">objectiveHistory </span><span class="pun">=</span><span class="pln"> trainingSummary</span><span class="pun">.</span><span class="pln">objectiveHistory</span></li><li class="L2"><span class="kwd">for</span><span class="pln"> item </span><span class="kwd">in</span><span class="pln"> objectiveHistory</span><span class="pun">:</span></li><li class="L3"><span class="pun">...</span><span class="pln">     </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">item</span><span class="pun">)</span></li><li class="L4"><span class="pun">...</span><span class="pln"> </span></li><li class="L5"><span class="lit">0.6930582890371242</span></li><li class="L6"><span class="lit">0.6899151958544979</span></li><li class="L7"><span class="lit">0.6884360489604017</span></li><li class="L8"><span class="lit">0.6866214680339037</span></li><li class="L9"><span class="lit">0.6824264404293411</span></li><li class="L0"><span class="lit">0.6734525297891238</span></li><li class="L1"><span class="lit">0.6718869589782477</span></li><li class="L2"><span class="lit">0.6700321119842002</span></li><li class="L3"><span class="lit">0.6681741952485035</span></li><li class="L4"><span class="lit">0.6668744860924799</span></li><li class="L5"><span class="lit">0.6656055740433819</span></li><li class="L6"><span class="pln">&nbsp;</span></li><li class="L7"><span class="pln">&nbsp;</span></li><li class="L8"><span class="kwd">print</span><span class="pun">(</span><span class="pln">trainingSummary</span><span class="pun">.</span><span class="pln">areaUnderROC</span><span class="pun">)</span></li><li class="L9"><span class="lit">0.9889758179231863</span></li><li class="L0"><span class="pln">&nbsp;</span></li><li class="L1"><span class="pln">fMeasure </span><span class="pun">=</span><span class="pln"> trainningSummary</span><span class="pun">.</span><span class="pln">fMeasureByThreshold</span></li><li class="L2"><span class="pln">&nbsp;</span></li><li class="L3"><span class="pln">maxFMeasure </span><span class="pun">=</span><span class="pln"> fMeasure</span><span class="pun">.</span><span class="pln">select</span><span class="pun">(</span><span class="pln">functions</span><span class="pun">.</span><span class="pln">max</span><span class="pun">(</span><span class="str">"F-Measure"</span><span class="pun">)).</span><span class="pln">head</span><span class="pun">()[</span><span class="lit">0</span><span class="pun">]</span></li><li class="L4"><span class="lit">0.9599999999999999</span></li><li class="L5"><span class="pln">&nbsp;</span></li><li class="L6"><span class="pln">bestThreshold </span><span class="pun">=</span><span class="pln"> fMeasure</span><span class="pun">.</span><span class="pln">where</span><span class="pun">(</span><span class="pln">fMeasure</span><span class="pun">[</span><span class="str">"F-Measure"</span><span class="pun">]==</span><span class="pln"> maxFMeasure</span><span class="pun">).</span><span class="pln">select</span><span class="pun">(</span><span class="str">"threshold"</span><span class="pun">).</span><span class="pln">head</span><span class="pun">()[</span><span class="lit">0</span><span class="pun">]</span></li><li class="L7"><span class="lit">0.5487261156903904</span></li><li class="L8"><span class="pln">&nbsp;</span></li><li class="L9"><span class="pln">lr</span><span class="pun">.</span><span class="pln">setThreshold</span><span class="pun">(</span><span class="pln">bestThreshold</span><span class="pun">)</span></li></ol></pre><div class="code-pretty-toolbar"><span class="title">Python</span><a href="javascript:void(0);" title="复制代码" class="tool clipboard"><i class="fa fa-files-o"></i></a><a href="javascript:void(0);" title="查看纯文本代码" class="tool view-source"><i class="fa fa-code"></i></a><a href="javascript:void(0);" title="返回代码高亮" class="tool back-to-pretty"><i class="fa fa-undo"></i></a><span class="msg"></span></div></div>
<h4>用多项逻辑斯蒂回归解决 二分类 问题</h4>
<p>​   对于二分类问题，我们还可以用多项逻辑斯蒂回归进行多分类分析。多项逻辑斯蒂回归与二项逻辑斯蒂回归类似，只是在模型设置上把family参数设置成multinomial，这里我们仅列出结果：</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-python prettyprinted" style=""><ol class="linenums"><li class="L0"><span class="pln">mlr </span><span class="pun">=</span><span class="pln">  </span><span class="typ">LogisticRegression</span><span class="pun">().</span><span class="pln">setLabelCol</span><span class="pun">(</span><span class="str">"indexedLabel"</span><span class="pun">).</span><span class="pln">setFeaturesCol</span><span class="pun">(</span><span class="str">"indexedFeatures"</span><span class="pun">).</span><span class="pln">setMaxIter</span><span class="pun">(</span><span class="lit">10</span><span class="pun">).</span><span class="pln">setRegParam</span><span class="pun">(</span><span class="lit">0.3</span><span class="pun">).</span><span class="pln">setElasticNetParam</span><span class="pun">(</span><span class="lit">0.8</span><span class="pun">).</span><span class="pln">setFamily</span><span class="pun">(</span><span class="str">"multinomial"</span><span class="pun">)</span></li><li class="L1"><span class="pln">&nbsp;</span></li><li class="L2"><span class="pln">mlrPipeline </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Pipeline</span><span class="pun">().</span><span class="pln">setStages</span><span class="pun">([</span><span class="pln">labelIndexer</span><span class="pun">,</span><span class="pln"> featureIndexer</span><span class="pun">,</span><span class="pln"> mlr</span><span class="pun">,</span><span class="pln"> labelConverter</span><span class="pun">])</span></li><li class="L3"><span class="pln">&nbsp;</span></li><li class="L4"><span class="pln">mlrPipelineModel </span><span class="pun">=</span><span class="pln"> mlrPipeline</span><span class="pun">.</span><span class="pln">fit</span><span class="pun">(</span><span class="pln">trainingData</span><span class="pun">)</span></li><li class="L5"><span class="pln">&nbsp;</span></li><li class="L6"><span class="pln">mlrPreRel </span><span class="pun">=</span><span class="pln"> mlrPredictions</span><span class="pun">.</span><span class="pln">select</span><span class="pun">(</span><span class="str">"predictedLabel"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"label"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"features"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"probability"</span><span class="pun">).</span><span class="pln">collect</span><span class="pun">()</span></li><li class="L7"><span class="kwd">for</span><span class="pln"> item </span><span class="kwd">in</span><span class="pln"> mlrPreRel</span><span class="pun">:</span></li><li class="L8"><span class="pln">    </span><span class="kwd">print</span><span class="pun">(</span><span class="str">'('</span><span class="pun">+</span><span class="pln">str</span><span class="pun">(</span><span class="pln">item</span><span class="pun">[</span><span class="str">'label'</span><span class="pun">])+</span><span class="str">','</span><span class="pun">+</span><span class="pln">str</span><span class="pun">(</span><span class="pln">item</span><span class="pun">[</span><span class="str">'features'</span><span class="pun">])+</span><span class="str">')--&gt;prob='</span><span class="pun">+</span><span class="pln">str</span><span class="pun">(</span><span class="pln">item</span><span class="pun">[</span><span class="str">'probability'</span><span class="pun">])+</span><span class="str">',predictLabel='</span><span class="pun">+</span><span class="pln">str</span><span class="pun">(</span><span class="pln">item</span><span class="pun">[</span><span class="str">'predictedLabel'</span><span class="pun">]))</span></li><li class="L9"><span class="pln">&nbsp;</span></li><li class="L0"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">,[</span><span class="lit">5.2</span><span class="pun">,</span><span class="lit">2.7</span><span class="pun">,</span><span class="lit">3.9</span><span class="pun">,</span><span class="lit">1.4</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.769490937876</span><span class="pun">,</span><span class="lit">0.230509062124</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L1"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">,[</span><span class="lit">5.5</span><span class="pun">,</span><span class="lit">2.3</span><span class="pun">,</span><span class="lit">4.0</span><span class="pun">,</span><span class="lit">1.3</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.795868931454</span><span class="pun">,</span><span class="lit">0.204131068546</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L2"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">,[</span><span class="lit">5.6</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">4.5</span><span class="pun">,</span><span class="lit">1.5</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.740814410092</span><span class="pun">,</span><span class="lit">0.259185589908</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L3"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">,[</span><span class="lit">5.9</span><span class="pun">,</span><span class="lit">3.2</span><span class="pun">,</span><span class="lit">4.8</span><span class="pun">,</span><span class="lit">1.8</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.64210359201</span><span class="pun">,</span><span class="lit">0.35789640799</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L4"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">,[</span><span class="lit">6.3</span><span class="pun">,</span><span class="lit">3.3</span><span class="pun">,</span><span class="lit">4.7</span><span class="pun">,</span><span class="lit">1.6</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.709915262079</span><span class="pun">,</span><span class="lit">0.290084737921</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L5"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">,[</span><span class="lit">6.4</span><span class="pun">,</span><span class="lit">2.9</span><span class="pun">,</span><span class="lit">4.3</span><span class="pun">,</span><span class="lit">1.3</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.795868931454</span><span class="pun">,</span><span class="lit">0.204131068546</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L6"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">,[</span><span class="lit">6.7</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">5.0</span><span class="pun">,</span><span class="lit">1.7</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.676938845836</span><span class="pun">,</span><span class="lit">0.323061154164</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L7"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">,[</span><span class="lit">4.9</span><span class="pun">,</span><span class="lit">2.5</span><span class="pun">,</span><span class="lit">4.5</span><span class="pun">,</span><span class="lit">1.7</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.676938845836</span><span class="pun">,</span><span class="lit">0.323061154164</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L8"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">,[</span><span class="lit">5.5</span><span class="pun">,</span><span class="lit">2.4</span><span class="pun">,</span><span class="lit">3.8</span><span class="pun">,</span><span class="lit">1.1</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.841727580252</span><span class="pun">,</span><span class="lit">0.158272419748</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L9"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">,[</span><span class="lit">5.5</span><span class="pun">,</span><span class="lit">2.5</span><span class="pun">,</span><span class="lit">4.0</span><span class="pun">,</span><span class="lit">1.3</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.795868931454</span><span class="pun">,</span><span class="lit">0.204131068546</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L0"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">,[</span><span class="lit">5.5</span><span class="pun">,</span><span class="lit">2.6</span><span class="pun">,</span><span class="lit">4.4</span><span class="pun">,</span><span class="lit">1.2</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.819934748118</span><span class="pun">,</span><span class="lit">0.180065251882</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L1"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">,[</span><span class="lit">5.7</span><span class="pun">,</span><span class="lit">2.6</span><span class="pun">,</span><span class="lit">3.5</span><span class="pun">,</span><span class="lit">1.0</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.861328953172</span><span class="pun">,</span><span class="lit">0.138671046828</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L2"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">,[</span><span class="lit">5.8</span><span class="pun">,</span><span class="lit">2.7</span><span class="pun">,</span><span class="lit">3.9</span><span class="pun">,</span><span class="lit">1.2</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.819934748118</span><span class="pun">,</span><span class="lit">0.180065251882</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L3"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">,[</span><span class="lit">5.8</span><span class="pun">,</span><span class="lit">2.7</span><span class="pun">,</span><span class="lit">5.1</span><span class="pun">,</span><span class="lit">1.9</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.605700014665</span><span class="pun">,</span><span class="lit">0.394299985335</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L4"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">,[</span><span class="lit">5.8</span><span class="pun">,</span><span class="lit">2.8</span><span class="pun">,</span><span class="lit">5.1</span><span class="pun">,</span><span class="lit">2.4</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.414135982436</span><span class="pun">,</span><span class="lit">0.585864017564</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span></li><li class="L5"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">,[</span><span class="lit">6.0</span><span class="pun">,</span><span class="lit">2.7</span><span class="pun">,</span><span class="lit">5.1</span><span class="pun">,</span><span class="lit">1.6</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.709915262079</span><span class="pun">,</span><span class="lit">0.290084737921</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L6"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">,[</span><span class="lit">6.1</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">4.9</span><span class="pun">,</span><span class="lit">1.8</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.64210359201</span><span class="pun">,</span><span class="lit">0.35789640799</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L7"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">,[</span><span class="lit">6.3</span><span class="pun">,</span><span class="lit">2.8</span><span class="pun">,</span><span class="lit">5.1</span><span class="pun">,</span><span class="lit">1.5</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.740814410092</span><span class="pun">,</span><span class="lit">0.259185589908</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L8"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">,[</span><span class="lit">6.3</span><span class="pun">,</span><span class="lit">3.3</span><span class="pun">,</span><span class="lit">6.0</span><span class="pun">,</span><span class="lit">2.5</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.377041048688</span><span class="pun">,</span><span class="lit">0.622958951312</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span></li><li class="L9"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">,[</span><span class="lit">6.5</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">5.2</span><span class="pun">,</span><span class="lit">2.0</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.568084351171</span><span class="pun">,</span><span class="lit">0.431915648829</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L0"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">,[</span><span class="lit">6.5</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">5.5</span><span class="pun">,</span><span class="lit">1.8</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.64210359201</span><span class="pun">,</span><span class="lit">0.35789640799</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L1"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">,[</span><span class="lit">6.7</span><span class="pun">,</span><span class="lit">2.5</span><span class="pun">,</span><span class="lit">5.8</span><span class="pun">,</span><span class="lit">1.8</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.64210359201</span><span class="pun">,</span><span class="lit">0.35789640799</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L2"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">,[</span><span class="lit">6.9</span><span class="pun">,</span><span class="lit">3.1</span><span class="pun">,</span><span class="lit">5.4</span><span class="pun">,</span><span class="lit">2.1</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.529666704954</span><span class="pun">,</span><span class="lit">0.470333295046</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L3"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">,[</span><span class="lit">7.3</span><span class="pun">,</span><span class="lit">2.9</span><span class="pun">,</span><span class="lit">6.3</span><span class="pun">,</span><span class="lit">1.8</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.64210359201</span><span class="pun">,</span><span class="lit">0.35789640799</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L4"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">,[</span><span class="lit">7.4</span><span class="pun">,</span><span class="lit">2.8</span><span class="pun">,</span><span class="lit">6.1</span><span class="pun">,</span><span class="lit">1.9</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.605700014665</span><span class="pun">,</span><span class="lit">0.394299985335</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L5"><span class="pln">&nbsp;</span></li><li class="L6"><span class="pln">mlrAccuracy </span><span class="pun">=</span><span class="pln"> evaluator</span><span class="pun">.</span><span class="pln">evaluate</span><span class="pun">(</span><span class="pln">mlrPredictions</span><span class="pun">)</span></li><li class="L7"><span class="pln">&nbsp;</span></li><li class="L8"><span class="kwd">print</span><span class="pun">(</span><span class="str">"Test Error = "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> str</span><span class="pun">(</span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> mlrAccuracy</span><span class="pun">))</span></li><li class="L9"><span class="pln">&nbsp;</span></li><li class="L0"><span class="typ">Test</span><span class="pln"> </span><span class="typ">Error</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0.48730158730158735</span></li><li class="L1"><span class="pln">&nbsp;</span></li><li class="L2"><span class="pln">&nbsp;</span></li><li class="L3"><span class="pln">mlrModel </span><span class="pun">=</span><span class="pln"> mlrPipelineModel</span><span class="pun">.</span><span class="pln">stages</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span></li><li class="L4"><span class="pln">&nbsp;</span></li><li class="L5"><span class="kwd">print</span><span class="pun">(</span><span class="str">"Multinomial coefficients: "</span><span class="pln"> </span><span class="pun">+</span><span class="pln">str</span><span class="pun">(</span><span class="pln">mlrModel</span><span class="pun">.</span><span class="pln">coefficientMatrix</span><span class="pun">)+</span><span class="str">"Multin</span></li><li class="L6"><span class="str">omial intercepts: "</span><span class="pun">+</span><span class="pln">str</span><span class="pun">(</span><span class="pln">mlrModel</span><span class="pun">.</span><span class="pln">interceptVector</span><span class="pun">)+</span><span class="str">"numClasses: "</span><span class="pun">+</span><span class="pln">str</span><span class="pun">(</span><span class="pln">mlrModel</span><span class="pun">.</span><span class="pln">numClasses</span><span class="pun">)+</span></li><li class="L7"><span class="str">"numFeatures: "</span><span class="pun">+</span><span class="pln">str</span><span class="pun">(</span><span class="pln">mlrModel</span><span class="pun">.</span><span class="pln">numFeatures</span><span class="pun">))</span></li><li class="L8"><span class="pln">&nbsp;</span></li><li class="L9"><span class="typ">Multinomial</span><span class="pln"> coefficients</span><span class="pun">:</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> X </span><span class="lit">4</span><span class="pln"> </span><span class="typ">CSRMatrix</span></li><li class="L0"><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="lit">3</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="lit">0.0776</span></li><li class="L1"><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="lit">3</span><span class="pun">)</span><span class="pln"> </span><span class="lit">0.0776Multinomial</span><span class="pln"> intercepts</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[</span><span class="lit">0.913185966051</span><span class="pun">,-</span><span class="lit">0.913185966051</span><span class="pun">]</span><span class="pln">numClasses</span><span class="pun">:</span><span class="pln"> </span><span class="lit">2numFeatures</span><span class="pun">:</span><span class="pln"> </span><span class="lit">4</span></li><li class="L2"><span class="pln">&nbsp;</span></li></ol></pre><div class="code-pretty-toolbar"><span class="title">Python</span><a href="javascript:void(0);" title="复制代码" class="tool clipboard"><i class="fa fa-files-o"></i></a><a href="javascript:void(0);" title="查看纯文本代码" class="tool view-source"><i class="fa fa-code"></i></a><a href="javascript:void(0);" title="返回代码高亮" class="tool back-to-pretty"><i class="fa fa-undo"></i></a><span class="msg"></span></div></div>
<h4>用多项逻辑斯蒂回归解决 多分类  问题</h4>
<p>​   对于多分类问题，我们需要用多项逻辑斯蒂回归进行多分类分析。这里我们用全部的iris数据集，即有三个类别，过程与上述基本一致，这里我们同样仅列出结果：</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-python prettyprinted" style=""><ol class="linenums"><li class="L0"><span class="pln">mlrPreRel </span><span class="pun">=</span><span class="pln"> mlrPredictions</span><span class="pun">.</span><span class="pln">select</span><span class="pun">(</span><span class="str">"predictedLabel"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"label"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"features"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"probability"</span><span class="pun">).</span><span class="pln">collect</span><span class="pun">()</span></li><li class="L1"><span class="kwd">for</span><span class="pln"> item </span><span class="kwd">in</span><span class="pln"> mlrPreRel</span><span class="pun">:</span></li><li class="L2"><span class="pln">    </span><span class="kwd">print</span><span class="pun">(</span><span class="str">'('</span><span class="pun">+</span><span class="pln">str</span><span class="pun">(</span><span class="pln">item</span><span class="pun">[</span><span class="str">'label'</span><span class="pun">])+</span><span class="str">','</span><span class="pun">+</span><span class="pln">str</span><span class="pun">(</span><span class="pln">item</span><span class="pun">[</span><span class="str">'features'</span><span class="pun">])+</span><span class="str">')--&gt;prob='</span><span class="pun">+</span><span class="pln">str</span><span class="pun">(</span><span class="pln">item</span><span class="pun">[</span><span class="str">'probability'</span><span class="pun">])+</span><span class="str">',predictLabel='</span><span class="pun">+</span><span class="pln">str</span><span class="pun">(</span><span class="pln">item</span><span class="pun">[</span><span class="str">'predictedLabel'</span><span class="pun">]))</span></li><li class="L3"><span class="pln">&nbsp;</span></li><li class="L4"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">,[</span><span class="lit">5.2</span><span class="pun">,</span><span class="lit">2.7</span><span class="pun">,</span><span class="lit">3.9</span><span class="pun">,</span><span class="lit">1.4</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.769490937876</span><span class="pun">,</span><span class="lit">0.230509062124</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L5"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">,[</span><span class="lit">5.5</span><span class="pun">,</span><span class="lit">2.3</span><span class="pun">,</span><span class="lit">4.0</span><span class="pun">,</span><span class="lit">1.3</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.795868931454</span><span class="pun">,</span><span class="lit">0.204131068546</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L6"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">,[</span><span class="lit">5.6</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">4.5</span><span class="pun">,</span><span class="lit">1.5</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.740814410092</span><span class="pun">,</span><span class="lit">0.259185589908</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L7"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">,[</span><span class="lit">5.9</span><span class="pun">,</span><span class="lit">3.2</span><span class="pun">,</span><span class="lit">4.8</span><span class="pun">,</span><span class="lit">1.8</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.64210359201</span><span class="pun">,</span><span class="lit">0.35789640799</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L8"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">,[</span><span class="lit">6.3</span><span class="pun">,</span><span class="lit">3.3</span><span class="pun">,</span><span class="lit">4.7</span><span class="pun">,</span><span class="lit">1.6</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.709915262079</span><span class="pun">,</span><span class="lit">0.290084737921</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L9"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">,[</span><span class="lit">6.4</span><span class="pun">,</span><span class="lit">2.9</span><span class="pun">,</span><span class="lit">4.3</span><span class="pun">,</span><span class="lit">1.3</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.795868931454</span><span class="pun">,</span><span class="lit">0.204131068546</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L0"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">,[</span><span class="lit">6.7</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">5.0</span><span class="pun">,</span><span class="lit">1.7</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.676938845836</span><span class="pun">,</span><span class="lit">0.323061154164</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L1"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">,[</span><span class="lit">4.9</span><span class="pun">,</span><span class="lit">2.5</span><span class="pun">,</span><span class="lit">4.5</span><span class="pun">,</span><span class="lit">1.7</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.676938845836</span><span class="pun">,</span><span class="lit">0.323061154164</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L2"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">,[</span><span class="lit">5.5</span><span class="pun">,</span><span class="lit">2.4</span><span class="pun">,</span><span class="lit">3.8</span><span class="pun">,</span><span class="lit">1.1</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.841727580252</span><span class="pun">,</span><span class="lit">0.158272419748</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L3"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">,[</span><span class="lit">5.5</span><span class="pun">,</span><span class="lit">2.5</span><span class="pun">,</span><span class="lit">4.0</span><span class="pun">,</span><span class="lit">1.3</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.795868931454</span><span class="pun">,</span><span class="lit">0.204131068546</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L4"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">,[</span><span class="lit">5.5</span><span class="pun">,</span><span class="lit">2.6</span><span class="pun">,</span><span class="lit">4.4</span><span class="pun">,</span><span class="lit">1.2</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.819934748118</span><span class="pun">,</span><span class="lit">0.180065251882</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L5"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">,[</span><span class="lit">5.7</span><span class="pun">,</span><span class="lit">2.6</span><span class="pun">,</span><span class="lit">3.5</span><span class="pun">,</span><span class="lit">1.0</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.861328953172</span><span class="pun">,</span><span class="lit">0.138671046828</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L6"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">,[</span><span class="lit">5.8</span><span class="pun">,</span><span class="lit">2.7</span><span class="pun">,</span><span class="lit">3.9</span><span class="pun">,</span><span class="lit">1.2</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.819934748118</span><span class="pun">,</span><span class="lit">0.180065251882</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L7"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">,[</span><span class="lit">5.8</span><span class="pun">,</span><span class="lit">2.7</span><span class="pun">,</span><span class="lit">5.1</span><span class="pun">,</span><span class="lit">1.9</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.605700014665</span><span class="pun">,</span><span class="lit">0.394299985335</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L8"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">,[</span><span class="lit">5.8</span><span class="pun">,</span><span class="lit">2.8</span><span class="pun">,</span><span class="lit">5.1</span><span class="pun">,</span><span class="lit">2.4</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.414135982436</span><span class="pun">,</span><span class="lit">0.585864017564</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span></li><li class="L9"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">,[</span><span class="lit">6.0</span><span class="pun">,</span><span class="lit">2.7</span><span class="pun">,</span><span class="lit">5.1</span><span class="pun">,</span><span class="lit">1.6</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.709915262079</span><span class="pun">,</span><span class="lit">0.290084737921</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L0"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">,[</span><span class="lit">6.1</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">4.9</span><span class="pun">,</span><span class="lit">1.8</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.64210359201</span><span class="pun">,</span><span class="lit">0.35789640799</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L1"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">,[</span><span class="lit">6.3</span><span class="pun">,</span><span class="lit">2.8</span><span class="pun">,</span><span class="lit">5.1</span><span class="pun">,</span><span class="lit">1.5</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.740814410092</span><span class="pun">,</span><span class="lit">0.259185589908</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L2"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">,[</span><span class="lit">6.3</span><span class="pun">,</span><span class="lit">3.3</span><span class="pun">,</span><span class="lit">6.0</span><span class="pun">,</span><span class="lit">2.5</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.377041048688</span><span class="pun">,</span><span class="lit">0.622958951312</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span></li><li class="L3"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">,[</span><span class="lit">6.5</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">5.2</span><span class="pun">,</span><span class="lit">2.0</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.568084351171</span><span class="pun">,</span><span class="lit">0.431915648829</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L4"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">,[</span><span class="lit">6.5</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">5.5</span><span class="pun">,</span><span class="lit">1.8</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.64210359201</span><span class="pun">,</span><span class="lit">0.35789640799</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L5"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">,[</span><span class="lit">6.7</span><span class="pun">,</span><span class="lit">2.5</span><span class="pun">,</span><span class="lit">5.8</span><span class="pun">,</span><span class="lit">1.8</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.64210359201</span><span class="pun">,</span><span class="lit">0.35789640799</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L6"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">,[</span><span class="lit">6.9</span><span class="pun">,</span><span class="lit">3.1</span><span class="pun">,</span><span class="lit">5.4</span><span class="pun">,</span><span class="lit">2.1</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.529666704954</span><span class="pun">,</span><span class="lit">0.470333295046</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L7"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">,[</span><span class="lit">7.3</span><span class="pun">,</span><span class="lit">2.9</span><span class="pun">,</span><span class="lit">6.3</span><span class="pun">,</span><span class="lit">1.8</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.64210359201</span><span class="pun">,</span><span class="lit">0.35789640799</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L8"><span class="pun">(</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">,[</span><span class="lit">7.4</span><span class="pun">,</span><span class="lit">2.8</span><span class="pun">,</span><span class="lit">6.1</span><span class="pun">,</span><span class="lit">1.9</span><span class="pun">])--&gt;</span><span class="pln">prob</span><span class="pun">=[</span><span class="lit">0.605700014665</span><span class="pun">,</span><span class="lit">0.394299985335</span><span class="pun">],</span><span class="pln">predictLabel</span><span class="pun">=</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span></li><li class="L9"><span class="pln">&nbsp;</span></li><li class="L0"><span class="pln">&nbsp;</span></li><li class="L1"><span class="pln">mlrAccuracy </span><span class="pun">=</span><span class="pln"> evaluator</span><span class="pun">.</span><span class="pln">evaluate</span><span class="pun">(</span><span class="pln">mlrPredictions</span><span class="pun">)</span></li><li class="L2"><span class="pln">&nbsp;</span></li><li class="L3"><span class="pln">println</span><span class="pun">(</span><span class="str">"Test Error = "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> str</span><span class="pun">(</span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> mlrAccuracy</span><span class="pun">))</span></li><li class="L4"><span class="typ">Test</span><span class="pln"> </span><span class="typ">Error</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0.48730158730158735</span></li><li class="L5"><span class="pln">&nbsp;</span></li><li class="L6"><span class="pln">mlrModel </span><span class="pun">=</span><span class="pln"> mlrPipelineModel</span><span class="pun">.</span><span class="pln">stages</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span></li><li class="L7"><span class="pln">&nbsp;</span></li><li class="L8"><span class="kwd">print</span><span class="pun">(</span><span class="str">"Multinomial coefficients: "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> str</span><span class="pun">(</span><span class="pln">mlrModel</span><span class="pun">.</span><span class="pln">coefficientMatrix</span><span class="pun">)+</span><span class="str">"Multinomial intercepts: "</span><span class="pun">+</span><span class="pln">str</span><span class="pun">(</span><span class="pln">mlrModel</span><span class="pun">.</span><span class="pln">interceptVector</span><span class="pun">)+</span><span class="str">"numClasses: "</span><span class="pun">+</span><span class="pln">str</span><span class="pun">(</span><span class="pln">mlrModel</span><span class="pun">.</span><span class="pln">numClasses</span><span class="pun">)+</span><span class="str">"numFeatures: "</span><span class="pun">+</span><span class="pln">str</span><span class="pun">(</span><span class="pln">mlrModel</span><span class="pun">.</span><span class="pln">numFeatures</span><span class="pun">))</span></li><li class="L9"><span class="pln">&nbsp;</span></li><li class="L0"><span class="typ">Multinomial</span><span class="pln"> coefficients</span><span class="pun">:</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> X </span><span class="lit">4</span><span class="pln"> </span><span class="typ">CSRMatrix</span></li><li class="L1"><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="lit">3</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="lit">0.0776</span></li><li class="L2"><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="lit">3</span><span class="pun">)</span><span class="pln"> </span><span class="lit">0.0776Multinomial</span><span class="pln"> intercepts</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[</span><span class="lit">0.913185966051</span><span class="pun">,-</span><span class="lit">0.913185966051</span><span class="pun">]</span><span class="pln">numClasses</span><span class="pun">:</span><span class="pln"> </span><span class="lit">2numFeatures</span><span class="pun">:</span><span class="pln"> </span><span class="lit">4</span></li><li class="L3"><span class="pln">&nbsp;</span></li></ol></pre><div class="code-pretty-toolbar"><span class="title">Python</span><a href="javascript:void(0);" title="复制代码" class="tool clipboard"><i class="fa fa-files-o"></i></a><a href="javascript:void(0);" title="查看纯文本代码" class="tool view-source"><i class="fa fa-code"></i></a><a href="javascript:void(0);" title="返回代码高亮" class="tool back-to-pretty"><i class="fa fa-undo"></i></a><span class="msg"></span></div></div>
<p>​<br>
​<br>
<img src="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/Spark.jpg" alt="子雨大数据之Spark入门" title=""><br>
<img src="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/Spark.png" alt="扫一扫访问本博客" title=""></p>
			</div><!-- .entry-content -->

	<footer class="entry-footer">
		<div class="entry-author">
			<div class="author-title">本文作者</div>
			
		<div class="author-avatar"><img src="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/2.jpg" alt="阮榕城" class="avatar avatar-thumbnail wp-user-avatar wp-user-avatar-thumbnail alignnone photo"></div>
		<div class="author-info">
			<p class="author-name"><a href="http://dblab.xmu.edu.cn/blog/author/ruanrongcheng/">阮榕城</a></p>
			<p class="author-desc">磨人的小妖精！</p>
			<p class="author-contact"><a href="http://www.nekomiao.me/" target="_blank" title="个人主页" class="homepage"><i class="fa fa-home"></i>www.nekomiao.me</a><i class="fa fa-envelope"></i><span class="envelope">moc.qq@crnaur</span></p>
		</div>
			</div>
		<div class="entry-info">
			<span class="permalink"><i class="fa fa-external-link"></i> <a href="http://dblab.xmu.edu.cn/blog/1773-2/" title="Spark2.1.0入门：逻辑斯蒂回归分类器(Python版)">http://dblab.xmu.edu.cn/blog/1773-2/</a></span><span class="category"><i class="fa fa-folder-open-o"></i> <a href="http://dblab.xmu.edu.cn/blog/category/big-data/" rel="category tag">大数据</a></span>		</div>
		<div class="yarpp-related yarpp-related-none">
</div>
	</footer><!-- .entry-footer -->
</article><!-- #post-## -->
			</div>
</div><!-- .row -->

	<div class="row">
		<div class="col-sm-3"></div>
		<div class="col-sm-9 site-footer">
			© 2014 <a href="http://dblab.xmu.edu.cn/">厦大数据库实验室</a>
					</div>
	</div>
</div><!-- .container -->
<link rel="stylesheet" id="yarppRelatedCss-css" href="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/related.css" type="text/css" media="all">
<script type="text/javascript" src="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/prettify.js"></script>
<script type="text/javascript" src="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/power.js"></script>
<script type="text/javascript" src="6.4.2Spark2.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/wp-embed.js"></script>

<div class="back-to-top" id="back-to-top" title="嗖的就上去了！"><span><i class="fa fa-chevron-up"></i></span></div></body></html>