<!DOCTYPE html>
<html lang="zh-CN"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Spark 2.1.0入门：决策树分类器(Python版)_厦大数据库实验室博客</title>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="renderer" content="webkit">
<link rel="dns-prefetch" href="http://cdn.staticfile.org/">
<link rel="dns-prefetch" href="http://s.w.org/">
<link rel="stylesheet" id="yarppWidgetCss-css" href="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/widget.css" type="text/css" media="all">
<link rel="stylesheet" id="wp-quicklatex-format-css" href="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex-format.css" type="text/css" media="all">
<link rel="stylesheet" id="bootstrap-css" href="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/bootstrap.css" type="text/css" media="all">
<link rel="stylesheet" id="font-awesome-css" href="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/font-awesome.css" type="text/css" media="all">
<link rel="stylesheet" id="power-css" href="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/style.css" type="text/css" media="all">
<link rel="stylesheet" id="google-code-prettify-css" href="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/prettify.css" type="text/css" media="all">
<script type="text/javascript" async="" charset="utf-8" src="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/core.js"></script><script src="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/hm.js"></script><script src="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/z_stat.js"></script><script type="text/javascript" src="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/jquery_002.js"></script>
<script type="text/javascript" src="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/jquery.js"></script>
<script type="text/javascript" src="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/jquery-migrate.js"></script>
<script type="text/javascript" src="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/wp-quicklatex-frontend.js"></script>
<link rel="https://api.w.org/" href="http://dblab.xmu.edu.cn/blog/wp-json/">
<link rel="prev" title="Spark2.1.0入门：逻辑斯蒂回归分类器(Python版)" href="http://dblab.xmu.edu.cn/blog/1773-2/">
<link rel="next" title="Python：类和实例" href="http://dblab.xmu.edu.cn/blog/1777-2/">
<link rel="canonical" href="http://dblab.xmu.edu.cn/blog/1776-2/">
<link rel="alternate" type="application/json+oembed" href="http://dblab.xmu.edu.cn/blog/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fdblab.xmu.edu.cn%2Fblog%2F1776-2%2F">
<!--[if lt IE 9]>
<script src="http://dblab.xmu.edu.cn/blog/wp-content/themes/power/js/html5shiv.js"></script>
<![endif]-->
</head>

<body class="post-template-default single single-post postid-1776 single-format-standard group-blog">
<div class="container site-page">

<div class="row">
	<div class="col-sm-3 site-infos">
		<h4 class="site-title">
			<a href="http://dblab.xmu.edu.cn/blog/" title="厦大数据库实验室博客" rel="home">厦大数据库实验室博客</a>
		</h4>
		<div class="site-description">总结、分享、收获<p><a href="http://dblab.xmu.edu.cn/" title="厦大数据库实验室">实验室主页</a></p></div>

		<nav class="main-navigation" role="navigation">
			<div class="menu-primary-container"><ul id="menu-primary" class="menu menu-level-1"><li id="menu-item-80" class="menu-item item-level-1"><a href="http://dblab.xmu.edu.cn/blog/">首页</a></li>
<li id="menu-item-85" class="menu-item item-level-1 current-path"><a href="http://dblab.xmu.edu.cn/blog/category/big-data/">大数据</a></li>
<li id="menu-item-676" class="menu-item item-level-1"><a href="http://dblab.xmu.edu.cn/blog/category/databases/">数据库</a></li>
<li id="menu-item-87" class="menu-item item-level-1"><a href="http://dblab.xmu.edu.cn/blog/category/data-mining/">数据挖掘</a></li>
<li id="menu-item-86" class="menu-item item-level-1"><a href="http://dblab.xmu.edu.cn/blog/category/others/">其他</a></li>
</ul></div>		</nav><!-- #site-navigation -->

		<div class="search"><form role="search" method="get" class="search-form" action="http://dblab.xmu.edu.cn/blog/">
				<label>
					<span class="screen-reader-text">搜索：</span>
					<input class="search-field" placeholder="搜索…" name="s" type="search">
				</label>
				<input class="search-submit" value="搜索" type="submit">
			</form></div>
	</div>
	<div class="col-sm-9 site-main">

					<article id="post-1776" class="post-1776 post type-post status-publish format-standard hentry category-big-data">
	<header class="entry-header">
		<h1 class="entry-title">Spark 2.1.0入门：决策树分类器(Python版)</h1>

		<div class="entry-meta">
			<span class="author"><i class="fa fa-user"></i> 阮榕城</span><span class="date"><i class="fa fa-calendar"></i> <time datetime="2017-12-18T15:14:39+00:00">2017年12月18日</time> <span class="updated">(updated: <time class="updated" datetime="2018-01-08T10:43:23+00:00">2018年1月8日</time>)</span></span><span class="views" id="views"><i class="fa fa-eye"></i> 1667</span>		</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

	<div class="entry-content">
		<div class="bigdata-book">
			<a href="http://dblab.xmu.edu.cn/post/5899/" title="2019年1月20日寒假大数据师资培训班" target="_blank"><img src="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/peixunban2019-01-20.jpg" alt="2019年1月20日寒假大数据师资培训班"></a>
		</div>
		<p>【版权声明】博客内容由厦门大学数据库实验室拥有版权，未经允许，请勿转载！<br>
[<a href="http://dblab.xmu.edu.cn/blog/1709-2/" target="_blank">返回Spark教程首页</a>]</p>
<h2>一、方法简介</h2>
<p>​ 决策树（decision 
tree）是一种基本的分类与回归方法，这里主要介绍用于分类的决策树。决策树模式呈树形结构，其中每个内部节点表示一个属性上的测试，每个分支代表一个
测试输出，每个叶节点代表一种类别。学习时利用训练数据，根据损失函数最小化的原则建立决策树模型；预测时，对新的数据，利用决策树模型进行分类。<br>
<span id="more-1776"></span></p>
<h2>二、基本原理</h2>
<p>​ 决策树学习通常包括3个步骤：特征选择、决策树的生成和决策树的剪枝。</p>
<h3>（一）特征选择</h3>
<p>​ 
特征选择在于选取对训练数据具有分类能力的特征，这样可以提高决策树学习的效率。通常特征选择的准则是信息增益（或信息增益比、基尼指数等），每次计算每
个特征的信息增益，并比较它们的大小，选择信息增益最大（信息增益比最大、基尼指数最小）的特征。下面我们重点介绍一下特征选择的准则：信息增益。</p>
<p>​ 
首先定义信息论中广泛使用的一个度量标准——熵（entropy），它是表示随机变量不确定性的度量。熵越大，随机变量的不确定性就越大。而信息增益
（informational 
entropy）表示得知某一特征后使得信息的不确定性减少的程度。简单的说，一个属性的信息增益就是由于使用这个属性分割样例而导致的期望熵降低。信息
增益、信息增益比和基尼指数的具体定义如下：</p>
<p>​ <strong>信息增益</strong>：特征A对训练数据集D的信息增益</p>
<p class="ql-center-displayed-equation" style="line-height: 18px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_013.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[g(D,A)\]" title="Rendered by QuickLaTeX.com" width="58" height="18"></p>
<p>，定义为集合D的经验熵</p>
<p class="ql-center-displayed-equation" style="line-height: 18px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_003.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[H(D)\]" title="Rendered by QuickLaTeX.com" width="45" height="18"></p>
<p>与特征A给定条件下D的经验条件熵</p>
<p class="ql-center-displayed-equation" style="line-height: 18px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_002.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[H(D|A)\]" title="Rendered by QuickLaTeX.com" width="62" height="18"></p>
<p>之差，即</p>
<p class="ql-center-displayed-equation" style="line-height: 18px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_010.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[g(D,A)=H(D)-H(D|A)\]" title="Rendered by QuickLaTeX.com" width="212" height="18"></p>
<p>​ <strong>信息增益比</strong>：特征A对训练数据集D的信息增益比</p>
<p class="ql-center-displayed-equation" style="line-height: 18px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_009.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[g_R(D,A)\]" title="Rendered by QuickLaTeX.com" width="69" height="18"></p>
<p>定义为其信息增益</p>
<p class="ql-center-displayed-equation" style="line-height: 18px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_013.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[g(D,A)\]" title="Rendered by QuickLaTeX.com" width="58" height="18"></p>
<p>与训练数据集D关于特征A的值的熵</p>
<p class="ql-center-displayed-equation" style="line-height: 18px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_015.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[H_A(D)\]" title="Rendered by QuickLaTeX.com" width="54" height="18"></p>
<p>之比，即</p>
<p class="ql-center-displayed-equation" style="line-height: 42px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_012.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[g_R(D,A)=\frac{g(D,A)}{H_A(D)}\]" title="Rendered by QuickLaTeX.com" width="155" height="42"></p>
<p>其中，</p>
<p class="ql-center-displayed-equation" style="line-height: 50px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_014.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[H_A(D)=-\sum_{i=1}^{n}\frac{\left|D_i\right|}{\left|D\right|}log_2\frac{\left|D_i\right|}{\left|D\right|}\]" title="Rendered by QuickLaTeX.com" width="221" height="50"></p>
<p> ，n是特征A取值的个数。</p>
<p>​ <strong>基尼指数</strong>：分类问题中，假设有K个类，样本点属于第K类的概率为</p>
<p class="ql-center-displayed-equation" style="line-height: 12px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_008.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[p_k\]" title="Rendered by QuickLaTeX.com" width="17" height="12"></p>
<p>，则概率分布的基尼指数定义为</p>
<p class="ql-center-displayed-equation" style="line-height: 55px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_006.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[Gini(p)=\sum_{k=1}^{K}p_k(1-p_k)=1-\sum_{k=1}^{K}p_k^2\]" title="Rendered by QuickLaTeX.com" width="289" height="55"></p>
<h3>（二）决策树的生成</h3>
<p>​ 从根结点开始，对结点计算所有可能的特征的信息增益，选择信息增益最大的特征作为结点的特征，由该特征的不同取值建立子结点，再对子结点递归地调用以上方法，构建决策树；直到所有特征的信息增均很小或没有特征可以选择为止，最后得到一个决策树。</p>
<p>​ 
决策树需要有停止条件来终止其生长的过程。一般来说最低的条件是：当该节点下面的所有记录都属于同一类，或者当所有的记录属性都具有相同的值时。这两种条
件是停止决策树的必要条件，也是最低的条件。在实际运用中一般希望决策树提前停止生长，限定叶节点包含的最低数据量，以防止由于过度生长造成的过拟合问
题。</p>
<h3>（三）决策树的剪枝</h3>
<p>​ 决策树生成算法递归地产生决策树，直到不能继续下去为止。这样产生的树往往对训练数据的分类很准确，但对未知的测试数据的分类却没有那么准确，即出现过拟合现象。解决这个问题的办法是考虑决策树的复杂度，对已生成的决策树进行简化，这个过程称为剪枝。</p>
<p>​ 决策树的剪枝往往通过极小化决策树整体的损失函数来实现。一般来说，损失函数可以进行如下的定义：</p>
<p class="ql-center-displayed-equation" style="line-height: 18px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_011.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[C_a(T)=C(T)+a\left|T\right|\]" title="Rendered by QuickLaTeX.com" width="166" height="18"></p>
<p>​ 其中，T为任意子树，</p>
<p class="ql-center-displayed-equation" style="line-height: 18px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_017.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[C(T)\]" title="Rendered by QuickLaTeX.com" width="39" height="18"></p>
<p> 为对训练数据的预测误差（如基尼指数），</p>
<p class="ql-center-displayed-equation" style="line-height: 18px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_005.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[\left|T\right|\]" title="Rendered by QuickLaTeX.com" width="18" height="18"></p>
<p> 为子树的叶结点个数，</p>
<p class="ql-center-displayed-equation" style="line-height: 15px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_007.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[a\ge0\]" title="Rendered by QuickLaTeX.com" width="42" height="15"></p>
<p>为参数，</p>
<p class="ql-center-displayed-equation" style="line-height: 18px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_016.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[C_a(T)\]" title="Rendered by QuickLaTeX.com" width="47" height="18"></p>
<p> 为参数是</p>
<p class="ql-center-displayed-equation" style="line-height: 8px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[a\]" title="Rendered by QuickLaTeX.com" width="9" height="8"></p>
<p>时的子树T的整体损失，参数</p>
<p class="ql-center-displayed-equation" style="line-height: 8px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[a\]" title="Rendered by QuickLaTeX.com" width="9" height="8"></p>
<p>权衡训练数据的拟合程度与模型的复杂度。对于固定的</p>
<p class="ql-center-displayed-equation" style="line-height: 8px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[a\]" title="Rendered by QuickLaTeX.com" width="9" height="8"></p>
<p>，一定存在使损失函数</p>
<p class="ql-center-displayed-equation" style="line-height: 18px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_016.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[C_a(T)\]" title="Rendered by QuickLaTeX.com" width="47" height="18"></p>
<p> 最小的子树，将其表示为</p>
<p class="ql-center-displayed-equation" style="line-height: 14px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_004.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[T_a\]" title="Rendered by QuickLaTeX.com" width="17" height="14"></p>
<p> 。当</p>
<p class="ql-center-displayed-equation" style="line-height: 8px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[a\]" title="Rendered by QuickLaTeX.com" width="9" height="8"></p>
<p>大的时候，最优子树</p>
<p class="ql-center-displayed-equation" style="line-height: 14px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_004.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[T_a\]" title="Rendered by QuickLaTeX.com" width="17" height="14"></p>
<p>偏小；当</p>
<p class="ql-center-displayed-equation" style="line-height: 8px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[a\]" title="Rendered by QuickLaTeX.com" width="9" height="8"></p>
<p>小的时候，最优子树</p>
<p class="ql-center-displayed-equation" style="line-height: 14px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_004.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[T_a\]" title="Rendered by QuickLaTeX.com" width="17" height="14"></p>
<p>偏大。</p>
<h3>示例代码</h3>
<p>​   我们以iris数据集（<a href="http://dblab.xmu.edu.cn/blog/wp-content/uploads/2017/03/iris.txt" target="_blank">iris</a>）为例进行分析。iris以鸢尾花的特征作为数据来源，数据集包含150个数据集，分为3类，每类50个数据，每个数据包含4个属性，是在数据挖掘、数据分类中非常常用的测试集、训练集。决策树可以用于分类和回归，接下来我们将在代码中分别进行介绍。</p>
<h5>1. 导入需要的包：</h5>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-python prettyprinted" style=""><ol class="linenums"><li class="L0"><span class="kwd">from</span><span class="pln"> pyspark</span><span class="pun">.</span><span class="pln">ml</span><span class="pun">.</span><span class="pln">linalg </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">Vector</span><span class="pun">,</span><span class="typ">Vectors</span></li><li class="L1"><span class="kwd">from</span><span class="pln"> pyspark</span><span class="pun">.</span><span class="pln">sql </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">Row</span></li><li class="L2"><span class="kwd">from</span><span class="pln"> pyspark</span><span class="pun">.</span><span class="pln">ml </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">Pipeline</span></li><li class="L3"><span class="kwd">from</span><span class="pln"> pyspark</span><span class="pun">.</span><span class="pln">ml</span><span class="pun">.</span><span class="pln">feature </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">IndexToString</span><span class="pun">,</span><span class="typ">StringIndexer</span><span class="pun">,</span><span class="typ">VectorIndexer</span></li></ol></pre><div class="code-pretty-toolbar"><span class="title">Python</span><a href="javascript:void(0);" title="复制代码" class="tool clipboard"><i class="fa fa-files-o"></i></a><a href="javascript:void(0);" title="查看纯文本代码" class="tool view-source"><i class="fa fa-code"></i></a><a href="javascript:void(0);" title="返回代码高亮" class="tool back-to-pretty"><i class="fa fa-undo"></i></a><span class="msg"></span></div></div>
<h5>2. 读取数据，简要分析：</h5>
<p>读取文本文件，第一个map把每行的数据用“,”隔开，比如在我们的数据集中，每行被分成了5部分，前4部分是鸢尾花的4个特征，最后一部分是鸢尾
花的分类；我们这里把特征存储在Vector中，创建一个Iris模式的RDD，然后转化成dataframe；然后把刚刚得到的数据注册成一个表
iris，注册成这个表之后，我们就可以通过sql语句进行数据查询；选出我们需要的数据后，我们可以把结果打印出来查看一下数据。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-python prettyprinted" style=""><ol class="linenums"><li class="L0"><span class="kwd">def</span><span class="pln"> f</span><span class="pun">(</span><span class="pln">x</span><span class="pun">):</span></li><li class="L1"><span class="pln">    rel </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{}</span></li><li class="L2"><span class="pln">    rel</span><span class="pun">[</span><span class="str">'features'</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Vectors</span><span class="pun">.</span><span class="pln">dense</span><span class="pun">(</span><span class="pln">float</span><span class="pun">(</span><span class="pln">x</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]),</span><span class="pln">float</span><span class="pun">(</span><span class="pln">x</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]),</span><span class="pln">float</span><span class="pun">(</span><span class="pln">x</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]),</span><span class="pln">float</span><span class="pun">(</span><span class="pln">x</span><span class="pun">[</span><span class="lit">3</span><span class="pun">]))</span></li><li class="L3"><span class="pln">    rel</span><span class="pun">[</span><span class="str">'label'</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> str</span><span class="pun">(</span><span class="pln">x</span><span class="pun">[</span><span class="lit">4</span><span class="pun">])</span></li><li class="L4"><span class="pln">    </span><span class="kwd">return</span><span class="pln"> rel</span></li><li class="L5"><span class="pln">&nbsp;</span></li><li class="L6"><span class="pln">data </span><span class="pun">=</span><span class="pln"> spark</span><span class="pun">.</span><span class="pln">sparkContext</span><span class="pun">.</span><span class="pln">textFile</span><span class="pun">(</span><span class="str">"file:///usr/local/spark/iris.txt"</span><span class="pun">).</span><span class="pln">map</span><span class="pun">(</span><span class="kwd">lambda</span><span class="pln"> line</span><span class="pun">:</span><span class="pln"> line</span><span class="pun">.</span><span class="pln">split</span><span class="pun">(</span><span class="str">','</span><span class="pun">)).</span><span class="pln">map</span><span class="pun">(</span><span class="kwd">lambda</span><span class="pln"> p</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Row</span><span class="pun">(**</span><span class="pln">f</span><span class="pun">(</span><span class="pln">p</span><span class="pun">))).</span><span class="pln">toDF</span><span class="pun">()</span></li><li class="L7"><span class="pln">&nbsp;</span></li><li class="L8"><span class="pln">data</span><span class="pun">.</span><span class="pln">createOrReplaceTempView</span><span class="pun">(</span><span class="str">"iris"</span><span class="pun">)</span></li><li class="L9"><span class="pln">&nbsp;</span></li><li class="L0"><span class="pln">df </span><span class="pun">=</span><span class="pln"> spark</span><span class="pun">.</span><span class="pln">sql</span><span class="pun">(</span><span class="str">"select * from iris"</span><span class="pun">)</span></li><li class="L1"><span class="pln">&nbsp;</span></li><li class="L2"><span class="pln">rel </span><span class="pun">=</span><span class="pln"> df</span><span class="pun">.</span><span class="pln">rdd</span><span class="pun">.</span><span class="pln">map</span><span class="pun">(</span><span class="kwd">lambda</span><span class="pln"> t </span><span class="pun">:</span><span class="pln"> str</span><span class="pun">(</span><span class="pln">t</span><span class="pun">[</span><span class="lit">1</span><span class="pun">])+</span><span class="str">":"</span><span class="pun">+</span><span class="pln">str</span><span class="pun">(</span><span class="pln">t</span><span class="pun">[</span><span class="lit">0</span><span class="pun">])).</span><span class="pln">collect</span><span class="pun">()</span></li><li class="L3"><span class="kwd">for</span><span class="pln"> item </span><span class="kwd">in</span><span class="pln"> rel</span><span class="pun">:</span></li><li class="L4"><span class="pln">    </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">item</span><span class="pun">)</span></li><li class="L5"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">:[</span><span class="lit">5.1</span><span class="pun">,</span><span class="lit">3.5</span><span class="pun">,</span><span class="lit">1.4</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">]</span></li><li class="L6"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">:[</span><span class="lit">4.9</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">1.4</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">]</span></li><li class="L7"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">:[</span><span class="lit">4.7</span><span class="pun">,</span><span class="lit">3.2</span><span class="pun">,</span><span class="lit">1.3</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">]</span></li><li class="L8"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">:[</span><span class="lit">4.6</span><span class="pun">,</span><span class="lit">3.1</span><span class="pun">,</span><span class="lit">1.5</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">]</span></li><li class="L9"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">:[</span><span class="lit">5.0</span><span class="pun">,</span><span class="lit">3.6</span><span class="pun">,</span><span class="lit">1.4</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">]</span></li><li class="L0"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">:[</span><span class="lit">5.4</span><span class="pun">,</span><span class="lit">3.9</span><span class="pun">,</span><span class="lit">1.7</span><span class="pun">,</span><span class="lit">0.4</span><span class="pun">]</span></li><li class="L1"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">:[</span><span class="lit">4.6</span><span class="pun">,</span><span class="lit">3.4</span><span class="pun">,</span><span class="lit">1.4</span><span class="pun">,</span><span class="lit">0.3</span><span class="pun">]</span></li><li class="L2"><span class="pun">.....</span></li><li class="L3"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">:[</span><span class="lit">5.7</span><span class="pun">,</span><span class="lit">2.8</span><span class="pun">,</span><span class="lit">4.1</span><span class="pun">,</span><span class="lit">1.3</span><span class="pun">]</span></li><li class="L4"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.3</span><span class="pun">,</span><span class="lit">3.3</span><span class="pun">,</span><span class="lit">6.0</span><span class="pun">,</span><span class="lit">2.5</span><span class="pun">]</span></li><li class="L5"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">5.8</span><span class="pun">,</span><span class="lit">2.7</span><span class="pun">,</span><span class="lit">5.1</span><span class="pun">,</span><span class="lit">1.9</span><span class="pun">]</span></li><li class="L6"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">7.1</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">5.9</span><span class="pun">,</span><span class="lit">2.1</span><span class="pun">]</span></li><li class="L7"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.3</span><span class="pun">,</span><span class="lit">2.9</span><span class="pun">,</span><span class="lit">5.6</span><span class="pun">,</span><span class="lit">1.8</span><span class="pun">]</span></li><li class="L8"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.5</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">5.8</span><span class="pun">,</span><span class="lit">2.2</span><span class="pun">]</span></li><li class="L9"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">7.6</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">6.6</span><span class="pun">,</span><span class="lit">2.1</span><span class="pun">]</span></li><li class="L0"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">4.9</span><span class="pun">,</span><span class="lit">2.5</span><span class="pun">,</span><span class="lit">4.5</span><span class="pun">,</span><span class="lit">1.7</span><span class="pun">]</span></li><li class="L1"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">7.3</span><span class="pun">,</span><span class="lit">2.9</span><span class="pun">,</span><span class="lit">6.3</span><span class="pun">,</span><span class="lit">1.8</span><span class="pun">]</span></li><li class="L2"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.7</span><span class="pun">,</span><span class="lit">2.5</span><span class="pun">,</span><span class="lit">5.8</span><span class="pun">,</span><span class="lit">1.8</span><span class="pun">]</span></li><li class="L3"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">7.2</span><span class="pun">,</span><span class="lit">3.6</span><span class="pun">,</span><span class="lit">6.1</span><span class="pun">,</span><span class="lit">2.5</span><span class="pun">]</span></li><li class="L4"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.5</span><span class="pun">,</span><span class="lit">3.2</span><span class="pun">,</span><span class="lit">5.1</span><span class="pun">,</span><span class="lit">2.0</span><span class="pun">]</span></li><li class="L5"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.4</span><span class="pun">,</span><span class="lit">2.7</span><span class="pun">,</span><span class="lit">5.3</span><span class="pun">,</span><span class="lit">1.9</span><span class="pun">]</span></li><li class="L6"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.8</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">5.5</span><span class="pun">,</span><span class="lit">2.1</span><span class="pun">]</span></li><li class="L7"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">5.7</span><span class="pun">,</span><span class="lit">2.5</span><span class="pun">,</span><span class="lit">5.0</span><span class="pun">,</span><span class="lit">2.0</span><span class="pun">]</span></li><li class="L8"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">5.8</span><span class="pun">,</span><span class="lit">2.8</span><span class="pun">,</span><span class="lit">5.1</span><span class="pun">,</span><span class="lit">2.4</span><span class="pun">]</span></li><li class="L9"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.4</span><span class="pun">,</span><span class="lit">3.2</span><span class="pun">,</span><span class="lit">5.3</span><span class="pun">,</span><span class="lit">2.3</span><span class="pun">]</span></li><li class="L0"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.5</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">5.5</span><span class="pun">,</span><span class="lit">1.8</span><span class="pun">]</span></li><li class="L1"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">7.7</span><span class="pun">,</span><span class="lit">3.8</span><span class="pun">,</span><span class="lit">6.7</span><span class="pun">,</span><span class="lit">2.2</span><span class="pun">]</span></li><li class="L2"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">7.7</span><span class="pun">,</span><span class="lit">2.6</span><span class="pun">,</span><span class="lit">6.9</span><span class="pun">,</span><span class="lit">2.3</span><span class="pun">]</span></li><li class="L3"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.0</span><span class="pun">,</span><span class="lit">2.2</span><span class="pun">,</span><span class="lit">5.0</span><span class="pun">,</span><span class="lit">1.5</span><span class="pun">]</span></li><li class="L4"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">6.9</span><span class="pun">,</span><span class="lit">3.2</span><span class="pun">,</span><span class="lit">5.7</span><span class="pun">,</span><span class="lit">2.3</span><span class="pun">]</span></li><li class="L5"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">5.6</span><span class="pun">,</span><span class="lit">2.8</span><span class="pun">,</span><span class="lit">4.9</span><span class="pun">,</span><span class="lit">2.0</span><span class="pun">]</span></li><li class="L6"><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">:[</span><span class="lit">7.7</span><span class="pun">,</span><span class="lit">2.8</span><span class="pun">,</span><span class="lit">6.7</span><span class="pun">,</span><span class="lit">2.0</span><span class="pun">]</span></li><li class="L7"><span class="pun">...</span><span class="pln"> </span><span class="pun">...</span><span class="pln"> </span></li></ol></pre><div class="code-pretty-toolbar"><span class="title">Python</span><a href="javascript:void(0);" title="复制代码" class="tool clipboard"><i class="fa fa-files-o"></i></a><a href="javascript:void(0);" title="查看纯文本代码" class="tool view-source"><i class="fa fa-code"></i></a><a href="javascript:void(0);" title="返回代码高亮" class="tool back-to-pretty"><i class="fa fa-undo"></i></a><span class="msg"></span></div></div>
<p><strong>3. 进一步处理特征和标签，以及数据分组：</strong></p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-python prettyprinted" style=""><ol class="linenums"><li class="L0"><span class="pun">//分别获取标签列和特征列，进行索引，并进行了重命名。</span></li><li class="L1"><span class="pln">labelIndexer </span><span class="pun">=</span><span class="pln"> </span><span class="typ">StringIndexer</span><span class="pun">().</span><span class="pln">setInputCol</span><span class="pun">(</span><span class="str">"label"</span><span class="pun">).</span><span class="pln">setOutputCol</span><span class="pun">(</span><span class="str">"indexedLabel"</span><span class="pun">).</span><span class="pln">fit</span><span class="pun">(</span><span class="pln">df</span><span class="pun">)</span></li><li class="L2"><span class="pln">&nbsp;</span></li><li class="L3"><span class="pln">featureIndexer </span><span class="pun">=</span><span class="pln"> </span><span class="typ">VectorIndexer</span><span class="pun">().</span><span class="pln">setInputCol</span><span class="pun">(</span><span class="str">"features"</span><span class="pun">).</span><span class="pln">setOutputCol</span><span class="pun">(</span><span class="str">"indexedFeatures"</span><span class="pun">).</span><span class="pln">setMaxCategories</span><span class="pun">(</span><span class="lit">4</span><span class="pun">).</span><span class="pln">fit</span><span class="pun">(</span><span class="pln">df</span><span class="pun">)</span></li><li class="L4"><span class="pln">&nbsp;</span></li><li class="L5"><span class="pun">//这里我们设置一个</span><span class="pln">labelConverter</span><span class="pun">，目的是把预测的类别重新转化成字符型的。</span></li><li class="L6"><span class="pln">labelConverter </span><span class="pun">=</span><span class="pln"> </span><span class="typ">IndexToString</span><span class="pun">().</span><span class="pln">setInputCol</span><span class="pun">(</span><span class="str">"prediction"</span><span class="pun">).</span><span class="pln">setOutputCol</span><span class="pun">(</span><span class="str">"predictedLabel"</span><span class="pun">).</span><span class="pln">setLabels</span><span class="pun">(</span><span class="pln">labelIndexer</span><span class="pun">.</span><span class="pln">labels</span><span class="pun">)</span></li><li class="L7"><span class="pun">//接下来，我们把数据集随机分成训练集和测试集，其中训练集占</span><span class="lit">70</span><span class="pun">%。</span></li><li class="L8"><span class="pln">trainingData</span><span class="pun">,</span><span class="pln"> testData </span><span class="pun">=</span><span class="pln"> data</span><span class="pun">.</span><span class="pln">randomSplit</span><span class="pun">([</span><span class="lit">0.7</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.3</span><span class="pun">])</span></li></ol></pre><div class="code-pretty-toolbar"><span class="title">Python</span><a href="javascript:void(0);" title="复制代码" class="tool clipboard"><i class="fa fa-files-o"></i></a><a href="javascript:void(0);" title="查看纯文本代码" class="tool view-source"><i class="fa fa-code"></i></a><a href="javascript:void(0);" title="返回代码高亮" class="tool back-to-pretty"><i class="fa fa-undo"></i></a><span class="msg"></span></div></div>
<p><strong>4. 构建决策树分类模型：</strong></p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-python prettyprinted" style=""><ol class="linenums"><li class="L0"><span class="pun">//导入所需要的包</span></li><li class="L1"><span class="kwd">from</span><span class="pln"> pyspark</span><span class="pun">.</span><span class="pln">ml</span><span class="pun">.</span><span class="pln">classification </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">DecisionTreeClassificationModel</span><span class="pun">,</span><span class="typ">DecisionTreeClassifier</span></li><li class="L2"><span class="kwd">from</span><span class="pln"> pyspark</span><span class="pun">.</span><span class="pln">ml</span><span class="pun">.</span><span class="pln">evaluation </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">MulticlassClassificationEvaluator</span></li><li class="L3"><span class="pun">//训练决策树模型,这里我们可以通过</span><span class="pln">setter</span><span class="pun">的方法来设置决策树的参数，也可以用</span><span class="typ">ParamMap</span><span class="pun">来设置（具体的可以查看</span><span class="pln">spark mllib</span><span class="pun">的官网）。具体的可以设置的参数可以通过</span><span class="pln">explainParams</span><span class="pun">()来获取。</span></li><li class="L4"><span class="pln">dtClassifier </span><span class="pun">=</span><span class="pln"> </span><span class="typ">DecisionTreeClassifier</span><span class="pun">().</span><span class="pln">setLabelCol</span><span class="pun">(</span><span class="str">"indexedLabel"</span><span class="pun">).</span><span class="pln">setFeaturesCol</span><span class="pun">(</span><span class="str">"indexedFeatures"</span><span class="pun">)</span></li><li class="L5"><span class="pun">//在</span><span class="pln">pipeline</span><span class="pun">中进行设置</span></li><li class="L6"><span class="pln">pipelinedClassifier </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Pipeline</span><span class="pun">().</span><span class="pln">setStages</span><span class="pun">([</span><span class="pln">labelIndexer</span><span class="pun">,</span><span class="pln"> featureIndexer</span><span class="pun">,</span><span class="pln"> dtClassifier</span><span class="pun">,</span><span class="pln"> labelConverter</span><span class="pun">])</span></li><li class="L7"><span class="pun">//训练决策树模型</span></li><li class="L8"><span class="pln">modelClassifier </span><span class="pun">=</span><span class="pln"> pipelinedClassifier</span><span class="pun">.</span><span class="pln">fit</span><span class="pun">(</span><span class="pln">trainingData</span><span class="pun">)</span></li><li class="L9"><span class="pun">//进行预测</span></li><li class="L0"><span class="pln">predictionsClassifier </span><span class="pun">=</span><span class="pln"> modelClassifier</span><span class="pun">.</span><span class="pln">transform</span><span class="pun">(</span><span class="pln">testData</span><span class="pun">)</span></li><li class="L1"><span class="pun">//查看部分预测的结果</span></li><li class="L2"><span class="pln">predictionsClassifier</span><span class="pun">.</span><span class="pln">select</span><span class="pun">(</span><span class="str">"predictedLabel"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"label"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"features"</span><span class="pun">).</span><span class="pln">show</span><span class="pun">(</span><span class="lit">20</span><span class="pun">)</span></li><li class="L3"><span class="pun">+---------------+---------------+-----------------+</span></li><li class="L4"><span class="pun">|</span><span class="pln"> predictedLabel</span><span class="pun">|</span><span class="pln">          label</span><span class="pun">|</span><span class="pln">         features</span><span class="pun">|</span></li><li class="L5"><span class="pun">+---------------+---------------+-----------------+</span></li><li class="L6"><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|[</span><span class="lit">4.3</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">1.1</span><span class="pun">,</span><span class="lit">0.1</span><span class="pun">]|</span></li><li class="L7"><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|[</span><span class="lit">4.6</span><span class="pun">,</span><span class="lit">3.4</span><span class="pun">,</span><span class="lit">1.4</span><span class="pun">,</span><span class="lit">0.3</span><span class="pun">]|</span></li><li class="L8"><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|[</span><span class="lit">4.6</span><span class="pun">,</span><span class="lit">3.6</span><span class="pun">,</span><span class="lit">1.0</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">]|</span></li><li class="L9"><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|[</span><span class="lit">4.8</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">1.4</span><span class="pun">,</span><span class="lit">0.1</span><span class="pun">]|</span></li><li class="L0"><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|[</span><span class="lit">4.8</span><span class="pun">,</span><span class="lit">3.1</span><span class="pun">,</span><span class="lit">1.6</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">]|</span></li><li class="L1"><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|[</span><span class="lit">4.8</span><span class="pun">,</span><span class="lit">3.4</span><span class="pun">,</span><span class="lit">1.6</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">]|</span></li><li class="L2"><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|[</span><span class="lit">4.9</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">1.4</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">]|</span></li><li class="L3"><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|[</span><span class="lit">4.9</span><span class="pun">,</span><span class="lit">3.1</span><span class="pun">,</span><span class="lit">1.5</span><span class="pun">,</span><span class="lit">0.1</span><span class="pun">]|</span></li><li class="L4"><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|[</span><span class="lit">5.0</span><span class="pun">,</span><span class="lit">3.5</span><span class="pun">,</span><span class="lit">1.3</span><span class="pun">,</span><span class="lit">0.3</span><span class="pun">]|</span></li><li class="L5"><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|[</span><span class="lit">5.1</span><span class="pun">,</span><span class="lit">3.3</span><span class="pun">,</span><span class="lit">1.7</span><span class="pun">,</span><span class="lit">0.5</span><span class="pun">]|</span></li><li class="L6"><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|[</span><span class="lit">5.1</span><span class="pun">,</span><span class="lit">3.4</span><span class="pun">,</span><span class="lit">1.5</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">]|</span></li><li class="L7"><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|[</span><span class="lit">5.1</span><span class="pun">,</span><span class="lit">3.7</span><span class="pun">,</span><span class="lit">1.5</span><span class="pun">,</span><span class="lit">0.4</span><span class="pun">]|</span></li><li class="L8"><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|[</span><span class="lit">5.1</span><span class="pun">,</span><span class="lit">3.8</span><span class="pun">,</span><span class="lit">1.9</span><span class="pun">,</span><span class="lit">0.4</span><span class="pun">]|</span></li><li class="L9"><span class="pun">|</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">|</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">|[</span><span class="lit">5.2</span><span class="pun">,</span><span class="lit">2.7</span><span class="pun">,</span><span class="lit">3.9</span><span class="pun">,</span><span class="lit">1.4</span><span class="pun">]|</span></li><li class="L0"><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|[</span><span class="lit">5.4</span><span class="pun">,</span><span class="lit">3.9</span><span class="pun">,</span><span class="lit">1.3</span><span class="pun">,</span><span class="lit">0.4</span><span class="pun">]|</span></li><li class="L1"><span class="pun">|</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">|</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">|[</span><span class="lit">5.7</span><span class="pun">,</span><span class="lit">2.8</span><span class="pun">,</span><span class="lit">4.5</span><span class="pun">,</span><span class="lit">1.3</span><span class="pun">]|</span></li><li class="L2"><span class="pun">|</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">|</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">|[</span><span class="lit">5.8</span><span class="pun">,</span><span class="lit">2.7</span><span class="pun">,</span><span class="lit">4.1</span><span class="pun">,</span><span class="lit">1.0</span><span class="pun">]|</span></li><li class="L3"><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|[</span><span class="lit">5.8</span><span class="pun">,</span><span class="lit">4.0</span><span class="pun">,</span><span class="lit">1.2</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">]|</span></li><li class="L4"><span class="pun">|</span><span class="pln"> </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">|</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">|[</span><span class="lit">5.9</span><span class="pun">,</span><span class="lit">3.2</span><span class="pun">,</span><span class="lit">4.8</span><span class="pun">,</span><span class="lit">1.8</span><span class="pun">]|</span></li><li class="L5"><span class="pun">|</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">|</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">|[</span><span class="lit">6.1</span><span class="pun">,</span><span class="lit">2.9</span><span class="pun">,</span><span class="lit">4.7</span><span class="pun">,</span><span class="lit">1.4</span><span class="pun">]|</span></li><li class="L6"><span class="pun">+---------------+---------------+-----------------+</span></li><li class="L7"><span class="pln">only showing top </span><span class="lit">20</span><span class="pln"> rows</span></li><li class="L8"><span class="pln">&nbsp;</span></li></ol></pre><div class="code-pretty-toolbar"><span class="title">Python</span><a href="javascript:void(0);" title="复制代码" class="tool clipboard"><i class="fa fa-files-o"></i></a><a href="javascript:void(0);" title="查看纯文本代码" class="tool view-source"><i class="fa fa-code"></i></a><a href="javascript:void(0);" title="返回代码高亮" class="tool back-to-pretty"><i class="fa fa-undo"></i></a><span class="msg"></span></div></div>
<p><strong>5. 评估决策树分类模型：</strong></p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-python prettyprinted" style=""><ol class="linenums"><li class="L0"><span class="pln">evaluatorClassifier </span><span class="pun">=</span><span class="pln"> </span><span class="typ">MulticlassClassificationEvaluator</span><span class="pun">().</span><span class="pln">setLabelCol</span><span class="pun">(</span><span class="str">"indexedLabel"</span><span class="pun">).</span><span class="pln">setPredictionCol</span><span class="pun">(</span><span class="str">"prediction"</span><span class="pun">).</span><span class="pln">setMetricName</span><span class="pun">(</span><span class="str">"accuracy"</span><span class="pun">)</span></li><li class="L1"><span class="pln">&nbsp;</span></li><li class="L2"><span class="pln">accuracy </span><span class="pun">=</span><span class="pln"> evaluatorClassifier</span><span class="pun">.</span><span class="pln">evaluate</span><span class="pun">(</span><span class="pln">predictionsClassifier</span><span class="pun">)</span></li><li class="L3"><span class="pln">&nbsp;</span></li><li class="L4"><span class="kwd">print</span><span class="pun">(</span><span class="str">"Test Error = "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> str</span><span class="pun">(</span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> accuracy</span><span class="pun">))</span></li><li class="L5"><span class="typ">Test</span><span class="pln"> </span><span class="typ">Error</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0.05882352941176472</span></li><li class="L6"><span class="pln">&nbsp;</span></li><li class="L7"><span class="pln">treeModelClassifier </span><span class="pun">=</span><span class="pln"> modelClassifier</span><span class="pun">.</span><span class="pln">stages</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span></li><li class="L8"><span class="pln">&nbsp;</span></li><li class="L9"><span class="kwd">print</span><span class="pun">(</span><span class="str">"Learned classification tree model:\n"</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> str</span><span class="pun">(</span><span class="pln">treeModelClassifier</span><span class="pun">.</span><span class="pln">toDebugString</span><span class="pun">))</span></li><li class="L0"><span class="typ">Learned</span><span class="pln"> classification tree model</span><span class="pun">:</span></li><li class="L1"><span class="typ">DecisionTreeClassificationModel</span><span class="pln"> </span><span class="pun">(</span><span class="pln">uid</span><span class="pun">=</span><span class="typ">DecisionTreeClassifier_4e57b26beacfd363271a</span><span class="pun">)</span><span class="pln"> of depth </span><span class="lit">3</span><span class="pln"> </span><span class="kwd">with</span><span class="pln"> </span><span class="lit">7</span><span class="pln"> nodes</span></li><li class="L2"><span class="pln">  </span><span class="typ">If</span><span class="pln"> </span><span class="pun">(</span><span class="pln">feature </span><span class="lit">2</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">1.9</span><span class="pun">)</span></li><li class="L3"><span class="pln">   </span><span class="typ">Predict</span><span class="pun">:</span><span class="pln"> </span><span class="lit">2.0</span></li><li class="L4"><span class="pln">  </span><span class="typ">Else</span><span class="pln"> </span><span class="pun">(</span><span class="pln">feature </span><span class="lit">2</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1.9</span><span class="pun">)</span></li><li class="L5"><span class="pln">   </span><span class="typ">If</span><span class="pln"> </span><span class="pun">(</span><span class="pln">feature </span><span class="lit">3</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">1.6</span><span class="pun">)</span></li><li class="L6"><span class="pln">    </span><span class="typ">If</span><span class="pln"> </span><span class="pun">(</span><span class="pln">feature </span><span class="lit">2</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">4.9</span><span class="pun">)</span></li><li class="L7"><span class="pln">     </span><span class="typ">Predict</span><span class="pun">:</span><span class="pln"> </span><span class="lit">0.0</span></li><li class="L8"><span class="pln">    </span><span class="typ">Else</span><span class="pln"> </span><span class="pun">(</span><span class="pln">feature </span><span class="lit">2</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">4.9</span><span class="pun">)</span></li><li class="L9"><span class="pln">     </span><span class="typ">Predict</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1.0</span></li><li class="L0"><span class="pln">   </span><span class="typ">Else</span><span class="pln"> </span><span class="pun">(</span><span class="pln">feature </span><span class="lit">3</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1.6</span><span class="pun">)</span></li><li class="L1"><span class="pln">    </span><span class="typ">Predict</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1.0</span></li><li class="L2"><span class="pln">&nbsp;</span></li></ol></pre><div class="code-pretty-toolbar"><span class="title">Python</span><a href="javascript:void(0);" title="复制代码" class="tool clipboard"><i class="fa fa-files-o"></i></a><a href="javascript:void(0);" title="查看纯文本代码" class="tool view-source"><i class="fa fa-code"></i></a><a href="javascript:void(0);" title="返回代码高亮" class="tool back-to-pretty"><i class="fa fa-undo"></i></a><span class="msg"></span></div></div>
<p>​   从上述结果可以看到模型的预测准确率为 0.94以及训练的决策树模型结构。</p>
<p><strong>6. 构建决策树回归模型：</strong></p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-python prettyprinted" style=""><ol class="linenums"><li class="L0"><span class="pun">//导入所需要的包</span></li><li class="L1"><span class="kwd">from</span><span class="pln"> pyspark</span><span class="pun">.</span><span class="pln">ml</span><span class="pun">.</span><span class="pln">regression </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">DecisionTreeRegressionModel</span><span class="pun">,</span><span class="typ">DecisionTreeRegressor</span></li><li class="L2"><span class="kwd">from</span><span class="pln"> pyspark</span><span class="pun">.</span><span class="pln">ml</span><span class="pun">.</span><span class="pln">evaluation </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">RegressionEvaluator</span></li><li class="L3"><span class="pun">//训练决策树模型</span></li><li class="L4"><span class="pln">dtRegressor </span><span class="pun">=</span><span class="pln"> </span><span class="typ">DecisionTreeRegressor</span><span class="pun">().</span><span class="pln">setLabelCol</span><span class="pun">(</span><span class="str">"indexedLabel"</span><span class="pun">).</span><span class="pln">setFeaturesCol</span><span class="pun">(</span><span class="str">"indexedFeatures"</span><span class="pun">)</span></li><li class="L5"><span class="pun">//在</span><span class="pln">pipeline</span><span class="pun">中进行设置</span></li><li class="L6"><span class="pln">pipelineRegressor </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Pipeline</span><span class="pun">().</span><span class="pln">setStages</span><span class="pun">([</span><span class="pln">labelIndexer</span><span class="pun">,</span><span class="pln"> featureIndexer</span><span class="pun">,</span><span class="pln"> dtRegressor</span><span class="pun">,</span><span class="pln"> labelConverter</span><span class="pun">])</span></li><li class="L7"><span class="pun">//训练决策树模型</span></li><li class="L8"><span class="pln">modelRegressor </span><span class="pun">=</span><span class="pln"> pipelineRegressor</span><span class="pun">.</span><span class="pln">fit</span><span class="pun">(</span><span class="pln">trainingData</span><span class="pun">)</span></li><li class="L9"><span class="pun">//进行预测</span></li><li class="L0"><span class="pln">predictionsRegressor </span><span class="pun">=</span><span class="pln"> modelRegressor</span><span class="pun">.</span><span class="pln">transform</span><span class="pun">(</span><span class="pln">testData</span><span class="pun">)</span></li><li class="L1"><span class="pun">//查看部分预测结果</span></li><li class="L2"><span class="pln">predictionsRegressor</span><span class="pun">.</span><span class="pln">select</span><span class="pun">(</span><span class="str">"predictedLabel"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"label"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"features"</span><span class="pun">).</span><span class="pln">show</span><span class="pun">(</span><span class="lit">20</span><span class="pun">)</span></li><li class="L3"><span class="pln">&nbsp;</span></li><li class="L4"><span class="pun">+---------------+---------------+-----------------+</span></li><li class="L5"><span class="pun">|</span><span class="pln"> predictedLabel</span><span class="pun">|</span><span class="pln">          label</span><span class="pun">|</span><span class="pln">         features</span><span class="pun">|</span></li><li class="L6"><span class="pun">+---------------+---------------+-----------------+</span></li><li class="L7"><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|[</span><span class="lit">4.3</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">1.1</span><span class="pun">,</span><span class="lit">0.1</span><span class="pun">]|</span></li><li class="L8"><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|[</span><span class="lit">4.6</span><span class="pun">,</span><span class="lit">3.4</span><span class="pun">,</span><span class="lit">1.4</span><span class="pun">,</span><span class="lit">0.3</span><span class="pun">]|</span></li><li class="L9"><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|[</span><span class="lit">4.6</span><span class="pun">,</span><span class="lit">3.6</span><span class="pun">,</span><span class="lit">1.0</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">]|</span></li><li class="L0"><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|[</span><span class="lit">4.8</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">1.4</span><span class="pun">,</span><span class="lit">0.1</span><span class="pun">]|</span></li><li class="L1"><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|[</span><span class="lit">4.8</span><span class="pun">,</span><span class="lit">3.1</span><span class="pun">,</span><span class="lit">1.6</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">]|</span></li><li class="L2"><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|[</span><span class="lit">4.8</span><span class="pun">,</span><span class="lit">3.4</span><span class="pun">,</span><span class="lit">1.6</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">]|</span></li><li class="L3"><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|[</span><span class="lit">4.9</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">1.4</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">]|</span></li><li class="L4"><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|[</span><span class="lit">4.9</span><span class="pun">,</span><span class="lit">3.1</span><span class="pun">,</span><span class="lit">1.5</span><span class="pun">,</span><span class="lit">0.1</span><span class="pun">]|</span></li><li class="L5"><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|[</span><span class="lit">5.0</span><span class="pun">,</span><span class="lit">3.5</span><span class="pun">,</span><span class="lit">1.3</span><span class="pun">,</span><span class="lit">0.3</span><span class="pun">]|</span></li><li class="L6"><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|[</span><span class="lit">5.1</span><span class="pun">,</span><span class="lit">3.3</span><span class="pun">,</span><span class="lit">1.7</span><span class="pun">,</span><span class="lit">0.5</span><span class="pun">]|</span></li><li class="L7"><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|[</span><span class="lit">5.1</span><span class="pun">,</span><span class="lit">3.4</span><span class="pun">,</span><span class="lit">1.5</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">]|</span></li><li class="L8"><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|[</span><span class="lit">5.1</span><span class="pun">,</span><span class="lit">3.7</span><span class="pun">,</span><span class="lit">1.5</span><span class="pun">,</span><span class="lit">0.4</span><span class="pun">]|</span></li><li class="L9"><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|[</span><span class="lit">5.1</span><span class="pun">,</span><span class="lit">3.8</span><span class="pun">,</span><span class="lit">1.9</span><span class="pun">,</span><span class="lit">0.4</span><span class="pun">]|</span></li><li class="L0"><span class="pun">|</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">|</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">|[</span><span class="lit">5.2</span><span class="pun">,</span><span class="lit">2.7</span><span class="pun">,</span><span class="lit">3.9</span><span class="pun">,</span><span class="lit">1.4</span><span class="pun">]|</span></li><li class="L1"><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|[</span><span class="lit">5.4</span><span class="pun">,</span><span class="lit">3.9</span><span class="pun">,</span><span class="lit">1.3</span><span class="pun">,</span><span class="lit">0.4</span><span class="pun">]|</span></li><li class="L2"><span class="pun">|</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">|</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">|[</span><span class="lit">5.7</span><span class="pun">,</span><span class="lit">2.8</span><span class="pun">,</span><span class="lit">4.5</span><span class="pun">,</span><span class="lit">1.3</span><span class="pun">]|</span></li><li class="L3"><span class="pun">|</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">|</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">|[</span><span class="lit">5.8</span><span class="pun">,</span><span class="lit">2.7</span><span class="pun">,</span><span class="lit">4.1</span><span class="pun">,</span><span class="lit">1.0</span><span class="pun">]|</span></li><li class="L4"><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|</span><span class="pln">    </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">setosa</span><span class="pun">|[</span><span class="lit">5.8</span><span class="pun">,</span><span class="lit">4.0</span><span class="pun">,</span><span class="lit">1.2</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">]|</span></li><li class="L5"><span class="pun">|</span><span class="pln"> </span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">virginica</span><span class="pun">|</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">|[</span><span class="lit">5.9</span><span class="pun">,</span><span class="lit">3.2</span><span class="pun">,</span><span class="lit">4.8</span><span class="pun">,</span><span class="lit">1.8</span><span class="pun">]|</span></li><li class="L6"><span class="pun">|</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">|</span><span class="typ">Iris</span><span class="pun">-</span><span class="pln">versicolor</span><span class="pun">|[</span><span class="lit">6.1</span><span class="pun">,</span><span class="lit">2.9</span><span class="pun">,</span><span class="lit">4.7</span><span class="pun">,</span><span class="lit">1.4</span><span class="pun">]|</span></li><li class="L7"><span class="pun">+---------------+---------------+-----------------+</span></li><li class="L8"><span class="pln">only showing top </span><span class="lit">20</span><span class="pln"> rows</span></li><li class="L9"><span class="pln">&nbsp;</span></li></ol></pre><div class="code-pretty-toolbar"><span class="title">Python</span><a href="javascript:void(0);" title="复制代码" class="tool clipboard"><i class="fa fa-files-o"></i></a><a href="javascript:void(0);" title="查看纯文本代码" class="tool view-source"><i class="fa fa-code"></i></a><a href="javascript:void(0);" title="返回代码高亮" class="tool back-to-pretty"><i class="fa fa-undo"></i></a><span class="msg"></span></div></div>
<p><strong>7. 评估决策树回归模型：</strong></p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-python prettyprinted" style=""><ol class="linenums"><li class="L0"><span class="pln">evaluatorRegressor </span><span class="pun">=</span><span class="pln"> </span><span class="typ">RegressionEvaluator</span><span class="pun">().</span><span class="pln">setLabelCol</span><span class="pun">(</span><span class="str">"indexedLabel"</span><span class="pun">).</span><span class="pln">setPredictionCol</span><span class="pun">(</span><span class="str">"prediction"</span><span class="pun">).</span><span class="pln">setMetricName</span><span class="pun">(</span><span class="str">"rmse"</span><span class="pun">)</span></li><li class="L1"><span class="pln">&nbsp;</span></li><li class="L2"><span class="pln">rmse </span><span class="pun">=</span><span class="pln"> evaluatorRegressor</span><span class="pun">.</span><span class="pln">evaluate</span><span class="pun">(</span><span class="pln">predictionsRegressor</span><span class="pun">)</span></li><li class="L3"><span class="pln">&nbsp;</span></li><li class="L4"><span class="kwd">print</span><span class="pun">(</span><span class="str">"Root Mean Squared Error (RMSE) on test data = "</span><span class="pln"> </span><span class="pun">+</span><span class="pln">str</span><span class="pun">(</span><span class="pln">rmse</span><span class="pun">))</span></li><li class="L5"><span class="typ">Root</span><span class="pln"> </span><span class="typ">Mean</span><span class="pln"> </span><span class="typ">Squared</span><span class="pln"> </span><span class="typ">Error</span><span class="pln"> </span><span class="pun">(</span><span class="pln">RMSE</span><span class="pun">)</span><span class="pln"> on test data </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0.24253562503633297</span></li><li class="L6"><span class="pln">&nbsp;</span></li><li class="L7"><span class="pln">treeModelRegressor </span><span class="pun">=</span><span class="pln"> modelRegressor</span><span class="pun">.</span><span class="pln">stages</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span></li><li class="L8"><span class="pln">&nbsp;</span></li><li class="L9"><span class="kwd">print</span><span class="pun">(</span><span class="str">"Learned regression tree model:\n"</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> str</span><span class="pun">(</span><span class="pln">treeModelRegressor</span><span class="pun">.</span><span class="pln">toDebugString</span><span class="pun">))</span></li><li class="L0"><span class="typ">Learned</span><span class="pln"> regression tree model</span><span class="pun">:</span></li><li class="L1"><span class="typ">DecisionTreeRegressionModel</span><span class="pln"> </span><span class="pun">(</span><span class="pln">uid</span><span class="pun">=</span><span class="typ">DecisionTreeRegressor_4325a44aff74cf6ff7b3</span><span class="pun">)</span><span class="pln"> of depth </span><span class="lit">3</span><span class="pln"> </span><span class="kwd">with</span><span class="pln"> </span><span class="lit">7</span><span class="pln"> nodes</span></li><li class="L2"><span class="pln">  </span><span class="typ">If</span><span class="pln"> </span><span class="pun">(</span><span class="pln">feature </span><span class="lit">2</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">1.9</span><span class="pun">)</span></li><li class="L3"><span class="pln">   </span><span class="typ">Predict</span><span class="pun">:</span><span class="pln"> </span><span class="lit">2.0</span></li><li class="L4"><span class="pln">  </span><span class="typ">Else</span><span class="pln"> </span><span class="pun">(</span><span class="pln">feature </span><span class="lit">2</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1.9</span><span class="pun">)</span></li><li class="L5"><span class="pln">   </span><span class="typ">If</span><span class="pln"> </span><span class="pun">(</span><span class="pln">feature </span><span class="lit">3</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">1.6</span><span class="pun">)</span></li><li class="L6"><span class="pln">    </span><span class="typ">If</span><span class="pln"> </span><span class="pun">(</span><span class="pln">feature </span><span class="lit">2</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">4.9</span><span class="pun">)</span></li><li class="L7"><span class="pln">     </span><span class="typ">Predict</span><span class="pun">:</span><span class="pln"> </span><span class="lit">0.0</span></li><li class="L8"><span class="pln">    </span><span class="typ">Else</span><span class="pln"> </span><span class="pun">(</span><span class="pln">feature </span><span class="lit">2</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">4.9</span><span class="pun">)</span></li><li class="L9"><span class="pln">     </span><span class="typ">Predict</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1.0</span></li><li class="L0"><span class="pln">   </span><span class="typ">Else</span><span class="pln"> </span><span class="pun">(</span><span class="pln">feature </span><span class="lit">3</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1.6</span><span class="pun">)</span></li><li class="L1"><span class="pln">    </span><span class="typ">Predict</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1.0</span></li><li class="L2"><span class="pln">&nbsp;</span></li></ol></pre><div class="code-pretty-toolbar"><span class="title">Python</span><a href="javascript:void(0);" title="复制代码" class="tool clipboard"><i class="fa fa-files-o"></i></a><a href="javascript:void(0);" title="查看纯文本代码" class="tool view-source"><i class="fa fa-code"></i></a><a href="javascript:void(0);" title="返回代码高亮" class="tool back-to-pretty"><i class="fa fa-undo"></i></a><span class="msg"></span></div></div>
<p>从上述结果可以看到模型的标准误差为 0.75以及训练的决策树模型结构。</p>
<p><img src="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/Spark.jpg" alt="子雨大数据之Spark入门" title=""><br>
<img src="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/Spark.png" alt="扫一扫访问本博客" title=""></p>
			</div><!-- .entry-content -->

	<footer class="entry-footer">
		<div class="entry-author">
			<div class="author-title">本文作者</div>
			
		<div class="author-avatar"><img src="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/2.jpg" alt="阮榕城" class="avatar avatar-thumbnail wp-user-avatar wp-user-avatar-thumbnail alignnone photo"></div>
		<div class="author-info">
			<p class="author-name"><a href="http://dblab.xmu.edu.cn/blog/author/ruanrongcheng/">阮榕城</a></p>
			<p class="author-desc">磨人的小妖精！</p>
			<p class="author-contact"><a href="http://www.nekomiao.me/" target="_blank" title="个人主页" class="homepage"><i class="fa fa-home"></i>www.nekomiao.me</a><i class="fa fa-envelope"></i><span class="envelope">moc.qq@crnaur</span></p>
		</div>
			</div>
		<div class="entry-info">
			<span class="permalink"><i class="fa fa-external-link"></i> <a href="http://dblab.xmu.edu.cn/blog/1776-2/" title="Spark 2.1.0入门：决策树分类器(Python版)">http://dblab.xmu.edu.cn/blog/1776-2/</a></span><span class="category"><i class="fa fa-folder-open-o"></i> <a href="http://dblab.xmu.edu.cn/blog/category/big-data/" rel="category tag">大数据</a></span>		</div>
		<div class="yarpp-related yarpp-related-none">
</div>
	</footer><!-- .entry-footer -->
</article><!-- #post-## -->
			</div>
</div><!-- .row -->

	<div class="row">
		<div class="col-sm-3"></div>
		<div class="col-sm-9 site-footer">
			© 2014 <a href="http://dblab.xmu.edu.cn/">厦大数据库实验室</a>
					</div>
	</div>
</div><!-- .container -->
<link rel="stylesheet" id="yarppRelatedCss-css" href="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/related.css" type="text/css" media="all">
<script type="text/javascript" src="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/prettify.js"></script>
<script type="text/javascript" src="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/power.js"></script>
<script type="text/javascript" src="6.4.3Spark%202.1.0%E5%85%A5%E9%97%A8%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/wp-embed.js"></script>

<div class="back-to-top" id="back-to-top" title="嗖的就上去了！"><span><i class="fa fa-chevron-up"></i></span></div></body></html>