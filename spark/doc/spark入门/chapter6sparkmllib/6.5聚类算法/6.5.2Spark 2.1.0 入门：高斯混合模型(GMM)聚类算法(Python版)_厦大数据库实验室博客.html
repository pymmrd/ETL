<!DOCTYPE html>
<html lang="zh-CN"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Spark 2.1.0 入门：高斯混合模型(GMM)聚类算法(Python版)_厦大数据库实验室博客</title>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="renderer" content="webkit">
<link rel="dns-prefetch" href="http://cdn.staticfile.org/">
<link rel="dns-prefetch" href="http://s.w.org/">
<link rel="stylesheet" id="yarppWidgetCss-css" href="6.5.2Spark%202.1.0%20%E5%85%A5%E9%97%A8%EF%BC%9A%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E6%A8%A1%E5%9E%8B(GMM)%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/widget.css" type="text/css" media="all">
<link rel="stylesheet" id="wp-quicklatex-format-css" href="6.5.2Spark%202.1.0%20%E5%85%A5%E9%97%A8%EF%BC%9A%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E6%A8%A1%E5%9E%8B(GMM)%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex-format.css" type="text/css" media="all">
<link rel="stylesheet" id="bootstrap-css" href="6.5.2Spark%202.1.0%20%E5%85%A5%E9%97%A8%EF%BC%9A%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E6%A8%A1%E5%9E%8B(GMM)%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/bootstrap.css" type="text/css" media="all">
<link rel="stylesheet" id="font-awesome-css" href="6.5.2Spark%202.1.0%20%E5%85%A5%E9%97%A8%EF%BC%9A%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E6%A8%A1%E5%9E%8B(GMM)%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/font-awesome.css" type="text/css" media="all">
<link rel="stylesheet" id="power-css" href="6.5.2Spark%202.1.0%20%E5%85%A5%E9%97%A8%EF%BC%9A%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E6%A8%A1%E5%9E%8B(GMM)%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/style.css" type="text/css" media="all">
<link rel="stylesheet" id="google-code-prettify-css" href="6.5.2Spark%202.1.0%20%E5%85%A5%E9%97%A8%EF%BC%9A%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E6%A8%A1%E5%9E%8B(GMM)%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/prettify.css" type="text/css" media="all">
<script type="text/javascript" async="" charset="utf-8" src="6.5.2Spark%202.1.0%20%E5%85%A5%E9%97%A8%EF%BC%9A%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E6%A8%A1%E5%9E%8B(GMM)%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/core.js"></script><script src="6.5.2Spark%202.1.0%20%E5%85%A5%E9%97%A8%EF%BC%9A%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E6%A8%A1%E5%9E%8B(GMM)%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/hm.js"></script><script src="6.5.2Spark%202.1.0%20%E5%85%A5%E9%97%A8%EF%BC%9A%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E6%A8%A1%E5%9E%8B(GMM)%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/z_stat.js"></script><script type="text/javascript" src="6.5.2Spark%202.1.0%20%E5%85%A5%E9%97%A8%EF%BC%9A%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E6%A8%A1%E5%9E%8B(GMM)%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/jquery_002.js"></script>
<script type="text/javascript" src="6.5.2Spark%202.1.0%20%E5%85%A5%E9%97%A8%EF%BC%9A%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E6%A8%A1%E5%9E%8B(GMM)%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/jquery.js"></script>
<script type="text/javascript" src="6.5.2Spark%202.1.0%20%E5%85%A5%E9%97%A8%EF%BC%9A%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E6%A8%A1%E5%9E%8B(GMM)%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/jquery-migrate.js"></script>
<script type="text/javascript" src="6.5.2Spark%202.1.0%20%E5%85%A5%E9%97%A8%EF%BC%9A%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E6%A8%A1%E5%9E%8B(GMM)%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/wp-quicklatex-frontend.js"></script>
<link rel="https://api.w.org/" href="http://dblab.xmu.edu.cn/blog/wp-json/">
<link rel="prev" title="Spark 2.1.0 入门：KMeans聚类算法(Python版)" href="http://dblab.xmu.edu.cn/blog/1779-2/">
<link rel="next" title="Spark 2.1.0 入门：协同过滤算法(Python版)" href="http://dblab.xmu.edu.cn/blog/1781-2/">
<link rel="canonical" href="http://dblab.xmu.edu.cn/blog/1780-2/">
<link rel="alternate" type="application/json+oembed" href="http://dblab.xmu.edu.cn/blog/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fdblab.xmu.edu.cn%2Fblog%2F1780-2%2F">
<!--[if lt IE 9]>
<script src="http://dblab.xmu.edu.cn/blog/wp-content/themes/power/js/html5shiv.js"></script>
<![endif]-->
</head>

<body class="post-template-default single single-post postid-1780 single-format-standard group-blog">
<div class="container site-page">

<div class="row">
	<div class="col-sm-3 site-infos">
		<h4 class="site-title">
			<a href="http://dblab.xmu.edu.cn/blog/" title="厦大数据库实验室博客" rel="home">厦大数据库实验室博客</a>
		</h4>
		<div class="site-description">总结、分享、收获<p><a href="http://dblab.xmu.edu.cn/" title="厦大数据库实验室">实验室主页</a></p></div>

		<nav class="main-navigation" role="navigation">
			<div class="menu-primary-container"><ul id="menu-primary" class="menu menu-level-1"><li id="menu-item-80" class="menu-item item-level-1"><a href="http://dblab.xmu.edu.cn/blog/">首页</a></li>
<li id="menu-item-85" class="menu-item item-level-1 current-path"><a href="http://dblab.xmu.edu.cn/blog/category/big-data/">大数据</a></li>
<li id="menu-item-676" class="menu-item item-level-1"><a href="http://dblab.xmu.edu.cn/blog/category/databases/">数据库</a></li>
<li id="menu-item-87" class="menu-item item-level-1"><a href="http://dblab.xmu.edu.cn/blog/category/data-mining/">数据挖掘</a></li>
<li id="menu-item-86" class="menu-item item-level-1"><a href="http://dblab.xmu.edu.cn/blog/category/others/">其他</a></li>
</ul></div>		</nav><!-- #site-navigation -->

		<div class="search"><form role="search" method="get" class="search-form" action="http://dblab.xmu.edu.cn/blog/">
				<label>
					<span class="screen-reader-text">搜索：</span>
					<input class="search-field" placeholder="搜索…" name="s" type="search">
				</label>
				<input class="search-submit" value="搜索" type="submit">
			</form></div>
	</div>
	<div class="col-sm-9 site-main">

					<article id="post-1780" class="post-1780 post type-post status-publish format-standard hentry category-big-data">
	<header class="entry-header">
		<h1 class="entry-title">Spark 2.1.0 入门：高斯混合模型(GMM)聚类算法(Python版)</h1>

		<div class="entry-meta">
			<span class="author"><i class="fa fa-user"></i> 阮榕城</span><span class="date"><i class="fa fa-calendar"></i> <time datetime="2017-12-19T10:09:25+00:00">2017年12月19日</time> <span class="updated">(updated: <time class="updated" datetime="2018-01-08T11:07:34+00:00">2018年1月8日</time>)</span></span><span class="views" id="views"><i class="fa fa-eye"></i> 2088</span>		</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

	<div class="entry-content">
		<div class="bigdata-book">
			<a href="http://dblab.xmu.edu.cn/post/5899/" title="2019年1月20日寒假大数据师资培训班" target="_blank"><img src="6.5.2Spark%202.1.0%20%E5%85%A5%E9%97%A8%EF%BC%9A%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E6%A8%A1%E5%9E%8B(GMM)%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/peixunban2019-01-20.jpg" alt="2019年1月20日寒假大数据师资培训班"></a>
		</div>
		<p>【版权声明】博客内容由厦门大学数据库实验室拥有版权，未经允许，请勿转载！</p>
<p>[<a href="http://dblab.xmu.edu.cn/blog/spark/" target="_blank">返回Spark教程首页</a>]</p>
<h2><span id="more-1780"></span></h2>
<p><strong>高斯混合模型（Gaussian Mixture Model, GMM）</strong> 是一种概率式的聚类方法，属于生成式模型，它假设所有的数据样本都是由某一个给定参数的 <strong>多元高斯分布</strong> 所生成的。具体地，给定类个数<code>K</code>，对于给定样本空间中的样本 </p>
<p class="ql-center-displayed-equation" style="line-height: 8px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.5.2Spark%202.1.0%20%E5%85%A5%E9%97%A8%EF%BC%9A%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E6%A8%A1%E5%9E%8B(GMM)%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_011.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[\mathbf{x}\]" title="Rendered by QuickLaTeX.com" width="11" height="8"></p>
<p> ，一个高斯混合模型的概率密度函数可以由K个多元高斯分布组合成的混合分布表示：</p>
<p class="ql-center-displayed-equation" style="line-height: 54px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.5.2Spark%202.1.0%20%E5%85%A5%E9%97%A8%EF%BC%9A%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E6%A8%A1%E5%9E%8B(GMM)%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_009.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[p(\mathbf{x}) = \sum_{i=1}^{K}w_i\cdot p(\mathbf{x}|\mathbf{\mu}_i,\Sigma_i)\]" title="Rendered by QuickLaTeX.com" width="198" height="54"></p>
<p>其中，</p>
<p class="ql-center-displayed-equation" style="line-height: 18px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.5.2Spark%202.1.0%20%E5%85%A5%E9%97%A8%EF%BC%9A%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E6%A8%A1%E5%9E%8B(GMM)%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_002.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[p(\mathbf{x}|\mathbf{\mu},\Sigma)\]" title="Rendered by QuickLaTeX.com" width="70" height="18"></p>
<p> 是以 </p>
<p class="ql-center-displayed-equation" style="line-height: 12px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.5.2Spark%202.1.0%20%E5%85%A5%E9%97%A8%EF%BC%9A%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E6%A8%A1%E5%9E%8B(GMM)%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_005.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[\mathbf{\mu}\]" title="Rendered by QuickLaTeX.com" width="11" height="12"></p>
<p> 为均值向量， </p>
<p class="ql-center-displayed-equation" style="line-height: 12px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.5.2Spark%202.1.0%20%E5%85%A5%E9%97%A8%EF%BC%9A%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E6%A8%A1%E5%9E%8B(GMM)%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[\mathbf{\Sigma}\]" title="Rendered by QuickLaTeX.com" width="13" height="12"></p>
<p> 为协方差矩阵的多元高斯分布的概率密度函数，可以看出，高斯混合模型由K个不同的多元高斯分布共同组成，每一个分布被称为高斯混合模型中的一个 <strong>成分(Component)</strong>， 而</p>
<p class="ql-center-displayed-equation" style="line-height: 10px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.5.2Spark%202.1.0%20%E5%85%A5%E9%97%A8%EF%BC%9A%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E6%A8%A1%E5%9E%8B(GMM)%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_010.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[w_i\]" title="Rendered by QuickLaTeX.com" width="18" height="10"></p>
<p> 为第<code>i</code>个多元高斯分布在混合模型中的 <strong>权重</strong> ，且有 </p>
<p class="ql-center-displayed-equation" style="line-height: 23px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.5.2Spark%202.1.0%20%E5%85%A5%E9%97%A8%EF%BC%9A%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E6%A8%A1%E5%9E%8B(GMM)%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_007.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[\Sigma_{i=1}^{K}w_i = 1\]" title="Rendered by QuickLaTeX.com" width="85" height="23"></p>
<p> 。</p>
<p>假设已有一个存在的高斯混合模型，那么，样本空间中的样本的生成过程即是：以 </p>
<p class="ql-center-displayed-equation" style="line-height: 12px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.5.2Spark%202.1.0%20%E5%85%A5%E9%97%A8%EF%BC%9A%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E6%A8%A1%E5%9E%8B(GMM)%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_006.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[w_1, w_2, ... w_K\]" title="Rendered by QuickLaTeX.com" width="98" height="12"></p>
<p>作为概率（实际上，权重可以直观理解成相应成分产生的样本占总样本的比例），选择出一个混合成分，根据该混合成分的概率密度函数，采样产生出相应的样本。</p>
<p>那么，利用GMM进行聚类的过程是利用GMM生成数据样本的“逆过程”：给定聚类簇数<code>K</code>，通过给定的数据集，以某一种 <strong>参数估计</strong> 的方法，推导出每一个混合成分的参数（即均值向量  </p>
<p class="ql-center-displayed-equation" style="line-height: 12px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.5.2Spark%202.1.0%20%E5%85%A5%E9%97%A8%EF%BC%9A%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E6%A8%A1%E5%9E%8B(GMM)%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_005.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[\mathbf{\mu}\]" title="Rendered by QuickLaTeX.com" width="11" height="12"></p>
<p> 、协方差矩阵 </p>
<p class="ql-center-displayed-equation" style="line-height: 12px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.5.2Spark%202.1.0%20%E5%85%A5%E9%97%A8%EF%BC%9A%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E6%A8%A1%E5%9E%8B(GMM)%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[\mathbf{\Sigma}\]" title="Rendered by QuickLaTeX.com" width="13" height="12"></p>
<p> 和权重 </p>
<p class="ql-center-displayed-equation" style="line-height: 8px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.5.2Spark%202.1.0%20%E5%85%A5%E9%97%A8%EF%BC%9A%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E6%A8%A1%E5%9E%8B(GMM)%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_003.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[w\]" title="Rendered by QuickLaTeX.com" width="13" height="8"></p>
<p>），每一个多元高斯分布成分即对应于聚类后的一个簇。高斯混合模型在训练时使用了极大似然估计法，最大化以下对数似然函数：</p>
<p class="ql-center-displayed-equation" style="line-height: 52px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.5.2Spark%202.1.0%20%E5%85%A5%E9%97%A8%EF%BC%9A%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E6%A8%A1%E5%9E%8B(GMM)%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_004.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[L = \log{\prod_{j=1}^{m}{p(\mathbf{x})}}\]" title="Rendered by QuickLaTeX.com" width="121" height="52"></p>
<p class="ql-center-displayed-equation" style="line-height: 56px;"><span class="ql-right-eqno"> &nbsp; </span><span class="ql-left-eqno"> &nbsp; </span><img src="6.5.2Spark%202.1.0%20%E5%85%A5%E9%97%A8%EF%BC%9A%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E6%A8%A1%E5%9E%8B(GMM)%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/quicklatex_008.svg" class="ql-img-displayed-equation quicklatex-auto-format" alt="\[L =\sum_{j=1}^{m}\log{(\sum_{i=1}^{K}{w_i\cdot p(\mathbf{x}|\mathbf{\mu}_i,\Sigma_i)})}\]" title="Rendered by QuickLaTeX.com" width="243" height="56"></p>
<p>显然，该优化式无法直接通过解析方式求得解，故可采用 <strong>期望-最大化(Expectation-Maximization, EM)</strong> 方法求解，具体过程如下（为了简洁，这里省去了具体的数学表达式，详细可见<a href="https://en.wikipedia.org/wiki/Mixture_model" target="_blank">wikipedia</a>）：</p>
<pre><code>1.根据给定的K值，初始化K个多元高斯分布以及其权重；
2.根据贝叶斯定理，估计每个样本由每个成分生成的后验概率；(EM方法中的E步)
3.根据均值，协方差的定义以及2步求出的后验概率，更新均值向量、协方差矩阵和权重；（EM方法的M步）
重复2~3步，直到似然函数增加值已小于收敛阈值，或达到最大迭代次数
</code></pre>
<p>当参数估计过程完成后，对于每一个样本点，根据贝叶斯定理计算出其属于每一个簇的后验概率，并将样本划分到后验概率最大的簇上去。相对于KMeans等直接给出样本点的簇划分的聚类方法，GMM这种给出样本点属于每个簇的概率的聚类方法，被称为 <strong>软聚类(Soft Clustering / Soft Assignment)</strong> 。</p>
<h4>模型的训练与分析</h4>
<p>Spark的ML库提供的高斯混合模型都在<code>org.apache.spark.ml.clustering</code>包下，和其他的聚类方法类似，其具体实现分为两个类：用于抽象GMM的超参数并进行训练的<code>GaussianMixture</code>类（<code>Estimator</code>）和训练后的模型<code>GaussianMixtureModel</code>类（<code>Transformer</code>），在使用前，引入需要的包：</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-scala prettyprinted" style=""><ol class="linenums"><li class="L0"><span class="kwd">from</span><span class="pln"> pyspark</span><span class="pun">.</span><span class="pln">sql </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">Row</span></li><li class="L1"><span class="kwd">from</span><span class="pln"> pyspark</span><span class="pun">.</span><span class="pln">ml</span><span class="pun">.</span><span class="pln">clustering </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">GaussianMixture</span><span class="pun">,</span><span class="pln"> </span><span class="typ">GaussianMixtureModel</span></li><li class="L2"><span class="kwd">from</span><span class="pln"> pyspark</span><span class="pun">.</span><span class="pln">ml</span><span class="pun">.</span><span class="pln">linalg </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">Vectors</span></li></ol></pre><div class="code-pretty-toolbar"><span class="title">scala</span><a href="javascript:void(0);" title="复制代码" class="tool clipboard"><i class="fa fa-files-o"></i></a><a href="javascript:void(0);" title="查看纯文本代码" class="tool view-source"><i class="fa fa-code"></i></a><a href="javascript:void(0);" title="返回代码高亮" class="tool back-to-pretty"><i class="fa fa-undo"></i></a><span class="msg"></span></div></div>
<p>与其他教程相同，本文亦使用模式识别领域广泛使用的UCI数据集中的鸢尾花数据Iris进行实验，它可以在<a href="http://dblab.xmu.edu.cn/blog/wp-content/uploads/2017/03/iris.txt" target="_blank">iris</a>获取，Iris数据的样本容量为150，有四个实数值的特征，分别代表花朵四个部位的尺寸，以及该样本对应鸢尾花的亚种类型（共有3种亚种类型）<br>
，如下所示：</p>
<pre><code>5.1,3.5,1.4,0.2,setosa
...
5.4,3.0,4.5,1.5,versicolor
...
7.1,3.0,5.9,2.1,virginica
...
</code></pre>
<p>为了便于生成相应的<code>DataFrame</code>，我们定义一个函数，来生成我们想要的数据。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-python prettyprinted" style=""><ol class="linenums"><li class="L0"><span class="kwd">def</span><span class="pln"> f</span><span class="pun">(</span><span class="pln">x</span><span class="pun">):</span></li><li class="L1"><span class="pln">    rel </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{}</span></li><li class="L2"><span class="pln">    rel</span><span class="pun">[</span><span class="str">'features'</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Vectors</span><span class="pun">.</span><span class="pln">dense</span><span class="pun">(</span><span class="pln">float</span><span class="pun">(</span><span class="pln">x</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]),</span><span class="pln">float</span><span class="pun">(</span><span class="pln">x</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]),</span><span class="pln">float</span><span class="pun">(</span><span class="pln">x</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]),</span><span class="pln">float</span><span class="pun">(</span><span class="pln">x</span><span class="pun">[</span><span class="lit">3</span><span class="pun">]))</span></li><li class="L3"><span class="pln">    </span><span class="kwd">return</span><span class="pln"> rel</span></li></ol></pre><div class="code-pretty-toolbar"><span class="title">Python</span><a href="javascript:void(0);" title="复制代码" class="tool clipboard"><i class="fa fa-files-o"></i></a><a href="javascript:void(0);" title="查看纯文本代码" class="tool view-source"><i class="fa fa-code"></i></a><a href="javascript:void(0);" title="返回代码高亮" class="tool back-to-pretty"><i class="fa fa-undo"></i></a><span class="msg"></span></div></div>
<p>在定义数据类型完成后，即可将数据读入<code>RDD[model_instance]</code>的结构中，并通过<code>RDD</code>的隐式转换<code>.toDF()</code>方法完成<code>RDD</code>到<code>DataFrame</code>的转换：</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-python prettyprinted" style=""><ol class="linenums"><li class="L0"><span class="pln">df </span><span class="pun">=</span><span class="pln"> sc</span><span class="pun">.</span><span class="pln">textFile</span><span class="pun">(</span><span class="str">"file:///usr/local/spark/iris.txt"</span><span class="pun">).</span><span class="pln">map</span><span class="pun">(</span><span class="kwd">lambda</span><span class="pln"> line</span><span class="pun">:</span><span class="pln"> line</span><span class="pun">.</span><span class="pln">split</span><span class="pun">(</span><span class="str">','</span><span class="pun">)).</span><span class="pln">map</span><span class="pun">(</span><span class="kwd">lambda</span><span class="pln"> p</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Row</span><span class="pun">(**</span><span class="pln">f</span><span class="pun">(</span><span class="pln">p</span><span class="pun">))).</span><span class="pln">toDF</span><span class="pun">()</span></li></ol></pre><div class="code-pretty-toolbar"><span class="title">Python</span><a href="javascript:void(0);" title="复制代码" class="tool clipboard"><i class="fa fa-files-o"></i></a><a href="javascript:void(0);" title="查看纯文本代码" class="tool view-source"><i class="fa fa-code"></i></a><a href="javascript:void(0);" title="返回代码高亮" class="tool back-to-pretty"><i class="fa fa-undo"></i></a><span class="msg"></span></div></div>
<p>可以通过创建一个<code>GaussianMixture</code>类，设置相应的超参数，并调用<code>fit(..)</code>方法来训练一个GMM模型<code>GaussianMixtureModel</code>，在该方法调用前需要设置一系列超参数，如下表所示：<br>
| 参数      |         含义         |<br>
| ——- | :—————-: |<br>
| K       |     聚类数目，默认为2      |<br>
| maxIter |   最大迭代次数，默认为100    |<br>
| seed    |  随机数种子，默认为随机Long值  |<br>
| Tol     | 对数似然函数收敛阈值，默认为0.01 |<br>
其中，每一个超参数均可通过名为<code>setXXX(...)</code>（如maxIterations即为<code>setMaxIterations()</code>）的方法进行设置。</p>
<p>这里，我们建立一个简单的<code>GaussianMixture</code>对象，设定其聚类数目为3，其他参数取默认值。</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-python prettyprinted" style=""><ol class="linenums"><li class="L0"><span class="pln">gm </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GaussianMixture</span><span class="pun">().</span><span class="pln">setK</span><span class="pun">(</span><span class="lit">3</span><span class="pun">).</span><span class="pln">setPredictionCol</span><span class="pun">(</span><span class="str">"Prediction"</span><span class="pun">).</span><span class="pln">setProbabilityCol</span><span class="pun">(</span><span class="str">"Probability"</span><span class="pun">)</span></li><li class="L1"><span class="pln">gmm </span><span class="pun">=</span><span class="pln"> gm</span><span class="pun">.</span><span class="pln">fit</span><span class="pun">(</span><span class="pln">df</span><span class="pun">)</span></li></ol></pre><div class="code-pretty-toolbar"><span class="title">Python</span><a href="javascript:void(0);" title="复制代码" class="tool clipboard"><i class="fa fa-files-o"></i></a><a href="javascript:void(0);" title="查看纯文本代码" class="tool view-source"><i class="fa fa-code"></i></a><a href="javascript:void(0);" title="返回代码高亮" class="tool back-to-pretty"><i class="fa fa-undo"></i></a><span class="msg"></span></div></div>
<p>和<code>KMeans</code>等硬聚类方法不同的是，除了可以得到对样本的聚簇归属预测外，还可以得到样本属于各个聚簇的概率（这里我们存在”Probability”列中）。</p>
<p>调用<code>transform()</code>方法处理数据集之后，打印数据集，可以看到每一个样本的预测簇以及其概率分布向量（这里为了明晰起见，省略了大部分行，只选择三行）：</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-python prettyprinted" style=""><ol class="linenums"><li class="L0"><span class="pln">result </span><span class="pun">=</span><span class="pln"> gmm</span><span class="pun">.</span><span class="pln">transform</span><span class="pun">(</span><span class="pln">df</span><span class="pun">)</span></li><li class="L1"><span class="pln">result</span><span class="pun">.</span><span class="pln">show</span><span class="pun">(</span><span class="lit">150</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">False</span><span class="pun">)</span><span class="pln">                                                                        </span></li><li class="L2"><span class="pln">&nbsp;</span></li><li class="L3"><span class="pun">+-----------------+----------+------------------------------------------------------------------+</span></li><li class="L4"><span class="pun">|</span><span class="pln">features         </span><span class="pun">|</span><span class="typ">Prediction</span><span class="pun">|</span><span class="typ">Probability</span><span class="pln">                                                       </span><span class="pun">|</span></li><li class="L5"><span class="pun">+-----------------+----------+------------------------------------------------------------------+</span></li><li class="L6"><span class="pun">|[</span><span class="lit">5.1</span><span class="pun">,</span><span class="lit">3.5</span><span class="pun">,</span><span class="lit">1.4</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">]|</span><span class="lit">2</span><span class="pln">         </span><span class="pun">|[</span><span class="lit">7.6734208374482E-12</span><span class="pun">,</span><span class="lit">3.834611512428377E-17</span><span class="pun">,</span><span class="lit">0.9999999999923265</span><span class="pun">]</span><span class="pln">    </span><span class="pun">|</span></li><li class="L7"><span class="pun">|[</span><span class="lit">4.9</span><span class="pun">,</span><span class="lit">3.0</span><span class="pun">,</span><span class="lit">1.4</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">]|</span><span class="lit">2</span><span class="pln">         </span><span class="pun">|[</span><span class="lit">3.166798629239744E-8</span><span class="pun">,</span><span class="lit">7.627279694305193E-17</span><span class="pun">,</span><span class="lit">0.9999999683320137</span><span class="pun">]</span><span class="pln">   </span><span class="pun">|</span></li><li class="L8"><span class="pun">|[</span><span class="lit">4.7</span><span class="pun">,</span><span class="lit">3.2</span><span class="pun">,</span><span class="lit">1.3</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">]|</span><span class="lit">2</span><span class="pln">         </span><span class="pun">|[</span><span class="lit">2.4270047914398485E-9</span><span class="pun">,</span><span class="lit">6.829198934603355E-17</span><span class="pun">,</span><span class="lit">0.9999999975729952</span><span class="pun">]</span><span class="pln">  </span><span class="pun">|</span></li><li class="L9"><span class="pun">|[</span><span class="lit">4.6</span><span class="pun">,</span><span class="lit">3.1</span><span class="pun">,</span><span class="lit">1.5</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">]|</span><span class="lit">2</span><span class="pln">         </span><span class="pun">|[</span><span class="lit">6.358110927310705E-8</span><span class="pun">,</span><span class="lit">6.742515135411673E-17</span><span class="pun">,</span><span class="lit">0.9999999364188907</span><span class="pun">]</span><span class="pln">   </span><span class="pun">|</span></li><li class="L0"><span class="pun">|[</span><span class="lit">5.0</span><span class="pun">,</span><span class="lit">3.6</span><span class="pun">,</span><span class="lit">1.4</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">]|</span><span class="lit">2</span><span class="pln">         </span><span class="pun">|[</span><span class="lit">2.76196999866254E-12</span><span class="pun">,</span><span class="lit">5.209131973934126E-17</span><span class="pun">,</span><span class="lit">0.9999999999972379</span><span class="pun">]</span><span class="pln">   </span><span class="pun">|</span></li><li class="L1"><span class="pun">|[</span><span class="lit">5.4</span><span class="pun">,</span><span class="lit">3.9</span><span class="pun">,</span><span class="lit">1.7</span><span class="pun">,</span><span class="lit">0.4</span><span class="pun">]|</span><span class="lit">2</span><span class="pln">         </span><span class="pun">|[</span><span class="lit">4.423526830721967E-13</span><span class="pun">,</span><span class="lit">3.661673865920354E-16</span><span class="pun">,</span><span class="lit">0.9999999999995574</span><span class="pun">]</span><span class="pln">  </span><span class="pun">|</span></li><li class="L2"><span class="pun">|[</span><span class="lit">4.6</span><span class="pun">,</span><span class="lit">3.4</span><span class="pun">,</span><span class="lit">1.4</span><span class="pun">,</span><span class="lit">0.3</span><span class="pun">]|</span><span class="lit">2</span><span class="pln">         </span><span class="pun">|[</span><span class="lit">1.996253995900862E-9</span><span class="pun">,</span><span class="lit">2.8082283131963835E-16</span><span class="pun">,</span><span class="lit">0.9999999980037457</span><span class="pun">]</span><span class="pln">  </span><span class="pun">|</span></li><li class="L3"><span class="pun">|[</span><span class="lit">5.0</span><span class="pun">,</span><span class="lit">3.4</span><span class="pun">,</span><span class="lit">1.5</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">]|</span><span class="lit">2</span><span class="pln">         </span><span class="pun">|[</span><span class="lit">1.5177480903927398E-10</span><span class="pun">,</span><span class="lit">3.3953493957830917E-17</span><span class="pun">,</span><span class="lit">0.9999999998482252</span><span class="pun">]|</span></li><li class="L4"><span class="pun">|[</span><span class="lit">4.4</span><span class="pun">,</span><span class="lit">2.9</span><span class="pun">,</span><span class="lit">1.4</span><span class="pun">,</span><span class="lit">0.2</span><span class="pun">]|</span><span class="lit">2</span><span class="pln">         </span><span class="pun">|[</span><span class="lit">8.259607931046402E-7</span><span class="pun">,</span><span class="lit">1.383366216513306E-16</span><span class="pun">,</span><span class="lit">0.9999991740392067</span><span class="pun">]</span><span class="pln">   </span><span class="pun">|</span></li><li class="L5"><span class="pln">&nbsp;</span></li></ol></pre><div class="code-pretty-toolbar"><span class="title">Python</span><a href="javascript:void(0);" title="复制代码" class="tool clipboard"><i class="fa fa-files-o"></i></a><a href="javascript:void(0);" title="查看纯文本代码" class="tool view-source"><i class="fa fa-code"></i></a><a href="javascript:void(0);" title="返回代码高亮" class="tool back-to-pretty"><i class="fa fa-undo"></i></a><span class="msg"></span></div></div>
<p>得到模型后，即可查看模型的相关参数，与KMeans方法不同，GMM不直接给出聚类中心，而是给出各个混合成分（多元高斯分布）的参数。在ML的实现中，GMM的每一个混合成分都使用一个<code>MultivariateGaussian</code>类（位于<code>org.apache.spark.ml.stat.distribution</code>包）来存储，我们可以使用<code>GaussianMixtureModel</code>类的<code>weights</code>成员获取到各个混合成分的权重，使用<code>gaussians</code>成员来获取到各个混合成分的参数（均值向量和协方差矩阵）：</p>
<div class="code-pretty-container"><pre class="prettyprint linenums lang-python prettyprinted" style=""><ol class="linenums"><li class="L0"><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="lit">3</span><span class="pun">):</span></li><li class="L1"><span class="pln">    </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"Component "</span><span class="pun">+</span><span class="pln">str</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)+</span><span class="str">" : weight is "</span><span class="pun">+</span><span class="pln">str</span><span class="pun">(</span><span class="pln">gmm</span><span class="pun">.</span><span class="pln">weights</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])+</span><span class="str">"\n mu vector is "</span><span class="pun">+</span><span class="pln">str</span><span class="pun">(</span><span class="pln"> gmm</span><span class="pun">.</span><span class="pln">gaussiansDF</span><span class="pun">.</span><span class="pln">select</span><span class="pun">(</span><span class="str">'mean'</span><span class="pun">).</span><span class="pln">head</span><span class="pun">())+</span><span class="str">" \n sigma matrix is "</span><span class="pun">+</span><span class="pln"> str</span><span class="pun">(</span><span class="pln">gmm</span><span class="pun">.</span><span class="pln">gaussiansDF</span><span class="pun">.</span><span class="pln">select</span><span class="pun">(</span><span class="str">'cov'</span><span class="pun">).</span><span class="pln">head</span><span class="pun">()))</span></li><li class="L2"><span class="pln">&nbsp;</span></li><li class="L3"><span class="pun">...</span><span class="pln"> </span></li><li class="L4"><span class="typ">Component</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> weight </span><span class="kwd">is</span><span class="pln"> </span><span class="lit">0.6537361109963744</span></li><li class="L5"><span class="pln"> mu vector </span><span class="kwd">is</span><span class="pln"> </span><span class="typ">Row</span><span class="pun">(</span><span class="pln">mean</span><span class="pun">=</span><span class="typ">DenseVector</span><span class="pun">([</span><span class="lit">6.2591</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2.8764</span><span class="pun">,</span><span class="pln"> </span><span class="lit">4.9057</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1.6784</span><span class="pun">]))</span><span class="pln"> </span></li><li class="L6"><span class="pln"> sigma matrix </span><span class="kwd">is</span><span class="pln"> </span><span class="typ">Row</span><span class="pun">(</span><span class="pln">cov</span><span class="pun">=</span><span class="typ">DenseMatrix</span><span class="pun">(</span><span class="lit">4</span><span class="pun">,</span><span class="pln"> </span><span class="lit">4</span><span class="pun">,</span><span class="pln"> </span><span class="pun">[</span><span class="lit">0.4414</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.1249</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.4524</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.1676</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.1249</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.1103</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.1469</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.081</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.4524</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.1469</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.6722</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.2871</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.1676</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.081</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.2871</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.1806</span><span class="pun">],</span><span class="pln"> </span><span class="kwd">False</span><span class="pun">))</span></li><li class="L7"><span class="typ">Component</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> weight </span><span class="kwd">is</span><span class="pln"> </span><span class="lit">0.03291269344724756</span></li><li class="L8"><span class="pln"> mu vector </span><span class="kwd">is</span><span class="pln"> </span><span class="typ">Row</span><span class="pun">(</span><span class="pln">mean</span><span class="pun">=</span><span class="typ">DenseVector</span><span class="pun">([</span><span class="lit">6.2591</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2.8764</span><span class="pun">,</span><span class="pln"> </span><span class="lit">4.9057</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1.6784</span><span class="pun">]))</span><span class="pln"> </span></li><li class="L9"><span class="pln"> sigma matrix </span><span class="kwd">is</span><span class="pln"> </span><span class="typ">Row</span><span class="pun">(</span><span class="pln">cov</span><span class="pun">=</span><span class="typ">DenseMatrix</span><span class="pun">(</span><span class="lit">4</span><span class="pun">,</span><span class="pln"> </span><span class="lit">4</span><span class="pun">,</span><span class="pln"> </span><span class="pun">[</span><span class="lit">0.4414</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.1249</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.4524</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.1676</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.1249</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.1103</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.1469</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.081</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.4524</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.1469</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.6722</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.2871</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.1676</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.081</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.2871</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.1806</span><span class="pun">],</span><span class="pln"> </span><span class="kwd">False</span><span class="pun">))</span></li><li class="L0"><span class="typ">Component</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> weight </span><span class="kwd">is</span><span class="pln"> </span><span class="lit">0.31335119555637797</span></li><li class="L1"><span class="pln"> mu vector </span><span class="kwd">is</span><span class="pln"> </span><span class="typ">Row</span><span class="pun">(</span><span class="pln">mean</span><span class="pun">=</span><span class="typ">DenseVector</span><span class="pun">([</span><span class="lit">6.2591</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2.8764</span><span class="pun">,</span><span class="pln"> </span><span class="lit">4.9057</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1.6784</span><span class="pun">]))</span><span class="pln"> </span></li><li class="L2"><span class="pln"> sigma matrix </span><span class="kwd">is</span><span class="pln"> </span><span class="typ">Row</span><span class="pun">(</span><span class="pln">cov</span><span class="pun">=</span><span class="typ">DenseMatrix</span><span class="pun">(</span><span class="lit">4</span><span class="pun">,</span><span class="pln"> </span><span class="lit">4</span><span class="pun">,</span><span class="pln"> </span><span class="pun">[</span><span class="lit">0.4414</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.1249</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.4524</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.1676</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.1249</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.1103</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.1469</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.081</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.4524</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.1469</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.6722</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.2871</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.1676</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.081</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.2871</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0.1806</span><span class="pun">],</span><span class="pln"> </span><span class="kwd">False</span><span class="pun">))</span></li></ol></pre><div class="code-pretty-toolbar"><span class="title">Python</span><a href="javascript:void(0);" title="复制代码" class="tool clipboard"><i class="fa fa-files-o"></i></a><a href="javascript:void(0);" title="查看纯文本代码" class="tool view-source"><i class="fa fa-code"></i></a><a href="javascript:void(0);" title="返回代码高亮" class="tool back-to-pretty"><i class="fa fa-undo"></i></a><span class="msg"></span></div></div>
			</div><!-- .entry-content -->

	<footer class="entry-footer">
		<div class="entry-author">
			<div class="author-title">本文作者</div>
			
		<div class="author-avatar"><img src="6.5.2Spark%202.1.0%20%E5%85%A5%E9%97%A8%EF%BC%9A%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E6%A8%A1%E5%9E%8B(GMM)%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/2.jpg" alt="阮榕城" class="avatar avatar-thumbnail wp-user-avatar wp-user-avatar-thumbnail alignnone photo"></div>
		<div class="author-info">
			<p class="author-name"><a href="http://dblab.xmu.edu.cn/blog/author/ruanrongcheng/">阮榕城</a></p>
			<p class="author-desc">磨人的小妖精！</p>
			<p class="author-contact"><a href="http://www.nekomiao.me/" target="_blank" title="个人主页" class="homepage"><i class="fa fa-home"></i>www.nekomiao.me</a><i class="fa fa-envelope"></i><span class="envelope">moc.qq@crnaur</span></p>
		</div>
			</div>
		<div class="entry-info">
			<span class="permalink"><i class="fa fa-external-link"></i> <a href="http://dblab.xmu.edu.cn/blog/1780-2/" title="Spark 2.1.0 入门：高斯混合模型(GMM)聚类算法(Python版)">http://dblab.xmu.edu.cn/blog/1780-2/</a></span><span class="category"><i class="fa fa-folder-open-o"></i> <a href="http://dblab.xmu.edu.cn/blog/category/big-data/" rel="category tag">大数据</a></span>		</div>
		<div class="yarpp-related yarpp-related-none">
</div>
	</footer><!-- .entry-footer -->
</article><!-- #post-## -->
			</div>
</div><!-- .row -->

	<div class="row">
		<div class="col-sm-3"></div>
		<div class="col-sm-9 site-footer">
			© 2014 <a href="http://dblab.xmu.edu.cn/">厦大数据库实验室</a>
					</div>
	</div>
</div><!-- .container -->
<link rel="stylesheet" id="yarppRelatedCss-css" href="6.5.2Spark%202.1.0%20%E5%85%A5%E9%97%A8%EF%BC%9A%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E6%A8%A1%E5%9E%8B(GMM)%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/related.css" type="text/css" media="all">
<script type="text/javascript" src="6.5.2Spark%202.1.0%20%E5%85%A5%E9%97%A8%EF%BC%9A%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E6%A8%A1%E5%9E%8B(GMM)%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/prettify.js"></script>
<script type="text/javascript" src="6.5.2Spark%202.1.0%20%E5%85%A5%E9%97%A8%EF%BC%9A%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E6%A8%A1%E5%9E%8B(GMM)%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/power.js"></script>
<script type="text/javascript" src="6.5.2Spark%202.1.0%20%E5%85%A5%E9%97%A8%EF%BC%9A%E9%AB%98%E6%96%AF%E6%B7%B7%E5%90%88%E6%A8%A1%E5%9E%8B(GMM)%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95(Python%E7%89%88)_%E5%8E%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8D%9A%E5%AE%A2_files/wp-embed.js"></script>

<div class="back-to-top" id="back-to-top" title="嗖的就上去了！"><span><i class="fa fa-chevron-up"></i></span></div></body></html>